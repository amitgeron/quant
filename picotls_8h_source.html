<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>quant: deps/picotls/include/picotls.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quant
   &#160;<span id="projectnumber">0.0.17</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_82ce5dd3950c6393668b7cc23fc52b28.html">deps</a></li><li class="navelem"><a class="el" href="dir_d95583c8b5a1c9c6667192dae391b706.html">picotls</a></li><li class="navelem"><a class="el" href="dir_9d5898fdbca62ae5e36df117ba03b152.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">picotls.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="picotls_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2016 DeNA Co., Ltd., Kazuho Oku</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Permission is hereby granted, free of charge, to any person obtaining a copy</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * of this software and associated documentation files (the &quot;Software&quot;), to</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * deal in the Software without restriction, including without limitation the</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * sell copies of the Software, and to permit persons to whom the Software is</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * furnished to do so, subject to the following conditions:</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * The above copyright notice and this permission notice shall be included in</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * all copies or substantial portions of the Software.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * IN THE SOFTWARE.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef picotls_h</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define picotls_h</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="picotls_8h.html#acdaa44e790d3a6fe8cfa948c8b91ac4a">   33</a></span>&#160;<span class="preprocessor">#define PTLS_AES128_KEY_SIZE 16</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="picotls_8h.html#a99874819a65650d326220d0d33fa1d60">   34</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_AES256_KEY_SIZE 32</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad50a32ad73fdb75321e286fbd9014670">   35</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_AES_IV_SIZE 16</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="picotls_8h.html#a559e248d43faf9fa3ff0fa35a7a02343">   36</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_AESGCM_IV_SIZE 12</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="picotls_8h.html#a63730f53ad05b39d96cfbf1f5b349941">   37</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_AESGCM_TAG_SIZE 16</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="picotls_8h.html#a12bf5ca6c54277d849bb4f26e99cc76b">   39</a></span>&#160;<span class="preprocessor">#define PTLS_CHACHA20_KEY_SIZE 32</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="picotls_8h.html#ab951c4efc0bee4a298731d6f874dd2bc">   40</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_CHACHA20_IV_SIZE 16</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="picotls_8h.html#a1813bfeb21e1b68d03f56d88db2d35b5">   41</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_CHACHA20POLY1305_IV_SIZE 12</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="picotls_8h.html#a19abf2dc93fc66b2998d1f77f048b946">   42</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_CHACHA20POLY1305_TAG_SIZE 16</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="picotls_8h.html#abfb1619bfa89e5cf6a815f52cd0d0cea">   44</a></span>&#160;<span class="preprocessor">#define PTLS_SHA256_BLOCK_SIZE 64</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="picotls_8h.html#a910934303bda14d99030e6ef629b8888">   45</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SHA256_DIGEST_SIZE 32</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa2167c6b76ee0c4517a263225c2bd7ae">   47</a></span>&#160;<span class="preprocessor">#define PTLS_SHA384_BLOCK_SIZE 128</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="picotls_8h.html#a4e599a21a88b23aeb53494c65d159581">   48</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SHA384_DIGEST_SIZE 48</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa21d26aa10d4980c4abceafe3010e0c2">   50</a></span>&#160;<span class="preprocessor">#define PTLS_MAX_SECRET_SIZE 32</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="picotls_8h.html#ac74362872a2014306e0a73d0b78963d4">   51</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_MAX_IV_SIZE 16</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="picotls_8h.html#a7b871b714f154f9486d248ba42999531">   52</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_MAX_DIGEST_SIZE 64</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/* cipher-suites */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="picotls_8h.html#aafe67e2748e31b8828ac55f4f5c77257">   55</a></span>&#160;<span class="preprocessor">#define PTLS_CIPHER_SUITE_AES_128_GCM_SHA256 0x1301</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="picotls_8h.html#a16fc5d531298f137319be48b0b23f455">   56</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_CIPHER_SUITE_AES_256_GCM_SHA384 0x1302</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="picotls_8h.html#a42e6240730d0199ee88e3285154573d7">   57</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_CIPHER_SUITE_CHACHA20_POLY1305_SHA256 0x1303</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/* negotiated_groups */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="picotls_8h.html#ac4feae5c851d59abaa0f785b66d0d8f3">   60</a></span>&#160;<span class="preprocessor">#define PTLS_GROUP_SECP256R1 23</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="picotls_8h.html#a81b0f1ad61c60a3e3ddbcfb2d3aa18f4">   61</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_GROUP_SECP384R1 24</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad3f397883a95ae2448517e23be8cf214">   62</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_GROUP_SECP521R1 25</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="picotls_8h.html#aeda38aa67c6caa40e7ac2f6402031cbe">   63</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_GROUP_X25519 29</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="picotls_8h.html#a63d43ca67475626dff9db728f2b4c8e3">   64</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_GROUP_X448 30</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">/* signature algorithms */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="picotls_8h.html#a53baa3b13005d7f99563527dc6e2cd2e">   67</a></span>&#160;<span class="preprocessor">#define PTLS_SIGNATURE_RSA_PKCS1_SHA1 0x0201</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="picotls_8h.html#a68b041ac20779c0986085ccf6b0db8f3">   68</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_RSA_PKCS1_SHA256 0x0401</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="picotls_8h.html#a6aefab0e5c5530fcbe97c17660e20bfc">   69</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_ECDSA_SECP256R1_SHA256 0x0403</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="picotls_8h.html#a99cb2820f26020a72453065a20bca589">   70</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_ECDSA_SECP384R1_SHA384 0x0503</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa94adf1fcc683159c142643b91407042">   71</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_ECDSA_SECP521R1_SHA512 0x0603</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="picotls_8h.html#a77a5e96b96d487b66c17bf256a0010b9">   72</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_RSA_PSS_RSAE_SHA256 0x0804</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="picotls_8h.html#a147ac21d3aea97659a4d27a58808bc5e">   73</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_RSA_PSS_RSAE_SHA384 0x0805</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="picotls_8h.html#a8622d8ff021fe010fff3121786ab3ce2">   74</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_SIGNATURE_RSA_PSS_RSAE_SHA512 0x0806</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/* ESNI */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="picotls_8h.html#a5405b618cd3bca074b56411626df1b8d">   77</a></span>&#160;<span class="preprocessor">#define PTLS_ESNI_VERSION_DRAFT02 0xff01</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">/* error classes and macros */</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="picotls_8h.html#a3457b059ca106322788da2e617cb64ca">   80</a></span>&#160;<span class="preprocessor">#define PTLS_ERROR_CLASS_SELF_ALERT 0</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="picotls_8h.html#a0c2fe9d6e7174938fafff630baf17366">   81</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_CLASS_PEER_ALERT 0x100</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="picotls_8h.html#ab373ede56df7c80cc5505b9bc6840d43">   82</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_CLASS_INTERNAL 0x200</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="picotls_8h.html#a4bcbfff8c4b9b41222912fea2fb5b8a1">   84</a></span>&#160;<span class="preprocessor">#define PTLS_ERROR_GET_CLASS(e) ((e) &amp; ~0xff)</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa7b1546d363e813b735dd25d2adeb316">   85</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_TO_SELF_ERROR(e) ((e) + PTLS_ERROR_CLASS_SELF_ALERT)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="picotls_8h.html#a6d529e8e0df6c4bbf2dbe1fc1bd9499b">   86</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_TO_PEER_ERROR(e) ((e) + PTLS_ERROR_CLASS_PEER_ALERT)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="picotls_8h.html#abdd888a045f2bc3416499eeff1a9b771">   87</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_TO_ALERT(e) ((e)&amp;0xff)</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">/* the HKDF prefix */</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad3162cd4338ddf91d2e8d9fa860d2e5c">   90</a></span>&#160;<span class="preprocessor">#define PTLS_HKDF_EXPAND_LABEL_PREFIX &quot;tls13 &quot;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">/* alerts */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="picotls_8h.html#a025e172bc9c76f07291bbb7304a2abe8">   93</a></span>&#160;<span class="preprocessor">#define PTLS_ALERT_LEVEL_WARNING 1</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="picotls_8h.html#a85607db725de272ba10c1f777852bcf0">   94</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_LEVEL_FATAL 2</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="picotls_8h.html#a61e9dfb3adf959615636de887f1f0e1e">   96</a></span>&#160;<span class="preprocessor">#define PTLS_ALERT_CLOSE_NOTIFY 0</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="picotls_8h.html#a07779fe871f0be07c689bbbbb4ea7b3e">   97</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_UNEXPECTED_MESSAGE 10</span></div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="picotls_8h.html#a5f96b1098635296fb37ae0e476a13a5a">   98</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_BAD_RECORD_MAC 20</span></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="picotls_8h.html#a106565fdb1c437b12f411a4a0265b896">   99</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_HANDSHAKE_FAILURE 40</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="picotls_8h.html#a8057b7f5f8f75421b323524ad5fd2356">  100</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_BAD_CERTIFICATE 42</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="picotls_8h.html#a5d293147d2fd1b352f9521770b5cf989">  101</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_CERTIFICATE_REVOKED 44</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="picotls_8h.html#a0b0bd2fccf4c5b656bba95f0322a1be0">  102</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_CERTIFICATE_EXPIRED 45</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="picotls_8h.html#a1d4b72fa41670dc3a110560bc654d83c">  103</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_CERTIFICATE_UNKNOWN 46</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="picotls_8h.html#acbf89d0f64e12d4ac9fec82442d5ae6e">  104</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_ILLEGAL_PARAMETER 47</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="picotls_8h.html#a20d9a319931c51b4166fe342a16db6a7">  105</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_UNKNOWN_CA 48</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="picotls_8h.html#a718190320212866d76611fe44a024ad1">  106</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_DECODE_ERROR 50</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="picotls_8h.html#a3090fcf90fab870d6bf972e6e1329487">  107</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_DECRYPT_ERROR 51</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="picotls_8h.html#acda2b41e6b7f338574580da6fdc3eb5a">  108</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_PROTOCOL_VERSION 70</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="picotls_8h.html#ab674665d608657936e6ad238d9b9a2cc">  109</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_INTERNAL_ERROR 80</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad7dcb62b8b4b4bce4ade7dc8730b4d99">  110</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_USER_CANCELED 90</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="picotls_8h.html#a0f645cdd5f6745750d3c0fbcb03e8ce6">  111</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_MISSING_EXTENSION 109</span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="picotls_8h.html#ac7a0bc4a7bec4154956c530ab49449ba">  112</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_UNRECOGNIZED_NAME 112</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="picotls_8h.html#a871526257b4023ee5772e59a2044fbe4">  113</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_CERTIFICATE_REQUIRED 116</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="picotls_8h.html#a037bb56bd77480af65c3da1301d29590">  114</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ALERT_NO_APPLICATION_PROTOCOL 120</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/* internal errors */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="picotls_8h.html#acddd6a464dc426456ccbcbe0bcf70f5c">  117</a></span>&#160;<span class="preprocessor">#define PTLS_ERROR_NO_MEMORY (PTLS_ERROR_CLASS_INTERNAL + 1)</span></div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="picotls_8h.html#a8ef203f0eb285394fd7052a4cbae6f14">  118</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_IN_PROGRESS (PTLS_ERROR_CLASS_INTERNAL + 2)</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="picotls_8h.html#a861ea6d8e06c5f54cc361f310286940f">  119</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_LIBRARY (PTLS_ERROR_CLASS_INTERNAL + 3)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="picotls_8h.html#a6e86759f32b5aef30d7b6b804c3fbe2e">  120</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCOMPATIBLE_KEY (PTLS_ERROR_CLASS_INTERNAL + 4)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="picotls_8h.html#af364d44bb1f60158c735bbb8095ff00d">  121</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_SESSION_NOT_FOUND (PTLS_ERROR_CLASS_INTERNAL + 5)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="picotls_8h.html#a88da6367acbc7af799d8f2222a5d3557">  122</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_STATELESS_RETRY (PTLS_ERROR_CLASS_INTERNAL + 6)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="picotls_8h.html#a4d23e6fc991ae8c0a75c53c1186dbf1e">  123</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_NOT_AVAILABLE (PTLS_ERROR_CLASS_INTERNAL + 7)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="picotls_8h.html#a5b8e787cc4616d50e203ea342aa6ff3d">  124</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_COMPRESSION_FAILURE (PTLS_ERROR_CLASS_INTERNAL + 8)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="picotls_8h.html#abd20122791c3c4bc587e830413b21ddc">  126</a></span>&#160;<span class="preprocessor">#define PTLS_ERROR_INCORRECT_BASE64 (PTLS_ERROR_CLASS_INTERNAL + 50)</span></div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="picotls_8h.html#a80f29fd77cb980163c57c7cb252e10f6">  127</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_PEM_LABEL_NOT_FOUND (PTLS_ERROR_CLASS_INTERNAL + 51)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="picotls_8h.html#af652a12ab42aa5fa3baa058cc1049dda">  128</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_BER_INCORRECT_ENCODING (PTLS_ERROR_CLASS_INTERNAL + 52)</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae2ac523826fa7822730054267719d40b">  129</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_BER_MALFORMED_TYPE (PTLS_ERROR_CLASS_INTERNAL + 53)</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="picotls_8h.html#a3c213fbc2d4d1bc6401503d0fbbad91a">  130</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_BER_MALFORMED_LENGTH (PTLS_ERROR_CLASS_INTERNAL + 54)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="picotls_8h.html#afc0cb845db3b9c8f08f866be20b1b114">  131</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_BER_EXCESSIVE_LENGTH (PTLS_ERROR_CLASS_INTERNAL + 55)</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="picotls_8h.html#a0954ac35dbad30adcbbc0bf04d1e7076">  132</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_BER_ELEMENT_TOO_SHORT (PTLS_ERROR_CLASS_INTERNAL + 56)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="picotls_8h.html#a0c2cb251659c454218faa2c50ea55f69">  133</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_BER_UNEXPECTED_EOC (PTLS_ERROR_CLASS_INTERNAL + 57)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="picotls_8h.html#a9ad4959928f4e7ac7e52b3e05c2a3bad">  134</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_DER_INDEFINITE_LENGTH (PTLS_ERROR_CLASS_INTERNAL + 58)</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="picotls_8h.html#adc25ca48cb199535bed8c6663c33788c">  135</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCORRECT_ASN1_SYNTAX (PTLS_ERROR_CLASS_INTERNAL + 59)</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="picotls_8h.html#ac5491ad796f8855a8f42e5e196b03f27">  136</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCORRECT_PEM_KEY_VERSION (PTLS_ERROR_CLASS_INTERNAL + 60)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="picotls_8h.html#a69571f86ad71e5e541d721b8ae85fad0">  137</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCORRECT_PEM_ECDSA_KEY_VERSION (PTLS_ERROR_CLASS_INTERNAL + 61)</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="picotls_8h.html#a00abb3edc518162230208207e6194384">  138</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCORRECT_PEM_ECDSA_CURVE (PTLS_ERROR_CLASS_INTERNAL + 62)</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="picotls_8h.html#a581da612610cf24ff0ba492339f4bbe2">  139</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCORRECT_PEM_ECDSA_KEYSIZE (PTLS_ERROR_CLASS_INTERNAL + 63)</span></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="picotls_8h.html#a44d1b03e946296c561a9dc875f523082">  140</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_ERROR_INCORRECT_ASN1_ECDSA_KEY_SYNTAX (PTLS_ERROR_CLASS_INTERNAL + 64)</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="picotls_8h.html#a08a8f7f2474fac8ca8496b7b6e1aa105">  142</a></span>&#160;<span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_CLIENT_HELLO 1</span></div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="picotls_8h.html#a079d5955a7db9c407be4aa1bf8d76f5d">  143</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_SERVER_HELLO 2</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="picotls_8h.html#acd01da763480e3e7cb97e09b43d54e35">  144</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_NEW_SESSION_TICKET 4</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="picotls_8h.html#a7c914f2a4b75080f8f6be9e0ae7777ed">  145</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_END_OF_EARLY_DATA 5</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="picotls_8h.html#a14bacacd33f88539c82fbe474b53e735">  146</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_ENCRYPTED_EXTENSIONS 8</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae4b65a3e65be685891997fb2c0addecb">  147</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_CERTIFICATE 11</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="picotls_8h.html#abb84b3a77a33228bf01eafb7af12b8bb">  148</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_CERTIFICATE_REQUEST 13</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="picotls_8h.html#a6835732b3331331fc91bae610b68c0f9">  149</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_CERTIFICATE_VERIFY 15</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="picotls_8h.html#ade132237e6cb50b193717404ed811de1">  150</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_FINISHED 20</span></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="picotls_8h.html#a095fc0b60e64dabbf7c7d61d6ec5e9b1">  151</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_KEY_UPDATE 24</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="picotls_8h.html#a36b125ac330017c549a486a5b226b190">  152</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_COMPRESSED_CERTIFICATE 25</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="picotls_8h.html#ab2a872a83390df151343c7d57aaf3597">  153</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define PTLS_HANDSHAKE_TYPE_MESSAGE_HASH 254</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa596500914e23a251e189495d8e66fba">  155</a></span>&#160;<span class="preprocessor">#define PTLS_ZERO_DIGEST_SHA256                                                                                                    \</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">    {                                                                                                                              \</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">        0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4,    \</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">            0x64, 0x9b, 0x93, 0x4c, 0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55                                                 \</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">    }</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="picotls_8h.html#a4fb20cb6b2af408282de113fa889a92e">  161</a></span>&#160;<span class="preprocessor">#define PTLS_ZERO_DIGEST_SHA384                                                                                                    \</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">    {                                                                                                                              \</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">        0x38, 0xb0, 0x60, 0xa7, 0x51, 0xac, 0x96, 0x38, 0x4c, 0xd9, 0x32, 0x7e, 0xb1, 0xb1, 0xe3, 0x6a, 0x21, 0xfd, 0xb7, 0x11,    \</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">            0x14, 0xbe, 0x07, 0x43, 0x4c, 0x0c, 0xc7, 0xbf, 0x63, 0xf6, 0xe1, 0xda, 0x27, 0x4e, 0xde, 0xbf, 0xe7, 0x6f, 0x65,      \</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">            0xfb, 0xd5, 0x1a, 0xd2, 0xf1, 0x48, 0x98, 0xb9, 0x5b                                                                   \</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">    }</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="picotls_8h.html#a7d80bba54b8b0070ce3264441be3e325">  168</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__t.html">st_ptls_t</a> <a class="code" href="structst__ptls__t.html">ptls_t</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="picotls_8h.html#a7b1de04c9108a605591e1562a2418b86">  169</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__context__t.html">st_ptls_context_t</a> <a class="code" href="structst__ptls__context__t.html">ptls_context_t</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="picotls_8h.html#a8c055926924a21cfe2ded845b00b30f4">  170</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__key__schedule__t.html">st_ptls_key_schedule_t</a> <a class="code" href="structst__ptls__key__schedule__t.html">ptls_key_schedule_t</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="structst__ptls__iovec__t.html">  175</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__iovec__t.html">st_ptls_iovec_t</a> {</div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="structst__ptls__iovec__t.html#a6a3ca90e0fee18ab6a55e47982271876">  176</a></span>&#160;    uint8_t *<a class="code" href="structst__ptls__iovec__t.html#a6a3ca90e0fee18ab6a55e47982271876">base</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="structst__ptls__iovec__t.html#aa5ab20f9aa80ae7de96cff7cdf5aac57">  177</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__iovec__t.html#aa5ab20f9aa80ae7de96cff7cdf5aac57">len</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;} <a class="code" href="picotls_8h.html#aa569bd382fdcb4a3b4c6906bd8530366">ptls_iovec_t</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="structst__ptls__buffer__t.html">  183</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__buffer__t.html">st_ptls_buffer_t</a> {</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="structst__ptls__buffer__t.html#a4a96dcd8b941d061b85c7d3979890b1e">  184</a></span>&#160;    uint8_t *<a class="code" href="structst__ptls__buffer__t.html#a4a96dcd8b941d061b85c7d3979890b1e">base</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="structst__ptls__buffer__t.html#a1f096614a1a66eaa3c0458c02cd8f792">  185</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__buffer__t.html#a1f096614a1a66eaa3c0458c02cd8f792">capacity</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="structst__ptls__buffer__t.html#a657a1152144567e35af6d295b16a1534">  186</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__buffer__t.html#a657a1152144567e35af6d295b16a1534">off</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structst__ptls__buffer__t.html#a099e58c6cf4d258f47c6b525b3c45e12">  187</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structst__ptls__buffer__t.html#a099e58c6cf4d258f47c6b525b3c45e12">is_allocated</a>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;} <a class="code" href="picotls_8h.html#a3c9053bc53d8840504dcb6e25a33c7dd">ptls_buffer_t</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__context__t.html">  193</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__key__exchange__context__t.html">st_ptls_key_exchange_context_t</a> {</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__context__t.html#aad610065e5a9bdfee7e5c7a46a1a2ea6">  197</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__key__exchange__algorithm__t.html">st_ptls_key_exchange_algorithm_t</a> *<a class="code" href="structst__ptls__key__exchange__context__t.html#aad610065e5a9bdfee7e5c7a46a1a2ea6">algo</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__context__t.html#a78f61003457c33a7dbc6e500afd3008c">  201</a></span>&#160;    <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__key__exchange__context__t.html#a78f61003457c33a7dbc6e500afd3008c">pubkey</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__context__t.html#af9eb383509f984d4cb7e2ae76ab5cc35">  205</a></span>&#160;    int (*<a class="code" href="structst__ptls__key__exchange__context__t.html#af9eb383509f984d4cb7e2ae76ab5cc35">on_exchange</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__key__exchange__context__t.html">st_ptls_key_exchange_context_t</a> **keyex, <span class="keywordtype">int</span> release, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *secret, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> peerkey);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;} <a class="code" href="picotls_8h.html#aba5f8192177bfff33c4fa7e8565db584">ptls_key_exchange_context_t</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__algorithm__t.html">  211</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__key__exchange__algorithm__t.html">st_ptls_key_exchange_algorithm_t</a> {</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__algorithm__t.html#a06fe9adb6ddab04b281a81fd10e0fb20">  215</a></span>&#160;    uint16_t <a class="code" href="structst__ptls__key__exchange__algorithm__t.html#a06fe9adb6ddab04b281a81fd10e0fb20">id</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__algorithm__t.html#a0ca0edbaae452688553dcef9eab5f2fa">  220</a></span>&#160;    int (*<a class="code" href="structst__ptls__key__exchange__algorithm__t.html#a0ca0edbaae452688553dcef9eab5f2fa">create</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__key__exchange__algorithm__t.html">st_ptls_key_exchange_algorithm_t</a> *algo, <a class="code" href="structst__ptls__key__exchange__context__t.html">ptls_key_exchange_context_t</a> **<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__algorithm__t.html#ab3000798ea98afb83d6bf5f7eda3ec6c">  224</a></span>&#160;    int (*<a class="code" href="structst__ptls__key__exchange__algorithm__t.html#ab3000798ea98afb83d6bf5f7eda3ec6c">exchange</a>)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__key__exchange__algorithm__t.html">st_ptls_key_exchange_algorithm_t</a> *algo, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *pubkey, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *secret,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> peerkey);</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structst__ptls__key__exchange__algorithm__t.html#a01dac78eb934011730fef5d5d3789a12">  229</a></span>&#160;    intptr_t <a class="code" href="structst__ptls__key__exchange__algorithm__t.html#a01dac78eb934011730fef5d5d3789a12">data</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;} <a class="code" href="picotls_8h.html#ac588b1d2fe517759aa70995aa643bd96">ptls_key_exchange_algorithm_t</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__context__t.html">  235</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__context__t.html">st_ptls_cipher_context_t</a> {</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__context__t.html#a3bdc4a6af3b603f832e3724d8bab05a5">  236</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__algorithm__t.html">st_ptls_cipher_algorithm_t</a> *<a class="code" href="structst__ptls__cipher__context__t.html#a3bdc4a6af3b603f832e3724d8bab05a5">algo</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">/* field above this line must not be altered by the crypto binding */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__context__t.html#a12a884b0d156b21e143121e462cf3aec">  238</a></span>&#160;    void (*<a class="code" href="structst__ptls__cipher__context__t.html#a12a884b0d156b21e143121e462cf3aec">do_dispose</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__context__t.html">st_ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__context__t.html#a5735326f249b86955577cd8181e5d5c4">  239</a></span>&#160;    void (*<a class="code" href="structst__ptls__cipher__context__t.html#a5735326f249b86955577cd8181e5d5c4">do_init</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__context__t.html">st_ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *iv);</div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__context__t.html#abd75a02a8a54ed88e494874b75837b2c">  240</a></span>&#160;    void (*<a class="code" href="structst__ptls__cipher__context__t.html#abd75a02a8a54ed88e494874b75837b2c">do_transform</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__context__t.html">st_ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;} <a class="code" href="picotls_8h.html#a5e5f3adbb5902ee128ee1496e696f32d">ptls_cipher_context_t</a>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__algorithm__t.html">  246</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__algorithm__t.html">st_ptls_cipher_algorithm_t</a> {</div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__algorithm__t.html#a956189e2a466696fd544f633816aed7f">  247</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structst__ptls__cipher__algorithm__t.html#a956189e2a466696fd544f633816aed7f">name</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__algorithm__t.html#a527567e3632260a9e616e6cb89d28878">  248</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__cipher__algorithm__t.html#a527567e3632260a9e616e6cb89d28878">key_size</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__algorithm__t.html#a2ccd97b3e25bec06579d2063bb72b5fe">  249</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__cipher__algorithm__t.html#a2ccd97b3e25bec06579d2063bb72b5fe">iv_size</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__algorithm__t.html#aadfae2ab2b1bbc5f0f06d2e03edf657a">  250</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__cipher__algorithm__t.html#aadfae2ab2b1bbc5f0f06d2e03edf657a">context_size</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__algorithm__t.html#a8202b203443b39432fffc5c6dee99e92">  251</a></span>&#160;    int (*<a class="code" href="structst__ptls__cipher__algorithm__t.html#a8202b203443b39432fffc5c6dee99e92">setup_crypto</a>)(<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">int</span> is_enc, <span class="keyword">const</span> <span class="keywordtype">void</span> *key);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;} <a class="code" href="picotls_8h.html#a3bc4e32d3a4145414426aa251dbf2c77">ptls_cipher_algorithm_t</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html">  258</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a> {</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#ae59a54bcc7bca697db8c38a14f6642f9">  259</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__aead__algorithm__t.html">st_ptls_aead_algorithm_t</a> *<a class="code" href="structst__ptls__aead__context__t.html#ae59a54bcc7bca697db8c38a14f6642f9">algo</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#a2165e03ebce8693e8b0517842f7934d7">  260</a></span>&#160;    uint8_t <a class="code" href="structst__ptls__aead__context__t.html#a2165e03ebce8693e8b0517842f7934d7">static_iv</a>[<a class="code" href="picotls_8h.html#ac74362872a2014306e0a73d0b78963d4">PTLS_MAX_IV_SIZE</a>];</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">/* field above this line must not be altered by the crypto binding */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#af01d9583d257d95708246970bc78b514">  262</a></span>&#160;    void (*<a class="code" href="structst__ptls__aead__context__t.html#af01d9583d257d95708246970bc78b514">dispose_crypto</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#a188e81d4226726d0aa781a8b0cb6b60f">  263</a></span>&#160;    void (*<a class="code" href="structst__ptls__aead__context__t.html#a188e81d4226726d0aa781a8b0cb6b60f">do_encrypt_init</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *iv, <span class="keyword">const</span> <span class="keywordtype">void</span> *aad, <span class="keywordtype">size_t</span> aadlen);</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#a6610d6f28759c2909873594c05b6dd4a">  264</a></span>&#160;    size_t (*<a class="code" href="structst__ptls__aead__context__t.html#a6610d6f28759c2909873594c05b6dd4a">do_encrypt_update</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen);</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#a44f606086b767744ece15f652b85d3b5">  265</a></span>&#160;    size_t (*<a class="code" href="structst__ptls__aead__context__t.html#a44f606086b767744ece15f652b85d3b5">do_encrypt_final</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output);</div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="structst__ptls__aead__context__t.html#a96ea72bb852a8fcee54ed0d1dab942b3">  266</a></span>&#160;    size_t (*<a class="code" href="structst__ptls__aead__context__t.html#a96ea72bb852a8fcee54ed0d1dab942b3">do_decrypt</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen, <span class="keyword">const</span> <span class="keywordtype">void</span> *iv,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">void</span> *aad, <span class="keywordtype">size_t</span> aadlen);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;} <a class="code" href="picotls_8h.html#a5d637d5f1fe107549ad1a14258291588">ptls_aead_context_t</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html">  273</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__aead__algorithm__t.html">st_ptls_aead_algorithm_t</a> {</div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#a5c39539d9621b6bb75ef0581233497fb">  277</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structst__ptls__aead__algorithm__t.html#a5c39539d9621b6bb75ef0581233497fb">name</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#abb9c41628e75453184a80821f7f88cf1">  281</a></span>&#160;    <a class="code" href="structst__ptls__cipher__algorithm__t.html">ptls_cipher_algorithm_t</a> *<a class="code" href="structst__ptls__aead__algorithm__t.html#abb9c41628e75453184a80821f7f88cf1">ctr_cipher</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#a895a63f41183ae18f0a1ac5294dec881">  285</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__aead__algorithm__t.html#a895a63f41183ae18f0a1ac5294dec881">key_size</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#a3707224f93425758d39ca6c7a7768c8c">  289</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__aead__algorithm__t.html#a3707224f93425758d39ca6c7a7768c8c">iv_size</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#a3c24671b14d54653d4effaba190abefa">  293</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__aead__algorithm__t.html#a3c24671b14d54653d4effaba190abefa">tag_size</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#abb9a5c9d8928f4410841ac3ce0aeb9bd">  298</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__aead__algorithm__t.html#abb9a5c9d8928f4410841ac3ce0aeb9bd">context_size</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="structst__ptls__aead__algorithm__t.html#aa2475f9382f0088dff79950f1966acd1">  302</a></span>&#160;    int (*<a class="code" href="structst__ptls__aead__algorithm__t.html#aa2475f9382f0088dff79950f1966acd1">setup_crypto</a>)(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">int</span> is_enc, <span class="keyword">const</span> <span class="keywordtype">void</span> *key);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;} <a class="code" href="picotls_8h.html#a2b06abcca441f5b988b8d513d5e53086">ptls_aead_algorithm_t</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14">  308</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14">en_ptls_hash_final_mode_t</a> {</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14a65703dfcdaf9b71ed80df327810ca095">  312</a></span>&#160;    <a class="code" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14a65703dfcdaf9b71ed80df327810ca095">PTLS_HASH_FINAL_MODE_FREE</a> = 0,</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14aa215d40d6b824cace989649c5cf8eeaa">  316</a></span>&#160;    <a class="code" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14aa215d40d6b824cace989649c5cf8eeaa">PTLS_HASH_FINAL_MODE_RESET</a> = 1,</div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14a871251d097d802df29d54855dbd5cca6">  320</a></span>&#160;    <a class="code" href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14a871251d097d802df29d54855dbd5cca6">PTLS_HASH_FINAL_MODE_SNAPSHOT</a> = 2</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;} <a class="code" href="picotls_8h.html#a757ec632327d89ef1c52b279362442e1">ptls_hash_final_mode_t</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="structst__ptls__hash__context__t.html">  326</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__hash__context__t.html">st_ptls_hash_context_t</a> {</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="structst__ptls__hash__context__t.html#a77ddb62cd2358c16d8aa88101b39e146">  330</a></span>&#160;    void (*<a class="code" href="structst__ptls__hash__context__t.html#a77ddb62cd2358c16d8aa88101b39e146">update</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__hash__context__t.html">st_ptls_hash_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *src, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="structst__ptls__hash__context__t.html#ac6d9b9f493affc430551b26f1c3cbbac">  334</a></span>&#160;    void (* <span class="keyword">final</span>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__hash__context__t.html">st_ptls_hash_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *md, <a class="code" href="picotls_8h.html#a757ec632327d89ef1c52b279362442e1">ptls_hash_final_mode_t</a> mode);</div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="structst__ptls__hash__context__t.html#a0063be257301d231918d44d235d2bbc1">  338</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structst__ptls__hash__context__t.html">st_ptls_hash_context_t</a> *(*clone_)(<span class="keyword">struct </span><a class="code" href="structst__ptls__hash__context__t.html">st_ptls_hash_context_t</a> *src);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;} <a class="code" href="picotls_8h.html#a40796f9d4489a0adfaa5eb48a6252a69">ptls_hash_context_t</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="structst__ptls__hash__algorithm__t.html">  344</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__hash__algorithm__t.html">st_ptls_hash_algorithm_t</a> {</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="structst__ptls__hash__algorithm__t.html#ad345d651135a934f00ec6c42a729b2c0">  348</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__hash__algorithm__t.html#ad345d651135a934f00ec6c42a729b2c0">block_size</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="structst__ptls__hash__algorithm__t.html#a20aac0b6277eca956fbd88f871bdde36">  352</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__hash__algorithm__t.html#a20aac0b6277eca956fbd88f871bdde36">digest_size</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="structst__ptls__hash__algorithm__t.html#ab5634327fa72a3b9fcbca72b5f0f5091">  356</a></span>&#160;    <a class="code" href="structst__ptls__hash__context__t.html">ptls_hash_context_t</a> *(*create)(void);</div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="structst__ptls__hash__algorithm__t.html#a785835ff5a4329f46456faf92ff718bd">  360</a></span>&#160;    uint8_t <a class="code" href="structst__ptls__hash__algorithm__t.html#a785835ff5a4329f46456faf92ff718bd">empty_digest</a>[<a class="code" href="picotls_8h.html#a7b871b714f154f9486d248ba42999531">PTLS_MAX_DIGEST_SIZE</a>];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;} <a class="code" href="picotls_8h.html#ae421cae6e308667fba6bc220233087f0">ptls_hash_algorithm_t</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__suite__t.html">  363</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__cipher__suite__t.html">st_ptls_cipher_suite_t</a> {</div>
<div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__suite__t.html#abc7903325655ffc54d81c3f12be178d5">  364</a></span>&#160;    uint16_t <a class="code" href="structst__ptls__cipher__suite__t.html#abc7903325655ffc54d81c3f12be178d5">id</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__suite__t.html#a37cfd69934248c8fa0ef95d9dbe8f93e">  365</a></span>&#160;    <a class="code" href="structst__ptls__aead__algorithm__t.html">ptls_aead_algorithm_t</a> *<a class="code" href="structst__ptls__cipher__suite__t.html#a37cfd69934248c8fa0ef95d9dbe8f93e">aead</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="structst__ptls__cipher__suite__t.html#af0c711b190c378c2993839fcc9612c9a">  366</a></span>&#160;    <a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *<a class="code" href="structst__ptls__cipher__suite__t.html#af0c711b190c378c2993839fcc9612c9a">hash</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;} <a class="code" href="picotls_8h.html#af1dea0d2db4d4d0d1e46c4ed9f8f4130">ptls_cipher_suite_t</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">struct </span><a class="code" href="structst__ptls__traffic__protection__t.html">st_ptls_traffic_protection_t</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="structst__ptls__message__emitter__t.html">  371</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__message__emitter__t.html">st_ptls_message_emitter_t</a> {</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="structst__ptls__message__emitter__t.html#aad9a41adb1cca3126e1fe3dc5b5b6e7a">  372</a></span>&#160;    <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="structst__ptls__message__emitter__t.html#aad9a41adb1cca3126e1fe3dc5b5b6e7a">buf</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="structst__ptls__message__emitter__t.html#a5eb9e7bc82dfa36221c3c04c3ff49684">  373</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structst__ptls__traffic__protection__t.html">st_ptls_traffic_protection_t</a> *<a class="code" href="structst__ptls__message__emitter__t.html#a5eb9e7bc82dfa36221c3c04c3ff49684">enc</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="structst__ptls__message__emitter__t.html#a8aeda1ec12d7f89912059feb223ec48d">  374</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__message__emitter__t.html#a8aeda1ec12d7f89912059feb223ec48d">record_header_length</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="structst__ptls__message__emitter__t.html#a8518235c00ebae7606e357ba093a2d1e">  375</a></span>&#160;    int (*<a class="code" href="structst__ptls__message__emitter__t.html#a8518235c00ebae7606e357ba093a2d1e">begin_message</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__message__emitter__t.html">st_ptls_message_emitter_t</a> *<span class="keyword">self</span>);</div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="structst__ptls__message__emitter__t.html#a961460efa5e7059dd20165229a647c48">  376</a></span>&#160;    int (*<a class="code" href="structst__ptls__message__emitter__t.html#a961460efa5e7059dd20165229a647c48">commit_message</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__message__emitter__t.html">st_ptls_message_emitter_t</a> *<span class="keyword">self</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;} <a class="code" href="picotls_8h.html#a6f5ef09de44ae8adae89bed994848170">ptls_message_emitter_t</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html">  382</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__esni__context__t.html">st_ptls_esni_context_t</a> {</div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html#af1164a4e4ebf1f08a08409c310f405ac">  383</a></span>&#160;    <a class="code" href="structst__ptls__key__exchange__context__t.html">ptls_key_exchange_context_t</a> **<a class="code" href="structst__ptls__esni__context__t.html#af1164a4e4ebf1f08a08409c310f405ac">key_exchanges</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html#a72d6378c88153f996f9b3f871336e88e">  385</a></span>&#160;        <a class="code" href="structst__ptls__cipher__suite__t.html">ptls_cipher_suite_t</a> *<a class="code" href="structst__ptls__esni__context__t.html#a72d6378c88153f996f9b3f871336e88e">cipher_suite</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html#ab080c1d64e1a3d143548a5751efcf2fa">  386</a></span>&#160;        uint8_t <a class="code" href="structst__ptls__esni__context__t.html#ab080c1d64e1a3d143548a5751efcf2fa">record_digest</a>[<a class="code" href="picotls_8h.html#a7b871b714f154f9486d248ba42999531">PTLS_MAX_DIGEST_SIZE</a>];</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    } * <a class="code" href="structst__ptls__esni__context__t.html#a1a01e78ae37724d84a0cf838a842da9f">cipher_suites</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html#a63d568da456b40aca4ad345c253db76d">  388</a></span>&#160;    uint16_t <a class="code" href="structst__ptls__esni__context__t.html#a63d568da456b40aca4ad345c253db76d">padded_length</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html#a3b427bd55c5fee130a830bce959675b8">  389</a></span>&#160;    uint64_t <a class="code" href="structst__ptls__esni__context__t.html#a3b427bd55c5fee130a830bce959675b8">not_before</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno"><a class="line" href="structst__ptls__esni__context__t.html#aa45a113dbd5b0f4fc80d3d2a9353d44b">  390</a></span>&#160;    uint64_t <a class="code" href="structst__ptls__esni__context__t.html#aa45a113dbd5b0f4fc80d3d2a9353d44b">not_after</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;} <a class="code" href="picotls_8h.html#ade514b23e0a4211e5a8cec8268f7f834">ptls_esni_context_t</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae45f2f3d4be7bf98b8598de172189379">  393</a></span>&#160;<span class="preprocessor">#define PTLS_CALLBACK_TYPE0(ret, name)                                                                                             \</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">    typedef struct st_ptls_##name##_t {                                                                                            \</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">        ret (*cb)(struct st_ptls_##name##_t * self);                                                                               \</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">    } ptls_##name##_t</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">  398</a></span>&#160;<span class="preprocessor">#define PTLS_CALLBACK_TYPE(ret, name, ...)                                                                                         \</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">    typedef struct st_ptls_##name##_t {                                                                                            \</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">        ret (*cb)(struct st_ptls_##name##_t * self, __VA_ARGS__);                                                                  \</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">    } ptls_##name##_t</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="structst__ptls__on__client__hello__parameters__t.html">  406</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__on__client__hello__parameters__t.html">st_ptls_on_client_hello_parameters_t</a> {</div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="structst__ptls__on__client__hello__parameters__t.html#ab01e22f4399901ea14015136cd53c496">  410</a></span>&#160;    <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#ab01e22f4399901ea14015136cd53c496">server_name</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="structst__ptls__on__client__hello__parameters__t.html#ae4e60ef823dae4c8fcd38d6c5a0869c9">  415</a></span>&#160;        <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *<a class="code" href="structst__ptls__on__client__hello__parameters__t.html#ae4e60ef823dae4c8fcd38d6c5a0869c9">list</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="structst__ptls__on__client__hello__parameters__t.html#abe262962648eac0637861d3d6d559ef9">  416</a></span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#abe262962648eac0637861d3d6d559ef9">count</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    } <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#a5014f0558f940b1c54e065c41d6d8f4d">negotiated_protocols</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="structst__ptls__on__client__hello__parameters__t.html#ad2f29639d481c3eb60167caffec7866a">  419</a></span>&#160;        <span class="keyword">const</span> uint16_t *<a class="code" href="structst__ptls__on__client__hello__parameters__t.html#ad2f29639d481c3eb60167caffec7866a">list</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#abe262962648eac0637861d3d6d559ef9">count</a>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    } <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#afeb68134f80db7c7bf7fd4a5865774f1">signature_algorithms</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">const</span> uint16_t *<a class="code" href="structst__ptls__on__client__hello__parameters__t.html#ae4e60ef823dae4c8fcd38d6c5a0869c9">list</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#abe262962648eac0637861d3d6d559ef9">count</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    } <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#a25d69aca7700f1be74058dd7faf905f0">certificate_compression_algorithms</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="structst__ptls__on__client__hello__parameters__t.html#ac757d68182ccf9a54720a788931a7391">  429</a></span>&#160;    uint8_t <a class="code" href="structst__ptls__on__client__hello__parameters__t.html#ac757d68182ccf9a54720a788931a7391">esni</a> : 1;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;} <a class="code" href="picotls_8h.html#aa371ef01225d2416fb19cb54bc85150b">ptls_on_client_hello_parameters_t</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<a class="code" href="picotls_8h.html#ae45f2f3d4be7bf98b8598de172189379">PTLS_CALLBACK_TYPE0</a>(uint64_t, <a class="code" href="lib_2picotls_8c.html#a8585bf4362e3a8747e1a1df5a784c057">get_time</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, on_client_hello, <a class="code" href="structst__ptls__t.html">ptls_t</a> *<a class="code" href="structtls.html">tls</a>, <a class="code" href="structst__ptls__on__client__hello__parameters__t.html">ptls_on_client_hello_parameters_t</a> *params);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, emit_certificate, <a class="code" href="structst__ptls__t.html">ptls_t</a> *<a class="code" href="structtls.html">tls</a>, <a class="code" href="structst__ptls__message__emitter__t.html">ptls_message_emitter_t</a> *emitter, <a class="code" href="structst__ptls__key__schedule__t.html">ptls_key_schedule_t</a> *key_sched,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                   <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> context, <span class="keywordtype">int</span> push_status_request);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, <a class="code" href="lib_2openssl_8c.html#af035e4d439e5efcf2108c1ebdf82c39f">sign_certificate</a>, <a class="code" href="structst__ptls__t.html">ptls_t</a> *<a class="code" href="structtls.html">tls</a>, uint16_t *selected_algorithm, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *output, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                   <span class="keyword">const</span> uint16_t *<a class="code" href="certificate__compression_8c.html#ac71a8cfdde90b148144bfc42a6a713f9">algorithms</a>, <span class="keywordtype">size_t</span> num_algorithms);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, <a class="code" href="t_2picotls_8c.html#a44502cfddc409d1237460605e1fcf6f7">verify_certificate</a>, <a class="code" href="structst__ptls__t.html">ptls_t</a> *<a class="code" href="structtls.html">tls</a>,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                   <span class="keywordtype">int</span> (**<a class="code" href="lib_2openssl_8c.html#a7ed99c87b711d8e2e5d8a87d9b8b3d75">verify_sign</a>)(<span class="keywordtype">void</span> *verify_ctx, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> data, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> sign), <span class="keywordtype">void</span> **verify_data,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                   <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *certs, <span class="keywordtype">size_t</span> num_certs);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, <a class="code" href="tls_8c.html#a4f25450b3aa01cc353142a2b8d76cfd9">encrypt_ticket</a>, <a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keywordtype">int</span> is_encrypt, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *dst, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> src);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, <a class="code" href="tls_8c.html#a3a920c80db919ca11a75003ebcceacb8">save_ticket</a>, <a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">void</span>, log_secret, <a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keyword">const</span> <span class="keywordtype">char</span> *label, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> secret);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">void</span>, <a class="code" href="lib_2picotls_8c.html#a14c83de31e76992b20510eef18075173">update_open_count</a>, <a class="code" href="wincompat_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a> delta);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, <a class="code" href="lib_2picotls_8c.html#a7e917599d9876a6c3fa9e470c64fcf67">update_traffic_key</a>, <a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keywordtype">int</span> is_enc, <span class="keywordtype">size_t</span> epoch, <span class="keyword">const</span> <span class="keywordtype">void</span> *secret);</div>
<div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="structst__ptls__decompress__certificate__t.html">  485</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__decompress__certificate__t.html">st_ptls_decompress_certificate_t</a> {</div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="structst__ptls__decompress__certificate__t.html#aeeb17894ba6600c06f61f616cada32f3">  489</a></span>&#160;    <span class="keyword">const</span> uint16_t *<a class="code" href="structst__ptls__decompress__certificate__t.html#aeeb17894ba6600c06f61f616cada32f3">supported_algorithms</a>;</div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="structst__ptls__decompress__certificate__t.html#a2ada98b85521d2270f2bf0e32e70ebc7">  493</a></span>&#160;    int (*<a class="code" href="structst__ptls__decompress__certificate__t.html#a2ada98b85521d2270f2bf0e32e70ebc7">cb</a>)(<span class="keyword">struct </span><a class="code" href="structst__ptls__decompress__certificate__t.html">st_ptls_decompress_certificate_t</a> *<span class="keyword">self</span>, <a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, uint16_t algorithm, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> output,</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;              <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;} <a class="code" href="picotls_8h.html#aae19f39e79c5f188656386aeb453114f">ptls_decompress_certificate_t</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<a class="code" href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a>(<span class="keywordtype">int</span>, update_esni_key, <a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> secret, <a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *hash,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">void</span> *hashed_esni_contents);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html">  505</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structst__ptls__context__t.html">st_ptls_context_t</a> {</div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a5e55174d6f18868b84b97b8b7912e9dc">  509</a></span>&#160;    void (*<a class="code" href="structst__ptls__context__t.html#a5e55174d6f18868b84b97b8b7912e9dc">random_bytes</a>)(<span class="keywordtype">void</span> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a3735963f99387d0cd474c814341c6b03">  513</a></span>&#160;    ptls_get_time_t *<a class="code" href="structst__ptls__context__t.html#a3735963f99387d0cd474c814341c6b03">get_time</a>;</div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#aa41a4e58c894088754b3721b8756da9e">  517</a></span>&#160;    <a class="code" href="structst__ptls__key__exchange__algorithm__t.html">ptls_key_exchange_algorithm_t</a> **<a class="code" href="structst__ptls__context__t.html#aa41a4e58c894088754b3721b8756da9e">key_exchanges</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a4a9215da82662bfc0fcefa6bd4efcfa5">  521</a></span>&#160;    <a class="code" href="structst__ptls__cipher__suite__t.html">ptls_cipher_suite_t</a> **<a class="code" href="structst__ptls__context__t.html#a4a9215da82662bfc0fcefa6bd4efcfa5">cipher_suites</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a3f9776853286948493be43f28874fd66">  526</a></span>&#160;        <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *<a class="code" href="structst__ptls__context__t.html#a3f9776853286948493be43f28874fd66">list</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a3fee767223d96d8662b2c70f63d3116a">  527</a></span>&#160;        <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__context__t.html#a3fee767223d96d8662b2c70f63d3116a">count</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    } <a class="code" href="structst__ptls__context__t.html#a63616c73b5f48fdc16e74098f9a88189">certificates</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a40cb7a5d43562f6b15ffc768f296ea4d">  532</a></span>&#160;    <a class="code" href="structst__ptls__esni__context__t.html">ptls_esni_context_t</a> **<a class="code" href="structst__ptls__context__t.html#a40cb7a5d43562f6b15ffc768f296ea4d">esni</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a8b8c566f2024f8f5a7a17bca54656ef1">  536</a></span>&#160;    ptls_on_client_hello_t *<a class="code" href="structst__ptls__context__t.html#a8b8c566f2024f8f5a7a17bca54656ef1">on_client_hello</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a4b1b564adcf4b4f35b651d995f61c03b">  540</a></span>&#160;    ptls_emit_certificate_t *<a class="code" href="structst__ptls__context__t.html#a4b1b564adcf4b4f35b651d995f61c03b">emit_certificate</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a9e2778cd999b7d1873a0e3864bf214a5">  544</a></span>&#160;    ptls_sign_certificate_t *<a class="code" href="structst__ptls__context__t.html#a9e2778cd999b7d1873a0e3864bf214a5">sign_certificate</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#aa936b23df016f933eaf8ee2474300f6a">  548</a></span>&#160;    ptls_verify_certificate_t *<a class="code" href="structst__ptls__context__t.html#aa936b23df016f933eaf8ee2474300f6a">verify_certificate</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a719e7a766af65cb0ead4cce911ba7fc6">  552</a></span>&#160;    uint32_t <a class="code" href="structst__ptls__context__t.html#a719e7a766af65cb0ead4cce911ba7fc6">ticket_lifetime</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a3f43ad568dcb2c7a93425c000c5ba564">  556</a></span>&#160;    uint32_t <a class="code" href="structst__ptls__context__t.html#a3f43ad568dcb2c7a93425c000c5ba564">max_early_data_size</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#af64bd984b75a6cd8e71de1324ee8efe2">  561</a></span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structst__ptls__context__t.html#af64bd984b75a6cd8e71de1324ee8efe2">hkdf_label_prefix__obsolete</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#af452e1ceae7177afe73d636c355d8319">  565</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__context__t.html#af452e1ceae7177afe73d636c355d8319">require_dhe_on_psk</a> : 1;</div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#aa84bd8239640d6a9bbb85ccfcd5943fe">  569</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__context__t.html#aa84bd8239640d6a9bbb85ccfcd5943fe">use_exporter</a> : 1;</div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a712a4d57ba7d5f273ffec970bdb54565">  573</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__context__t.html#a712a4d57ba7d5f273ffec970bdb54565">send_change_cipher_spec</a> : 1;</div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#aa9922222dbb79bcd79cfc0ee64150e12">  578</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__context__t.html#aa9922222dbb79bcd79cfc0ee64150e12">require_client_authentication</a> : 1;</div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a0b37ccad85147cfeb089a171f7ca0302">  582</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__context__t.html#a0b37ccad85147cfeb089a171f7ca0302">omit_end_of_early_data</a> : 1;</div>
<div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a3de2d7891343c2ae713bab76110e8526">  586</a></span>&#160;    ptls_encrypt_ticket_t *<a class="code" href="structst__ptls__context__t.html#a3de2d7891343c2ae713bab76110e8526">encrypt_ticket</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a98f5bb251599e1b78a900e1197fd2025">  590</a></span>&#160;    ptls_save_ticket_t *<a class="code" href="structst__ptls__context__t.html#a98f5bb251599e1b78a900e1197fd2025">save_ticket</a>;</div>
<div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a5413b49ca15afa370fbba2e56f793521">  594</a></span>&#160;    ptls_log_secret_t *<a class="code" href="structst__ptls__context__t.html#a5413b49ca15afa370fbba2e56f793521">log_secret</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a73a61c1af7556581b21f97b67c2592a0">  598</a></span>&#160;    ptls_update_open_count_t *<a class="code" href="structst__ptls__context__t.html#a73a61c1af7556581b21f97b67c2592a0">update_open_count</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#ae3dfc40950255ba317e70973f7862946">  602</a></span>&#160;    ptls_update_traffic_key_t *<a class="code" href="structst__ptls__context__t.html#ae3dfc40950255ba317e70973f7862946">update_traffic_key</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a9cd8c23c42f657bf1aa150baefda0473">  606</a></span>&#160;    <a class="code" href="structst__ptls__decompress__certificate__t.html">ptls_decompress_certificate_t</a> *<a class="code" href="structst__ptls__context__t.html#a9cd8c23c42f657bf1aa150baefda0473">decompress_certificate</a>;</div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="structst__ptls__context__t.html#a9d8a0749454d25344c4565fbc131f891">  610</a></span>&#160;    ptls_update_esni_key_t *<a class="code" href="structst__ptls__context__t.html#a9d8a0749454d25344c4565fbc131f891">update_esni_key</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;};</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="structst__ptls__raw__extension__t.html">  613</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__raw__extension__t.html">st_ptls_raw_extension_t</a> {</div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="structst__ptls__raw__extension__t.html#ae6fab3cc862956a1ea71b194a1142ae7">  614</a></span>&#160;    uint16_t <a class="code" href="structst__ptls__raw__extension__t.html#ae6fab3cc862956a1ea71b194a1142ae7">type</a>;</div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="structst__ptls__raw__extension__t.html#afc0ee1c62890633ccc1f77107b9674bb">  615</a></span>&#160;    <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__raw__extension__t.html#afc0ee1c62890633ccc1f77107b9674bb">data</a>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;} <a class="code" href="picotls_8h.html#a6d073682347b281fc34d182ab144a1e5">ptls_raw_extension_t</a>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor"></span><span class="comment">/* suppress warning C4201: nonstandard extension used: nameless struct/union */</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#pragma warning(push)</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#pragma warning(disable : 4201)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html">  626</a></span>&#160;<span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structst__ptls__handshake__properties__t.html">st_ptls_handshake_properties_t</a> {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keyword">union </span>{</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a9f8b8f9789f3023812f1346fd7af0ea1">  633</a></span>&#160;                <span class="keyword">const</span> <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *<a class="code" href="structst__ptls__handshake__properties__t.html#a9f8b8f9789f3023812f1346fd7af0ea1">list</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a809b9a9bacec9032eaf51df67fdaa3de">  634</a></span>&#160;                <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__handshake__properties__t.html#a809b9a9bacec9032eaf51df67fdaa3de">count</a>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            } <a class="code" href="structst__ptls__handshake__properties__t.html#a012ace0756de1b672b7960caf78fa51d">negotiated_protocols</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a1f0a2bc5339da566f052d22ea9a6ffcb">  639</a></span>&#160;            <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__handshake__properties__t.html#a1f0a2bc5339da566f052d22ea9a6ffcb">session_ticket</a>;</div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#aff6c42b222e366b58e960d6747e403c4">  645</a></span>&#160;            <span class="keywordtype">size_t</span> *<a class="code" href="structst__ptls__handshake__properties__t.html#aff6c42b222e366b58e960d6747e403c4">max_early_data_size</a>;</div>
<div class="line"><a name="l00650"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#ac88edb6177f2f206a8b153707ac286cc">  650</a></span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__handshake__properties__t.html#ac88edb6177f2f206a8b153707ac286cc">early_data_accepted_by_peer</a> : 1;</div>
<div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#afc7a0da22ad5b4c8fd41ad0c35bf2dd8">  654</a></span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__handshake__properties__t.html#afc7a0da22ad5b4c8fd41ad0c35bf2dd8">negotiate_before_key_exchange</a> : 1;</div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#acede22e7c0ca83c336f0823825bae4ea">  658</a></span>&#160;            <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__handshake__properties__t.html#acede22e7c0ca83c336f0823825bae4ea">esni_keys</a>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        } <a class="code" href="structst__ptls__handshake__properties__t.html#a2274c427a2db1581be49459391e13a59">client</a>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00665"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a4df8be7485bb310b53a4447bfd8a0f19">  665</a></span>&#160;                uint8_t <a class="code" href="structst__ptls__handshake__properties__t.html#a4df8be7485bb310b53a4447bfd8a0f19">base</a>[<a class="code" href="picotls_8h.html#a7b871b714f154f9486d248ba42999531">PTLS_MAX_DIGEST_SIZE</a>];</div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#af843dbaa97d6cb47c7dee486e4b361cb">  666</a></span>&#160;                <span class="keywordtype">size_t</span> <a class="code" href="structst__ptls__handshake__properties__t.html#af843dbaa97d6cb47c7dee486e4b361cb">len</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            } <a class="code" href="structst__ptls__handshake__properties__t.html#aeed1d50318091605941b2aab4338dc0c">selected_psk_binder</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a73303123cc1954e1173bb594b9a1a136">  676</a></span>&#160;                <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="structst__ptls__handshake__properties__t.html#a73303123cc1954e1173bb594b9a1a136">key</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#aa3e1ae9d602dabd0e078bab24a894838">  680</a></span>&#160;                <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__handshake__properties__t.html#aa3e1ae9d602dabd0e078bab24a894838">additional_data</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            } <a class="code" href="structst__ptls__handshake__properties__t.html#a66c6c55ed97e904247950431fac3aa61">cookie</a>;</div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#af7f0388d48981a97a285dce2f6bf7b8a">  685</a></span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__handshake__properties__t.html#af7f0388d48981a97a285dce2f6bf7b8a">enforce_retry</a> : 1;</div>
<div class="line"><a name="l00689"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a0c4f83bebeed217f7c2a06bc82c3c9dd">  689</a></span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="structst__ptls__handshake__properties__t.html#a0c4f83bebeed217f7c2a06bc82c3c9dd">retry_uses_cookie</a> : 1;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        } <a class="code" href="structst__ptls__handshake__properties__t.html#aeec43aff6597e285c274772f191d6753">server</a>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    };</div>
<div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#ae6aeb4d46c7234ea19982bce16da392e">  695</a></span>&#160;    <a class="code" href="structst__ptls__raw__extension__t.html">ptls_raw_extension_t</a> *<a class="code" href="structst__ptls__handshake__properties__t.html#ae6aeb4d46c7234ea19982bce16da392e">additional_extensions</a>;</div>
<div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#a7d1c6d18a71c786fe8ff9d1961e64ea7">  699</a></span>&#160;    int (*<a class="code" href="structst__ptls__handshake__properties__t.html#a7d1c6d18a71c786fe8ff9d1961e64ea7">collect_extension</a>)(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keyword">struct </span><a class="code" href="structst__ptls__handshake__properties__t.html">st_ptls_handshake_properties_t</a> *properties, uint16_t type);</div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="structst__ptls__handshake__properties__t.html#af56902f5bb8b000d73fc1948e16b9ed9">  703</a></span>&#160;    int (*<a class="code" href="structst__ptls__handshake__properties__t.html#af56902f5bb8b000d73fc1948e16b9ed9">collected_extensions</a>)(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keyword">struct </span><a class="code" href="structst__ptls__handshake__properties__t.html">st_ptls_handshake_properties_t</a> *properties, <a class="code" href="structst__ptls__raw__extension__t.html">ptls_raw_extension_t</a> *extensions);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;} <a class="code" href="picotls_8h.html#a31520ba2b83cd48c5c142bd93c2af80b">ptls_handshake_properties_t</a>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">#ifdef _WINDOWS</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#pragma warning(pop)</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keyword">static</span> <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597">ptls_iovec_init</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *p, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723">ptls_buffer_init</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keywordtype">void</span> *smallbuf, <span class="keywordtype">size_t</span> smallbuf_size);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4">ptls_buffer_dispose</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0">ptls_buffer__release_memory</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#ac3aed9c2ae399575c55bf3447b0c72fe">ptls_buffer_reserve</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keywordtype">size_t</span> delta);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a6d73fdc0d0da73a43906921c57a452ad">ptls_buffer__do_pushv</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *src, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a544f93cddb0cdbebf81224d0f755843a">ptls_buffer__adjust_asn1_blocksize</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keywordtype">size_t</span> body_size);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a4f664904be533a2bddea5e4c98838497">ptls_buffer_push_asn1_ubigint</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *bignum, <span class="keywordtype">size_t</span> size);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae0b9f05d3e5e72718ea7212975b10a67">  742</a></span>&#160;<span class="preprocessor">#define ptls_buffer_pushv(buf, src, len)                                                                                           \</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">        if ((ret = ptls_buffer__do_pushv((buf), (src), (len))) != 0)                                                               \</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00748"></a><span class="lineno"><a class="line" href="picotls_8h.html#aef1dff438cf0c6ee5877ebc86a099ba2">  748</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push(buf, ...)                                                                                                 \</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor">        if ((ret = ptls_buffer__do_pushv((buf), (uint8_t[]){__VA_ARGS__}, sizeof((uint8_t[]){__VA_ARGS__}))) != 0)                 \</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="picotls_8h.html#aafb85cb09daee5098a0311e1caacd3a4">  754</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push16(buf, v)                                                                                                 \</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">        uint16_t _v = (v);                                                                                                         \</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="preprocessor">        ptls_buffer_push(buf, (uint8_t)(_v &gt;&gt; 8), (uint8_t)_v);                                                                    \</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="picotls_8h.html#a519f780f3942b349c840bc5c101d9544">  760</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push24(buf, v)                                                                                                 \</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor">        uint32_t _v = (v);                                                                                                         \</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="preprocessor">        ptls_buffer_push(buf, (uint8_t)(_v &gt;&gt; 16), (uint8_t)(_v &gt;&gt; 8), (uint8_t)_v);                                               \</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00766"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa820707629a3be7d3093ed68b8cd9524">  766</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push32(buf, v)                                                                                                 \</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="preprocessor">        uint32_t _v = (v);                                                                                                         \</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="preprocessor">        ptls_buffer_push(buf, (uint8_t)(_v &gt;&gt; 24), (uint8_t)(_v &gt;&gt; 16), (uint8_t)(_v &gt;&gt; 8), (uint8_t)_v);                          \</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="picotls_8h.html#a363a4574e3d4444faa34fefab5ef84b8">  772</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push64(buf, v)                                                                                                 \</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">        uint64_t _v = (v);                                                                                                         \</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">        ptls_buffer_push(buf, (uint8_t)(_v &gt;&gt; 56), (uint8_t)(_v &gt;&gt; 48), (uint8_t)(_v &gt;&gt; 40), (uint8_t)(_v &gt;&gt; 32),                  \</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="preprocessor">                         (uint8_t)(_v &gt;&gt; 24), (uint8_t)(_v &gt;&gt; 16), (uint8_t)(_v &gt;&gt; 8), (uint8_t)_v);                               \</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00779"></a><span class="lineno"><a class="line" href="picotls_8h.html#a76e57b447560603b8d8ba37d96311941">  779</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push_block(buf, _capacity, block)                                                                              \</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="preprocessor">        size_t capacity = (_capacity);                                                                                             \</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="preprocessor">        ptls_buffer_pushv((buf), (uint8_t *)&quot;\0\0\0\0\0\0\0&quot;, capacity);                                                           \</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">        size_t body_start = (buf)-&gt;off;                                                                                            \</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="preprocessor">        do {                                                                                                                       \</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="preprocessor">            block                                                                                                                  \</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">        } while (0);                                                                                                               \</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="preprocessor">        size_t body_size = (buf)-&gt;off - body_start;                                                                                \</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor">        for (; capacity != 0; --capacity)                                                                                          \</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="preprocessor">            (buf)-&gt;base[body_start - capacity] = (uint8_t)(body_size &gt;&gt; (8 * (capacity - 1)));                                     \</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="picotls_8h.html#a8eb09bb927ef424cd38fa347c49e5a8a">  792</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push_asn1_block(buf, block)                                                                                    \</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="preprocessor">        ptls_buffer_push((buf), 0xff); </span><span class="comment">/* dummy */</span><span class="preprocessor">                                                                                 \</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="preprocessor">        size_t body_start = (buf)-&gt;off;                                                                                            \</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">        do {                                                                                                                       \</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="preprocessor">            block                                                                                                                  \</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">        } while (0);                                                                                                               \</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="preprocessor">        size_t body_size = (buf)-&gt;off - body_start;                                                                                \</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">        if (body_size &lt; 128) {                                                                                                     \</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">            (buf)-&gt;base[body_start - 1] = (uint8_t)body_size;                                                                      \</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="preprocessor">        } else {                                                                                                                   \</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">            if ((ret = ptls_buffer__adjust_asn1_blocksize((buf), body_size)) != 0)                                                 \</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="preprocessor">                goto Exit;                                                                                                         \</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="preprocessor">        }                                                                                                                          \</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="picotls_8h.html#a76a628261d8399a0510e972c4435e301">  808</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push_asn1_sequence(buf, block)                                                                                 \</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">        ptls_buffer_push((buf), 0x30);                                                                                             \</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">        ptls_buffer_push_asn1_block((buf), block);                                                                                 \</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00814"></a><span class="lineno"><a class="line" href="picotls_8h.html#ae7a66541e33d3815766649bd2ed29a51">  814</a></span>&#160;<span class="preprocessor">#define ptls_buffer_push_message_body(buf, key_sched, type, block)                                                                 \</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="preprocessor">        ptls_buffer_t *_buf = (buf);                                                                                               \</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="preprocessor">        ptls_key_schedule_t *_key_sched = (key_sched);                                                                             \</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="preprocessor">        size_t mess_start = _buf-&gt;off;                                                                                             \</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">        ptls_buffer_push(_buf, (type));                                                                                            \</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">        ptls_buffer_push_block(_buf, 3, block);                                                                                    \</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">        if (_key_sched != NULL)                                                                                                    \</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">            ptls__key_schedule_update_hash(_key_sched, _buf-&gt;base + mess_start, _buf-&gt;off - mess_start);                           \</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="picotls_8h.html#a97c3058a5950b53386d42c9ce41497a2">  825</a></span>&#160;<span class="preprocessor">#define ptls_push_message(emitter, key_sched, type, block)                                                                         \</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="preprocessor">        ptls_message_emitter_t *_emitter = (emitter);                                                                              \</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="preprocessor">        if ((ret = _emitter-&gt;begin_message(_emitter)) != 0)                                                                        \</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">        ptls_buffer_push_message_body(_emitter-&gt;buf, (key_sched), (type), block);                                                  \</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="preprocessor">        if ((ret = _emitter-&gt;commit_message(_emitter)) != 0)                                                                       \</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a2d02d6f477c8fa36dfe14c425c884762">ptls_decode16</a>(uint16_t *value, <span class="keyword">const</span> uint8_t **src, <span class="keyword">const</span> uint8_t *end);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#ae95e3b2be5491c9d4e1284d0b2917bc9">ptls_decode24</a>(uint32_t *value, <span class="keyword">const</span> uint8_t **src, <span class="keyword">const</span> uint8_t *end);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a6293010526fd7ac9dcaf83821e2e591d">ptls_decode32</a>(uint32_t *value, <span class="keyword">const</span> uint8_t **src, <span class="keyword">const</span> uint8_t *end);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a50aa9860710e7b2a1002ecbd4438c69e">ptls_decode64</a>(uint64_t *value, <span class="keyword">const</span> uint8_t **src, <span class="keyword">const</span> uint8_t *end);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno"><a class="line" href="picotls_8h.html#abda1609a9f6aecd016506ecb1d005a7f">  840</a></span>&#160;<span class="preprocessor">#define ptls_decode_open_block(src, end, capacity, block)                                                                          \</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="preprocessor">        size_t _capacity = (capacity);                                                                                             \</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">        if (_capacity &gt; (size_t)(end - (src))) {                                                                                   \</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="preprocessor">            ret = PTLS_ALERT_DECODE_ERROR;                                                                                         \</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="preprocessor">        }                                                                                                                          \</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="preprocessor">        size_t _block_size = 0;                                                                                                    \</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">        do {                                                                                                                       \</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="preprocessor">            _block_size = _block_size &lt;&lt; 8 | *(src)++;                                                                             \</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="preprocessor">        } while (--_capacity != 0);                                                                                                \</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">        if (_block_size &gt; (size_t)(end - (src))) {                                                                                 \</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="preprocessor">            ret = PTLS_ALERT_DECODE_ERROR;                                                                                         \</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">        }                                                                                                                          \</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">        do {                                                                                                                       \</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="preprocessor">            const uint8_t *const end = (src) + _block_size;                                                                        \</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="preprocessor">            do {                                                                                                                   \</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="preprocessor">                block                                                                                                              \</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="preprocessor">            } while (0);                                                                                                           \</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="preprocessor">            if ((src) != end) {                                                                                                    \</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="preprocessor">                ret = PTLS_ALERT_DECODE_ERROR;                                                                                     \</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor">                goto Exit;                                                                                                         \</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">            }                                                                                                                      \</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor">        } while (0);                                                                                                               \</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="picotls_8h.html#a7237f8b83ee717d120244b56c3978b00">  867</a></span>&#160;<span class="preprocessor">#define ptls_decode_assert_block_close(src, end)                                                                                   \</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="preprocessor">        if ((src) != end) {                                                                                                        \</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="preprocessor">            ret = PTLS_ALERT_DECODE_ERROR;                                                                                         \</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">            goto Exit;                                                                                                             \</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="preprocessor">        }                                                                                                                          \</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="preprocessor">    } while (0);</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00875"></a><span class="lineno"><a class="line" href="picotls_8h.html#a894ca94cbdb96f261fba5a39a507cdd9">  875</a></span>&#160;<span class="preprocessor">#define ptls_decode_block(src, end, capacity, block)                                                                               \</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">    do {                                                                                                                           \</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="preprocessor">        ptls_decode_open_block((src), end, capacity, block);                                                                       \</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="preprocessor">        ptls_decode_assert_block_close((src), end);                                                                                \</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">    } while (0)</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<a class="code" href="structst__ptls__t.html">ptls_t</a> *<a class="code" href="picotls_8h.html#aa142dbaa5d99942c25847febf894a1f4">ptls_new</a>(<a class="code" href="structst__ptls__context__t.html">ptls_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">int</span> is_server);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#afbd373f266a52a1718a3476b24c3a295">ptls_free</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<a class="code" href="structst__ptls__context__t.html">ptls_context_t</a> *<a class="code" href="picotls_8h.html#ac31fa41db2dea59eccf6284ce9aa5e7e">ptls_get_context</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a5694f93f231059ce9fadae6ad893d20e">ptls_set_context</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__context__t.html">ptls_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="picotls_8h.html#acbb30b5e02fad52e63b99be678d8a43c">ptls_get_client_random</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<a class="code" href="structst__ptls__cipher__suite__t.html">ptls_cipher_suite_t</a> *<a class="code" href="picotls_8h.html#a724ff019ff3a867c90b28e4d3e8b6e53">ptls_get_cipher</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="picotls_8h.html#aa889677e26863e1a37b216aedac72c67">ptls_get_server_name</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#abc4124b1bc5642960e94ebc06686a614">ptls_set_server_name</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keyword">const</span> <span class="keywordtype">char</span> *server_name, <span class="keywordtype">size_t</span> server_name_len);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="picotls_8h.html#ab8af003866ffad57334b31bf5290cbe8">ptls_get_negotiated_protocol</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a41fbce078a20dbc2fe15bb0b25da3411">ptls_set_negotiated_protocol</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keyword">const</span> <span class="keywordtype">char</span> *protocol, <span class="keywordtype">size_t</span> protocol_len);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a191fd22eb98e7eb3de49e83620d30015">ptls_handshake_is_complete</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a48da6806321331d00677c66444d7143d">ptls_is_psk_handshake</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="keywordtype">void</span> **<a class="code" href="picotls_8h.html#aefec8568e3aed02938b396752d54d5e5">ptls_get_data_ptr</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a05579d145dabba449415ded660d855c0">ptls_handshake</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *sendbuf, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> *inlen, <a class="code" href="structst__ptls__handshake__properties__t.html">ptls_handshake_properties_t</a> *args);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#ab1279dc8d5b7b0d1dff091118eddc322">ptls_receive</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *plaintextbuf, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> *<a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a17b1f731fc08806d7911d6dbad06a46b">ptls_send</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *sendbuf, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#ad29f9c5575e2c4123927d796e4921e7e">ptls_update_key</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keywordtype">int</span> request_update);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a4c8998052323166300a9b59bc6443337">ptls_is_server</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ac6485827fd640c2526e24b4592172873">ptls_get_record_overhead</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a8b8404e6fcc69862fa300c3a36de5c6c">ptls_send_alert</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *sendbuf, uint8_t level, uint8_t description);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a0a8567d56275ef767b54b865aa8805bd">ptls_export_secret</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <span class="keywordtype">void</span> *output, <span class="keywordtype">size_t</span> outlen, <span class="keyword">const</span> <span class="keywordtype">char</span> *label, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> context_value, <span class="keywordtype">int</span> is_early);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a0d7f1003ee015729b242cce9fe118df5">ptls_build_certificate_message</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> request_context, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> *certificates,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                   <span class="keywordtype">size_t</span> num_certificates, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> ocsp_status);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a74302ee2c0642a5f161c8b5d3b5dfc39">ptls_calc_hash</a>(<a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *algo, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *src, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<a class="code" href="structst__ptls__hash__context__t.html">ptls_hash_context_t</a> *<a class="code" href="picotls_8h.html#a5db4538399b7412c4dc994ed9041e952">ptls_hmac_create</a>(<a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *algo, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="structst__ptls__handshake__properties__t.html#a73303123cc1954e1173bb594b9a1a136">key</a>, <span class="keywordtype">size_t</span> key_size);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#aace42c0ca1898cb625aa1719dcfe67f0">ptls_hkdf_extract</a>(<a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *hash, <span class="keywordtype">void</span> *output, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> salt, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> ikm);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a02857b034439952d3f33e58e56f7e6a3">ptls_hkdf_expand</a>(<a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *hash, <span class="keywordtype">void</span> *output, <span class="keywordtype">size_t</span> outlen, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> prk, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> info);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#ad8b4abd44ba4d5f46a72ec9c08b07229">ptls_hkdf_expand_label</a>(<a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *algo, <span class="keywordtype">void</span> *output, <span class="keywordtype">size_t</span> outlen, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> secret, <span class="keyword">const</span> <span class="keywordtype">char</span> *label,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                           <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> hash_value, <span class="keyword">const</span> <span class="keywordtype">char</span> *label_prefix);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="picotls_8h.html#a229de01597e54002f209266c7b4055aa">ptls_cipher_new</a>(<a class="code" href="structst__ptls__cipher__algorithm__t.html">ptls_cipher_algorithm_t</a> *algo, <span class="keywordtype">int</span> is_enc, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="structst__ptls__handshake__properties__t.html#a73303123cc1954e1173bb594b9a1a136">key</a>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01">ptls_cipher_free</a>(<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#aa77dcaa131915406a4a03be70e268ff0">ptls_cipher_init</a>(<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *iv);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a2d3ae9c9f2704efb7abae1637cb97241">ptls_cipher_encrypt</a>(<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="picotls_8h.html#a04bb46d751b8ee324d6fe885e3cd50e7">ptls_aead_new</a>(<a class="code" href="structst__ptls__aead__algorithm__t.html">ptls_aead_algorithm_t</a> *aead, <a class="code" href="structst__ptls__hash__algorithm__t.html">ptls_hash_algorithm_t</a> *hash, <span class="keywordtype">int</span> is_enc, <span class="keyword">const</span> <span class="keywordtype">void</span> *secret,</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *label_prefix);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485">ptls_aead_free</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#a0ba1b8374ab826173b83493093b2aceb">ptls_aead_encrypt</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen, uint64_t seq, <span class="keyword">const</span> <span class="keywordtype">void</span> *aad,</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                         <span class="keywordtype">size_t</span> aadlen);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a93aa51d621b1cf204e5ea455db7e747e">ptls_aead_encrypt_init</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, uint64_t seq, <span class="keyword">const</span> <span class="keywordtype">void</span> *aad, <span class="keywordtype">size_t</span> aadlen);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ac80d132d2606d2af959cf5ab4f574766">ptls_aead_encrypt_update</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ad44b4fd94d7f19cdf846abf90260255c">ptls_aead_encrypt_final</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ad7908a62ead44bf0058b3672cd4321fc">ptls_aead_decrypt</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen, uint64_t seq,</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">void</span> *aad, <span class="keywordtype">size_t</span> aadlen);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#aa6a0008d415e04f0d67db03fdb2113de">ptls_get_read_epoch</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#aaf66968e2ad59ebf0f264cbb9d2f84f9">ptls_handle_message</a>(<a class="code" href="structst__ptls__t.html">ptls_t</a> *tls, <a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *sendbuf, <span class="keywordtype">size_t</span> epoch_offsets[5], <span class="keywordtype">size_t</span> in_epoch, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>,</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                        <span class="keywordtype">size_t</span> inlen, <a class="code" href="structst__ptls__handshake__properties__t.html">ptls_handshake_properties_t</a> *properties);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a850d1876076b7a5061ffae37aa929b41">ptls_aead__build_iv</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, uint8_t *iv, uint64_t seq);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a0129a2c9d51477ddaa75205b3f2072ee">ptls__key_schedule_update_hash</a>(<a class="code" href="structst__ptls__key__schedule__t.html">ptls_key_schedule_t</a> *sched, <span class="keyword">const</span> uint8_t *msg, <span class="keywordtype">size_t</span> msglen);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keyword">extern</span> void (*<span class="keyword">volatile</span> <a class="code" href="picotls_8h.html#a82d5946aaf61e208d7915b2b73c732a3">ptls_clear_memory</a>)(<span class="keywordtype">void</span> *p, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keyword">extern</span> int (*<span class="keyword">volatile</span> <a class="code" href="picotls_8h.html#a071e62d26b1f0976c9ea50ec5eca71aa">ptls_mem_equal</a>)(<span class="keyword">const</span> <span class="keywordtype">void</span> *x, <span class="keyword">const</span> <span class="keywordtype">void</span> *y, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keyword">static</span> <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597">ptls_iovec_init</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *p, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a55b4668776166a96a7acbfe0c90d1ca8">ptls_server_name_is_ipaddr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">/* inline functions */</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"><a class="line" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597"> 1105</a></span>&#160;<span class="keyword">inline</span> <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597">ptls_iovec_init</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *p, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;{</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">/* avoid the &quot;return (ptls_iovec_t){(uint8_t *)p, len};&quot; construct because it requires C99</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">     * and triggers a warning &quot;C4204: nonstandard extension used: non-constant aggregate initializer&quot;</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">     * in Visual Studio */</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="test__queue_8c.html#a5391b7f1199d134d62d41f3734ad4322">r</a>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    r.<a class="code" href="structst__ptls__iovec__t.html#a6a3ca90e0fee18ab6a55e47982271876">base</a> = (uint8_t *)p;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    r.<a class="code" href="structst__ptls__iovec__t.html#aa5ab20f9aa80ae7de96cff7cdf5aac57">len</a> = <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="test__queue_8c.html#a5391b7f1199d134d62d41f3734ad4322">r</a>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;}</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div>
<div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723"> 1116</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723">ptls_buffer_init</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>, <span class="keywordtype">void</span> *smallbuf, <span class="keywordtype">size_t</span> smallbuf_size)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;{</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="tassert_8h.html#a53022762464514790477ba81ce0ab36a">assert</a>(smallbuf != NULL);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    buf-&gt;<a class="code" href="structst__ptls__buffer__t.html#a4a96dcd8b941d061b85c7d3979890b1e">base</a> = (uint8_t *)smallbuf;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    buf-&gt;<a class="code" href="structst__ptls__buffer__t.html#a657a1152144567e35af6d295b16a1534">off</a> = 0;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    buf-&gt;<a class="code" href="structst__ptls__buffer__t.html#a1f096614a1a66eaa3c0458c02cd8f792">capacity</a> = smallbuf_size;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    buf-&gt;<a class="code" href="structst__ptls__buffer__t.html#a099e58c6cf4d258f47c6b525b3c45e12">is_allocated</a> = 0;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;}</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div>
<div class="line"><a name="l01125"></a><span class="lineno"><a class="line" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4"> 1125</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4">ptls_buffer_dispose</a>(<a class="code" href="structst__ptls__buffer__t.html">ptls_buffer_t</a> *<a class="code" href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a>)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;{</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0">ptls_buffer__release_memory</a>(buf);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    *buf = (<a class="code" href="picotls_8h.html#a3c9053bc53d8840504dcb6e25a33c7dd">ptls_buffer_t</a>){NULL};</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div>
<div class="line"><a name="l01131"></a><span class="lineno"><a class="line" href="picotls_8h.html#aa77dcaa131915406a4a03be70e268ff0"> 1131</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#aa77dcaa131915406a4a03be70e268ff0">ptls_cipher_init</a>(<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *iv)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;{</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    ctx-&gt;<a class="code" href="structst__ptls__cipher__context__t.html#a5735326f249b86955577cd8181e5d5c4">do_init</a>(ctx, iv);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;}</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"><a class="line" href="picotls_8h.html#a2d3ae9c9f2704efb7abae1637cb97241"> 1136</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a2d3ae9c9f2704efb7abae1637cb97241">ptls_cipher_encrypt</a>(<a class="code" href="structst__ptls__cipher__context__t.html">ptls_cipher_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> <a class="code" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    ctx-&gt;<a class="code" href="structst__ptls__cipher__context__t.html#abd75a02a8a54ed88e494874b75837b2c">do_transform</a>(ctx, output, input, len);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"><a class="line" href="picotls_8h.html#a93aa51d621b1cf204e5ea455db7e747e"> 1141</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a93aa51d621b1cf204e5ea455db7e747e">ptls_aead_encrypt_init</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, uint64_t seq, <span class="keyword">const</span> <span class="keywordtype">void</span> *aad, <span class="keywordtype">size_t</span> aadlen)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;{</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    uint8_t iv[<a class="code" href="picotls_8h.html#ac74362872a2014306e0a73d0b78963d4">PTLS_MAX_IV_SIZE</a>];</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="picotls_8h.html#a850d1876076b7a5061ffae37aa929b41">ptls_aead__build_iv</a>(ctx, iv, seq);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    ctx-&gt;<a class="code" href="structst__ptls__aead__context__t.html#a188e81d4226726d0aa781a8b0cb6b60f">do_encrypt_init</a>(ctx, iv, aad, aadlen);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="picotls_8h.html#ac80d132d2606d2af959cf5ab4f574766"> 1149</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ac80d132d2606d2af959cf5ab4f574766">ptls_aead_encrypt_update</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;{</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structst__ptls__aead__context__t.html#a6610d6f28759c2909873594c05b6dd4a">do_encrypt_update</a>(ctx, output, input, inlen);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div>
<div class="line"><a name="l01154"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad44b4fd94d7f19cdf846abf90260255c"> 1154</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ad44b4fd94d7f19cdf846abf90260255c">ptls_aead_encrypt_final</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;{</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structst__ptls__aead__context__t.html#a44f606086b767744ece15f652b85d3b5">do_encrypt_final</a>(ctx, output);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;}</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div>
<div class="line"><a name="l01159"></a><span class="lineno"><a class="line" href="picotls_8h.html#ad7908a62ead44bf0058b3672cd4321fc"> 1159</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="picotls_8h.html#ad7908a62ead44bf0058b3672cd4321fc">ptls_aead_decrypt</a>(<a class="code" href="structst__ptls__aead__context__t.html">ptls_aead_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">void</span> *output, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a>, <span class="keywordtype">size_t</span> inlen, uint64_t seq,</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">void</span> *aad, <span class="keywordtype">size_t</span> aadlen)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;{</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    uint8_t iv[<a class="code" href="picotls_8h.html#ac74362872a2014306e0a73d0b78963d4">PTLS_MAX_IV_SIZE</a>];</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="picotls_8h.html#a850d1876076b7a5061ffae37aa929b41">ptls_aead__build_iv</a>(ctx, iv, seq);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="structst__ptls__aead__context__t.html#a96ea72bb852a8fcee54ed0d1dab942b3">do_decrypt</a>(ctx, output, input, inlen, iv, aad, aadlen);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;}</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#a81fafd2f07929ad23e495dc140b61ea2">ptls_load_certificates</a>(<a class="code" href="structst__ptls__context__t.html">ptls_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <span class="keywordtype">char</span> <span class="keyword">const</span> *cert_pem_file);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keyword">extern</span> ptls_get_time_t <a class="code" href="picotls_8h.html#a674b849ad3cb04aadeaeaf6385c32337">ptls_get_time</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="keywordtype">int</span> <a class="code" href="picotls_8h.html#add70aeed61db77e5f28c6970f1463681">ptls_esni_init_context</a>(<a class="code" href="structst__ptls__context__t.html">ptls_context_t</a> *<a class="code" href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>, <a class="code" href="structst__ptls__esni__context__t.html">ptls_esni_context_t</a> *esni, <a class="code" href="structst__ptls__iovec__t.html">ptls_iovec_t</a> <a class="code" href="structst__ptls__handshake__properties__t.html#acede22e7c0ca83c336f0823825bae4ea">esni_keys</a>,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                           <a class="code" href="structst__ptls__key__exchange__context__t.html">ptls_key_exchange_context_t</a> **key_exchanges);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="keywordtype">void</span> <a class="code" href="picotls_8h.html#a9140abb073aee584d9f753f9aacb782b">ptls_esni_dispose_context</a>(<a class="code" href="structst__ptls__esni__context__t.html">ptls_esni_context_t</a> *esni);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"><a class="line" href="picotls_8h.html#a5e2e35c907a1d882fbd61642ef8ac2b6"> 1176</a></span>&#160;<span class="preprocessor">#define ptls_define_hash(name, ctx_type, init_func, update_func, final_func)                                                       \</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="preprocessor">                                                                                                                                   \</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="preprocessor">    struct name##_context_t {                                                                                                      \</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="preprocessor">        ptls_hash_context_t super;                                                                                                 \</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="preprocessor">        ctx_type ctx;                                                                                                              \</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="preprocessor">    };                                                                                                                             \</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="preprocessor">                                                                                                                                   \</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor">    static void name##_update(ptls_hash_context_t *_ctx, const void *src, size_t len)                                              \</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="preprocessor">    {                                                                                                                              \</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor">        struct name##_context_t *ctx = (struct name##_context_t *)_ctx;                                                            \</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="preprocessor">        update_func(&amp;ctx-&gt;ctx, src, len);                                                                                          \</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="preprocessor">    }                                                                                                                              \</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="preprocessor">                                                                                                                                   \</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="preprocessor">    static void name##_final(ptls_hash_context_t *_ctx, void *md, ptls_hash_final_mode_t mode)                                     \</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="preprocessor">    {                                                                                                                              \</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="preprocessor">        struct name##_context_t *ctx = (struct name##_context_t *)_ctx;                                                            \</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="preprocessor">        if (mode == PTLS_HASH_FINAL_MODE_SNAPSHOT) {                                                                               \</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="preprocessor">            ctx_type copy = ctx-&gt;ctx;                                                                                              \</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="preprocessor">            final_func(&amp;copy, md);                                                                                                 \</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="preprocessor">            ptls_clear_memory(&amp;copy, sizeof(copy));                                                                                \</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="preprocessor">            return;                                                                                                                \</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="preprocessor">        }                                                                                                                          \</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="preprocessor">        if (md != NULL)                                                                                                            \</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="preprocessor">            final_func(&amp;ctx-&gt;ctx, md);                                                                                             \</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="preprocessor">        switch (mode) {                                                                                                            \</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="preprocessor">        case PTLS_HASH_FINAL_MODE_FREE:                                                                                            \</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">            ptls_clear_memory(&amp;ctx-&gt;ctx, sizeof(ctx-&gt;ctx));                                                                        \</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="preprocessor">            free(ctx);                                                                                                             \</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="preprocessor">            break;                                                                                                                 \</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">        case PTLS_HASH_FINAL_MODE_RESET:                                                                                           \</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="preprocessor">            init_func(&amp;ctx-&gt;ctx);                                                                                                  \</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">            break;                                                                                                                 \</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="preprocessor">        default:                                                                                                                   \</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="preprocessor">            assert(!&quot;FIXME&quot;);                                                                                                      \</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="preprocessor">            break;                                                                                                                 \</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="preprocessor">        }                                                                                                                          \</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="preprocessor">    }                                                                                                                              \</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="preprocessor">                                                                                                                                   \</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="preprocessor">    static ptls_hash_context_t *name##_clone(ptls_hash_context_t *_src)                                                            \</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">    {                                                                                                                              \</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="preprocessor">        struct name##_context_t *dst, *src = (struct name##_context_t *)_src;                                                      \</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="preprocessor">        if ((dst = malloc(sizeof(*dst))) == NULL)                                                                                  \</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="preprocessor">            return NULL;                                                                                                           \</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="preprocessor">        *dst = *src;                                                                                                               \</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="preprocessor">        return &amp;dst-&gt;super;                                                                                                        \</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="preprocessor">    }                                                                                                                              \</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="preprocessor">                                                                                                                                   \</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="preprocessor">    static ptls_hash_context_t *name##_create(void)                                                                                \</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="preprocessor">    {                                                                                                                              \</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="preprocessor">        struct name##_context_t *ctx;                                                                                              \</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="preprocessor">        if ((ctx = malloc(sizeof(*ctx))) == NULL)                                                                                  \</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">            return NULL;                                                                                                           \</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="preprocessor">        ctx-&gt;super = (ptls_hash_context_t){name##_update, name##_final, name##_clone};                                             \</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="preprocessor">        init_func(&amp;ctx-&gt;ctx);                                                                                                      \</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="preprocessor">        return &amp;ctx-&gt;super;                                                                                                        \</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="preprocessor">    }</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="picotls_8h_html_a2d02d6f477c8fa36dfe14c425c884762"><div class="ttname"><a href="picotls_8h.html#a2d02d6f477c8fa36dfe14c425c884762">ptls_decode16</a></div><div class="ttdeci">int ptls_decode16(uint16_t *value, const uint8_t **src, const uint8_t *end)</div><div class="ttdef"><b>Definition:</b> picotls.c:722</div></div>
<div class="ttc" id="picotls_8h_html_a6293010526fd7ac9dcaf83821e2e591d"><div class="ttname"><a href="picotls_8h.html#a6293010526fd7ac9dcaf83821e2e591d">ptls_decode32</a></div><div class="ttdeci">int ptls_decode32(uint32_t *value, const uint8_t **src, const uint8_t *end)</div><div class="ttdef"><b>Definition:</b> picotls.c:740</div></div>
<div class="ttc" id="picotls_8h_html_aa889677e26863e1a37b216aedac72c67"><div class="ttname"><a href="picotls_8h.html#aa889677e26863e1a37b216aedac72c67">ptls_get_server_name</a></div><div class="ttdeci">const char * ptls_get_server_name(ptls_t *tls)</div><div class="ttdoc">returns the server-name (NULL if SNI is not used or failed to negotiate) </div><div class="ttdef"><b>Definition:</b> picotls.c:4043</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_af56902f5bb8b000d73fc1948e16b9ed9"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#af56902f5bb8b000d73fc1948e16b9ed9">st_ptls_handshake_properties_t::collected_extensions</a></div><div class="ttdeci">int(* collected_extensions)(ptls_t *tls, struct st_ptls_handshake_properties_t *properties, ptls_raw_extension_t *extensions)</div><div class="ttdoc">an optional callback that reports the extensions being collected </div><div class="ttdef"><b>Definition:</b> picotls.h:703</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_a3b427bd55c5fee130a830bce959675b8"><div class="ttname"><a href="structst__ptls__esni__context__t.html#a3b427bd55c5fee130a830bce959675b8">st_ptls_esni_context_t::not_before</a></div><div class="ttdeci">uint64_t not_before</div><div class="ttdef"><b>Definition:</b> picotls.h:389</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a63616c73b5f48fdc16e74098f9a88189"><div class="ttname"><a href="structst__ptls__context__t.html#a63616c73b5f48fdc16e74098f9a88189">st_ptls_context_t::certificates</a></div><div class="ttdeci">struct st_ptls_context_t::@8 certificates</div><div class="ttdoc">list of certificates </div></div>
<div class="ttc" id="t_2picotls_8c_html_a548aff34430d3b5d6d5ba393b8fdda8f"><div class="ttname"><a href="t_2picotls_8c.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a></div><div class="ttdeci">ptls_context_t * ctx</div><div class="ttdef"><b>Definition:</b> picotls.c:46</div></div>
<div class="ttc" id="picotls_8h_html_ad7d2c2db8ec70c51f5241cfeb1f7a723"><div class="ttname"><a href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723">ptls_buffer_init</a></div><div class="ttdeci">static void ptls_buffer_init(ptls_buffer_t *buf, void *smallbuf, size_t smallbuf_size)</div><div class="ttdoc">initializes a buffer, setting the default destination to the small buffer provided as the argument...</div><div class="ttdef"><b>Definition:</b> picotls.h:1116</div></div>
<div class="ttc" id="picotls_8h_html_a82d5946aaf61e208d7915b2b73c732a3"><div class="ttname"><a href="picotls_8h.html#a82d5946aaf61e208d7915b2b73c732a3">ptls_clear_memory</a></div><div class="ttdeci">void(*volatile ptls_clear_memory)(void *p, size_t len)</div><div class="ttdoc">clears memory </div><div class="ttdef"><b>Definition:</b> picotls.c:4859</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_a96ea72bb852a8fcee54ed0d1dab942b3"><div class="ttname"><a href="structst__ptls__aead__context__t.html#a96ea72bb852a8fcee54ed0d1dab942b3">st_ptls_aead_context_t::do_decrypt</a></div><div class="ttdeci">size_t(* do_decrypt)(struct st_ptls_aead_context_t *ctx, void *output, const void *input, size_t inlen, const void *iv, const void *aad, size_t aadlen)</div><div class="ttdef"><b>Definition:</b> picotls.h:266</div></div>
<div class="ttc" id="picotls_8h_html_a31520ba2b83cd48c5c142bd93c2af80b"><div class="ttname"><a href="picotls_8h.html#a31520ba2b83cd48c5c142bd93c2af80b">ptls_handshake_properties_t</a></div><div class="ttdeci">struct st_ptls_handshake_properties_t ptls_handshake_properties_t</div><div class="ttdoc">optional arguments to client-driven handshake </div></div>
<div class="ttc" id="picotls_8h_html_aaf66968e2ad59ebf0f264cbb9d2f84f9"><div class="ttname"><a href="picotls_8h.html#aaf66968e2ad59ebf0f264cbb9d2f84f9">ptls_handle_message</a></div><div class="ttdeci">int ptls_handle_message(ptls_t *tls, ptls_buffer_t *sendbuf, size_t epoch_offsets[5], size_t in_epoch, const void *input, size_t inlen, ptls_handshake_properties_t *properties)</div><div class="ttdoc">Runs the handshake by dealing directly with handshake messages. </div><div class="ttdef"><b>Definition:</b> picotls.c:4939</div></div>
<div class="ttc" id="picotls_8h_html_ae1e133404f263bf8d08e027a47d41b14"><div class="ttname"><a href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14">en_ptls_hash_final_mode_t</a></div><div class="ttdeci">en_ptls_hash_final_mode_t</div><div class="ttdef"><b>Definition:</b> picotls.h:308</div></div>
<div class="ttc" id="structst__ptls__cipher__suite__t_html_abc7903325655ffc54d81c3f12be178d5"><div class="ttname"><a href="structst__ptls__cipher__suite__t.html#abc7903325655ffc54d81c3f12be178d5">st_ptls_cipher_suite_t::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdef"><b>Definition:</b> picotls.h:364</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a3f43ad568dcb2c7a93425c000c5ba564"><div class="ttname"><a href="structst__ptls__context__t.html#a3f43ad568dcb2c7a93425c000c5ba564">st_ptls_context_t::max_early_data_size</a></div><div class="ttdeci">uint32_t max_early_data_size</div><div class="ttdoc">maximum permitted size of early data (server-only) </div><div class="ttdef"><b>Definition:</b> picotls.h:556</div></div>
<div class="ttc" id="structst__ptls__context__t_html_aa41a4e58c894088754b3721b8756da9e"><div class="ttname"><a href="structst__ptls__context__t.html#aa41a4e58c894088754b3721b8756da9e">st_ptls_context_t::key_exchanges</a></div><div class="ttdeci">ptls_key_exchange_algorithm_t ** key_exchanges</div><div class="ttdoc">list of supported key-exchange algorithms terminated by NULL </div><div class="ttdef"><b>Definition:</b> picotls.h:517</div></div>
<div class="ttc" id="picotls_8h_html_a2d3ae9c9f2704efb7abae1637cb97241"><div class="ttname"><a href="picotls_8h.html#a2d3ae9c9f2704efb7abae1637cb97241">ptls_cipher_encrypt</a></div><div class="ttdeci">static void ptls_cipher_encrypt(ptls_cipher_context_t *ctx, void *output, const void *input, size_t len)</div><div class="ttdoc">encrypts given text </div><div class="ttdef"><b>Definition:</b> picotls.h:1136</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_a2165e03ebce8693e8b0517842f7934d7"><div class="ttname"><a href="structst__ptls__aead__context__t.html#a2165e03ebce8693e8b0517842f7934d7">st_ptls_aead_context_t::static_iv</a></div><div class="ttdeci">uint8_t static_iv[PTLS_MAX_IV_SIZE]</div><div class="ttdef"><b>Definition:</b> picotls.h:260</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a73303123cc1954e1173bb594b9a1a136"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a73303123cc1954e1173bb594b9a1a136">st_ptls_handshake_properties_t::key</a></div><div class="ttdeci">const void * key</div><div class="ttdoc">HMAC key to protect the integrity of the cookie. </div><div class="ttdef"><b>Definition:</b> picotls.h:676</div></div>
<div class="ttc" id="structst__ptls__message__emitter__t_html"><div class="ttname"><a href="structst__ptls__message__emitter__t.html">st_ptls_message_emitter_t</a></div><div class="ttdef"><b>Definition:</b> picotls.h:371</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_a72d6378c88153f996f9b3f871336e88e"><div class="ttname"><a href="structst__ptls__esni__context__t.html#a72d6378c88153f996f9b3f871336e88e">st_ptls_esni_context_t::cipher_suite</a></div><div class="ttdeci">ptls_cipher_suite_t * cipher_suite</div><div class="ttdef"><b>Definition:</b> picotls.h:385</div></div>
<div class="ttc" id="structst__ptls__cipher__algorithm__t_html_a8202b203443b39432fffc5c6dee99e92"><div class="ttname"><a href="structst__ptls__cipher__algorithm__t.html#a8202b203443b39432fffc5c6dee99e92">st_ptls_cipher_algorithm_t::setup_crypto</a></div><div class="ttdeci">int(* setup_crypto)(ptls_cipher_context_t *ctx, int is_enc, const void *key)</div><div class="ttdef"><b>Definition:</b> picotls.h:251</div></div>
<div class="ttc" id="picotls_8h_html_aba5f8192177bfff33c4fa7e8565db584"><div class="ttname"><a href="picotls_8h.html#aba5f8192177bfff33c4fa7e8565db584">ptls_key_exchange_context_t</a></div><div class="ttdeci">struct st_ptls_key_exchange_context_t ptls_key_exchange_context_t</div><div class="ttdoc">key exchange context built by ptls_key_exchange_algorithm::create. </div></div>
<div class="ttc" id="picotls_8h_html_a9140abb073aee584d9f753f9aacb782b"><div class="ttname"><a href="picotls_8h.html#a9140abb073aee584d9f753f9aacb782b">ptls_esni_dispose_context</a></div><div class="ttdeci">void ptls_esni_dispose_context(ptls_esni_context_t *esni)</div><div class="ttdef"><b>Definition:</b> picotls.c:5053</div></div>
<div class="ttc" id="picotls_8h_html_a544f93cddb0cdbebf81224d0f755843a"><div class="ttname"><a href="picotls_8h.html#a544f93cddb0cdbebf81224d0f755843a">ptls_buffer__adjust_asn1_blocksize</a></div><div class="ttdeci">int ptls_buffer__adjust_asn1_blocksize(ptls_buffer_t *buf, size_t body_size)</div><div class="ttdoc">internal </div><div class="ttdef"><b>Definition:</b> picotls.c:525</div></div>
<div class="ttc" id="picotls_8h_html_a05579d145dabba449415ded660d855c0"><div class="ttname"><a href="picotls_8h.html#a05579d145dabba449415ded660d855c0">ptls_handshake</a></div><div class="ttdeci">int ptls_handshake(ptls_t *tls, ptls_buffer_t *sendbuf, const void *input, size_t *inlen, ptls_handshake_properties_t *args)</div><div class="ttdoc">proceeds with the handshake, optionally taking some input from peer. </div><div class="ttdef"><b>Definition:</b> picotls.c:4395</div></div>
<div class="ttc" id="structst__ptls__decompress__certificate__t_html"><div class="ttname"><a href="structst__ptls__decompress__certificate__t.html">st_ptls_decompress_certificate_t</a></div><div class="ttdef"><b>Definition:</b> picotls.h:485</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_abb9a5c9d8928f4410841ac3ce0aeb9bd"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#abb9a5c9d8928f4410841ac3ce0aeb9bd">st_ptls_aead_algorithm_t::context_size</a></div><div class="ttdeci">size_t context_size</div><div class="ttdoc">size of memory allocated for ptls_aead_context_t. </div><div class="ttdef"><b>Definition:</b> picotls.h:298</div></div>
<div class="ttc" id="picotls_8h_html_abc4124b1bc5642960e94ebc06686a614"><div class="ttname"><a href="picotls_8h.html#abc4124b1bc5642960e94ebc06686a614">ptls_set_server_name</a></div><div class="ttdeci">int ptls_set_server_name(ptls_t *tls, const char *server_name, size_t server_name_len)</div><div class="ttdoc">sets the server-name associated to the TLS connection. </div><div class="ttdef"><b>Definition:</b> picotls.c:4048</div></div>
<div class="ttc" id="structst__ptls__hash__algorithm__t_html_a785835ff5a4329f46456faf92ff718bd"><div class="ttname"><a href="structst__ptls__hash__algorithm__t.html#a785835ff5a4329f46456faf92ff718bd">st_ptls_hash_algorithm_t::empty_digest</a></div><div class="ttdeci">uint8_t empty_digest[PTLS_MAX_DIGEST_SIZE]</div><div class="ttdoc">digest of zero-length octets </div><div class="ttdef"><b>Definition:</b> picotls.h:360</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_ab080c1d64e1a3d143548a5751efcf2fa"><div class="ttname"><a href="structst__ptls__esni__context__t.html#ab080c1d64e1a3d143548a5751efcf2fa">st_ptls_esni_context_t::record_digest</a></div><div class="ttdeci">uint8_t record_digest[PTLS_MAX_DIGEST_SIZE]</div><div class="ttdef"><b>Definition:</b> picotls.h:386</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_ad2f29639d481c3eb60167caffec7866a"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#ad2f29639d481c3eb60167caffec7866a">st_ptls_on_client_hello_parameters_t::list</a></div><div class="ttdeci">const uint16_t * list</div><div class="ttdef"><b>Definition:</b> picotls.h:419</div></div>
<div class="ttc" id="picotls_8h_html_a8b8404e6fcc69862fa300c3a36de5c6c"><div class="ttname"><a href="picotls_8h.html#a8b8404e6fcc69862fa300c3a36de5c6c">ptls_send_alert</a></div><div class="ttdeci">int ptls_send_alert(ptls_t *tls, ptls_buffer_t *sendbuf, uint8_t level, uint8_t description)</div><div class="ttdoc">sends an alert </div><div class="ttdef"><b>Definition:</b> picotls.c:4544</div></div>
<div class="ttc" id="picotls_8h_html_a071e62d26b1f0976c9ea50ec5eca71aa"><div class="ttname"><a href="picotls_8h.html#a071e62d26b1f0976c9ea50ec5eca71aa">ptls_mem_equal</a></div><div class="ttdeci">int(*volatile ptls_mem_equal)(const void *x, const void *y, size_t len)</div><div class="ttdoc">constant-time memcmp </div><div class="ttdef"><b>Definition:</b> picotls.c:4872</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a9d8a0749454d25344c4565fbc131f891"><div class="ttname"><a href="structst__ptls__context__t.html#a9d8a0749454d25344c4565fbc131f891">st_ptls_context_t::update_esni_key</a></div><div class="ttdeci">ptls_update_esni_key_t * update_esni_key</div><div class="ttdef"><b>Definition:</b> picotls.h:610</div></div>
<div class="ttc" id="lib_2picotls_8c_html_a14c83de31e76992b20510eef18075173"><div class="ttname"><a href="lib_2picotls_8c.html#a14c83de31e76992b20510eef18075173">update_open_count</a></div><div class="ttdeci">static void update_open_count(ptls_context_t *ctx, ssize_t delta)</div><div class="ttdef"><b>Definition:</b> picotls.c:3954</div></div>
<div class="ttc" id="structst__ptls__context__t_html"><div class="ttname"><a href="structst__ptls__context__t.html">st_ptls_context_t</a></div><div class="ttdoc">the configuration </div><div class="ttdef"><b>Definition:</b> picotls.h:505</div></div>
<div class="ttc" id="picotls_8h_html_a6d073682347b281fc34d182ab144a1e5"><div class="ttname"><a href="picotls_8h.html#a6d073682347b281fc34d182ab144a1e5">ptls_raw_extension_t</a></div><div class="ttdeci">struct st_ptls_raw_extension_t ptls_raw_extension_t</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a9e2778cd999b7d1873a0e3864bf214a5"><div class="ttname"><a href="structst__ptls__context__t.html#a9e2778cd999b7d1873a0e3864bf214a5">st_ptls_context_t::sign_certificate</a></div><div class="ttdeci">ptls_sign_certificate_t * sign_certificate</div><div class="ttdef"><b>Definition:</b> picotls.h:544</div></div>
<div class="ttc" id="structst__ptls__buffer__t_html_a657a1152144567e35af6d295b16a1534"><div class="ttname"><a href="structst__ptls__buffer__t.html#a657a1152144567e35af6d295b16a1534">st_ptls_buffer_t::off</a></div><div class="ttdeci">size_t off</div><div class="ttdef"><b>Definition:</b> picotls.h:186</div></div>
<div class="ttc" id="structst__ptls__t_html"><div class="ttname"><a href="structst__ptls__t.html">st_ptls_t</a></div><div class="ttdef"><b>Definition:</b> picotls.c:150</div></div>
<div class="ttc" id="structst__ptls__message__emitter__t_html_a8aeda1ec12d7f89912059feb223ec48d"><div class="ttname"><a href="structst__ptls__message__emitter__t.html#a8aeda1ec12d7f89912059feb223ec48d">st_ptls_message_emitter_t::record_header_length</a></div><div class="ttdeci">size_t record_header_length</div><div class="ttdef"><b>Definition:</b> picotls.h:374</div></div>
<div class="ttc" id="picotls_8h_html_a9919d1343430a7726698cba411fa93b4"><div class="ttname"><a href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4">ptls_buffer_dispose</a></div><div class="ttdeci">static void ptls_buffer_dispose(ptls_buffer_t *buf)</div><div class="ttdoc">disposes a buffer, freeing resources allocated by the buffer itself (if any) </div><div class="ttdef"><b>Definition:</b> picotls.h:1125</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_acede22e7c0ca83c336f0823825bae4ea"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#acede22e7c0ca83c336f0823825bae4ea">st_ptls_handshake_properties_t::esni_keys</a></div><div class="ttdeci">ptls_iovec_t esni_keys</div><div class="ttdoc">ESNIKeys (the value of the TXT record, after being base64-&quot;decoded&quot;) </div><div class="ttdef"><b>Definition:</b> picotls.h:658</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html"><div class="ttname"><a href="structst__ptls__aead__context__t.html">st_ptls_aead_context_t</a></div><div class="ttdoc">AEAD context. </div><div class="ttdef"><b>Definition:</b> picotls.h:258</div></div>
<div class="ttc" id="structst__ptls__context__t_html_af452e1ceae7177afe73d636c355d8319"><div class="ttname"><a href="structst__ptls__context__t.html#af452e1ceae7177afe73d636c355d8319">st_ptls_context_t::require_dhe_on_psk</a></div><div class="ttdeci">unsigned require_dhe_on_psk</div><div class="ttdoc">if set, psk handshakes use (ec)dhe </div><div class="ttdef"><b>Definition:</b> picotls.h:565</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a9cd8c23c42f657bf1aa150baefda0473"><div class="ttname"><a href="structst__ptls__context__t.html#a9cd8c23c42f657bf1aa150baefda0473">st_ptls_context_t::decompress_certificate</a></div><div class="ttdeci">ptls_decompress_certificate_t * decompress_certificate</div><div class="ttdef"><b>Definition:</b> picotls.h:606</div></div>
<div class="ttc" id="picotls_8h_html_a674b849ad3cb04aadeaeaf6385c32337"><div class="ttname"><a href="picotls_8h.html#a674b849ad3cb04aadeaeaf6385c32337">ptls_get_time</a></div><div class="ttdeci">ptls_get_time_t ptls_get_time</div><div class="ttdef"><b>Definition:</b> picotls.c:4881</div></div>
<div class="ttc" id="structst__ptls__hash__algorithm__t_html"><div class="ttname"><a href="structst__ptls__hash__algorithm__t.html">st_ptls_hash_algorithm_t</a></div><div class="ttdoc">A hash algorithm and its properties. </div><div class="ttdef"><b>Definition:</b> picotls.h:344</div></div>
<div class="ttc" id="picotls_8h_html_aa6a0008d415e04f0d67db03fdb2113de"><div class="ttname"><a href="picotls_8h.html#aa6a0008d415e04f0d67db03fdb2113de">ptls_get_read_epoch</a></div><div class="ttdeci">size_t ptls_get_read_epoch(ptls_t *tls)</div><div class="ttdoc">Return the current read epoch. </div><div class="ttdef"><b>Definition:</b> picotls.c:4909</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a9f8b8f9789f3023812f1346fd7af0ea1"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a9f8b8f9789f3023812f1346fd7af0ea1">st_ptls_handshake_properties_t::list</a></div><div class="ttdeci">const ptls_iovec_t * list</div><div class="ttdef"><b>Definition:</b> picotls.h:633</div></div>
<div class="ttc" id="picotls_8h_html_afbd373f266a52a1718a3476b24c3a295"><div class="ttname"><a href="picotls_8h.html#afbd373f266a52a1718a3476b24c3a295">ptls_free</a></div><div class="ttdeci">void ptls_free(ptls_t *tls)</div><div class="ttdoc">releases all resources associated to the object </div><div class="ttdef"><b>Definition:</b> picotls.c:3985</div></div>
<div class="ttc" id="structst__ptls__cipher__context__t_html_abd75a02a8a54ed88e494874b75837b2c"><div class="ttname"><a href="structst__ptls__cipher__context__t.html#abd75a02a8a54ed88e494874b75837b2c">st_ptls_cipher_context_t::do_transform</a></div><div class="ttdeci">void(* do_transform)(struct st_ptls_cipher_context_t *ctx, void *output, const void *input, size_t len)</div><div class="ttdef"><b>Definition:</b> picotls.h:240</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_aff6c42b222e366b58e960d6747e403c4"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#aff6c42b222e366b58e960d6747e403c4">st_ptls_handshake_properties_t::max_early_data_size</a></div><div class="ttdeci">size_t * max_early_data_size</div><div class="ttdoc">pointer to store the maximum size of early-data that can be sent immediately. </div><div class="ttdef"><b>Definition:</b> picotls.h:645</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_abe262962648eac0637861d3d6d559ef9"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#abe262962648eac0637861d3d6d559ef9">st_ptls_on_client_hello_parameters_t::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> picotls.h:416</div></div>
<div class="ttc" id="picotls_8h_html_ac3aed9c2ae399575c55bf3447b0c72fe"><div class="ttname"><a href="picotls_8h.html#ac3aed9c2ae399575c55bf3447b0c72fe">ptls_buffer_reserve</a></div><div class="ttdeci">int ptls_buffer_reserve(ptls_buffer_t *buf, size_t delta)</div><div class="ttdoc">reserves space for additional amount of memory </div><div class="ttdef"><b>Definition:</b> picotls.c:487</div></div>
<div class="ttc" id="structst__ptls__cipher__algorithm__t_html_a956189e2a466696fd544f633816aed7f"><div class="ttname"><a href="structst__ptls__cipher__algorithm__t.html#a956189e2a466696fd544f633816aed7f">st_ptls_cipher_algorithm_t::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> picotls.h:247</div></div>
<div class="ttc" id="picotls_8h_html_aa142dbaa5d99942c25847febf894a1f4"><div class="ttname"><a href="picotls_8h.html#aa142dbaa5d99942c25847febf894a1f4">ptls_new</a></div><div class="ttdeci">ptls_t * ptls_new(ptls_context_t *ctx, int is_server)</div><div class="ttdoc">create a object to handle new TLS connection. </div><div class="ttdef"><b>Definition:</b> picotls.c:3960</div></div>
<div class="ttc" id="structst__ptls__cipher__suite__t_html_a37cfd69934248c8fa0ef95d9dbe8f93e"><div class="ttname"><a href="structst__ptls__cipher__suite__t.html#a37cfd69934248c8fa0ef95d9dbe8f93e">st_ptls_cipher_suite_t::aead</a></div><div class="ttdeci">ptls_aead_algorithm_t * aead</div><div class="ttdef"><b>Definition:</b> picotls.h:365</div></div>
<div class="ttc" id="picotls_8h_html_add3c5e06f1310a8db6713148068046f0"><div class="ttname"><a href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0">ptls_buffer__release_memory</a></div><div class="ttdeci">void ptls_buffer__release_memory(ptls_buffer_t *buf)</div><div class="ttdoc">internal </div><div class="ttdef"><b>Definition:</b> picotls.c:480</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_a5014f0558f940b1c54e065c41d6d8f4d"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#a5014f0558f940b1c54e065c41d6d8f4d">st_ptls_on_client_hello_parameters_t::negotiated_protocols</a></div><div class="ttdeci">struct st_ptls_on_client_hello_parameters_t::@5 negotiated_protocols</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_a5c39539d9621b6bb75ef0581233497fb"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#a5c39539d9621b6bb75ef0581233497fb">st_ptls_aead_algorithm_t::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">name (following the convention of openssl ciphers -v ALL) </div><div class="ttdef"><b>Definition:</b> picotls.h:277</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a3fee767223d96d8662b2c70f63d3116a"><div class="ttname"><a href="structst__ptls__context__t.html#a3fee767223d96d8662b2c70f63d3116a">st_ptls_context_t::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> picotls.h:527</div></div>
<div class="ttc" id="structst__ptls__buffer__t_html_a1f096614a1a66eaa3c0458c02cd8f792"><div class="ttname"><a href="structst__ptls__buffer__t.html#a1f096614a1a66eaa3c0458c02cd8f792">st_ptls_buffer_t::capacity</a></div><div class="ttdeci">size_t capacity</div><div class="ttdef"><b>Definition:</b> picotls.h:185</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_afeb68134f80db7c7bf7fd4a5865774f1"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#afeb68134f80db7c7bf7fd4a5865774f1">st_ptls_on_client_hello_parameters_t::signature_algorithms</a></div><div class="ttdeci">struct st_ptls_on_client_hello_parameters_t::@6 signature_algorithms</div></div>
<div class="ttc" id="picotls_8h_html_a724ff019ff3a867c90b28e4d3e8b6e53"><div class="ttname"><a href="picotls_8h.html#a724ff019ff3a867c90b28e4d3e8b6e53">ptls_get_cipher</a></div><div class="ttdeci">ptls_cipher_suite_t * ptls_get_cipher(ptls_t *tls)</div><div class="ttdoc">returns the cipher-suite being used </div><div class="ttdef"><b>Definition:</b> picotls.c:4038</div></div>
<div class="ttc" id="picotls_8h_html_a229de01597e54002f209266c7b4055aa"><div class="ttname"><a href="picotls_8h.html#a229de01597e54002f209266c7b4055aa">ptls_cipher_new</a></div><div class="ttdeci">ptls_cipher_context_t * ptls_cipher_new(ptls_cipher_algorithm_t *algo, int is_enc, const void *key)</div><div class="ttdoc">instantiates a symmetric cipher </div><div class="ttdef"><b>Definition:</b> picotls.c:4764</div></div>
<div class="ttc" id="structst__ptls__decompress__certificate__t_html_a2ada98b85521d2270f2bf0e32e70ebc7"><div class="ttname"><a href="structst__ptls__decompress__certificate__t.html#a2ada98b85521d2270f2bf0e32e70ebc7">st_ptls_decompress_certificate_t::cb</a></div><div class="ttdeci">int(* cb)(struct st_ptls_decompress_certificate_t *self, ptls_t *tls, uint16_t algorithm, ptls_iovec_t output, ptls_iovec_t input)</div><div class="ttdoc">callback that decompresses the message </div><div class="ttdef"><b>Definition:</b> picotls.h:493</div></div>
<div class="ttc" id="structst__ptls__key__exchange__context__t_html_a78f61003457c33a7dbc6e500afd3008c"><div class="ttname"><a href="structst__ptls__key__exchange__context__t.html#a78f61003457c33a7dbc6e500afd3008c">st_ptls_key_exchange_context_t::pubkey</a></div><div class="ttdeci">ptls_iovec_t pubkey</div><div class="ttdoc">the public key </div><div class="ttdef"><b>Definition:</b> picotls.h:201</div></div>
<div class="ttc" id="structst__ptls__decompress__certificate__t_html_aeeb17894ba6600c06f61f616cada32f3"><div class="ttname"><a href="structst__ptls__decompress__certificate__t.html#aeeb17894ba6600c06f61f616cada32f3">st_ptls_decompress_certificate_t::supported_algorithms</a></div><div class="ttdeci">const uint16_t * supported_algorithms</div><div class="ttdoc">list of supported algorithms terminated by UINT16_MAX </div><div class="ttdef"><b>Definition:</b> picotls.h:489</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a809b9a9bacec9032eaf51df67fdaa3de"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a809b9a9bacec9032eaf51df67fdaa3de">st_ptls_handshake_properties_t::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> picotls.h:634</div></div>
<div class="ttc" id="structst__ptls__traffic__protection__t_html"><div class="ttname"><a href="structst__ptls__traffic__protection__t.html">st_ptls_traffic_protection_t</a></div><div class="ttdef"><b>Definition:</b> picotls.c:105</div></div>
<div class="ttc" id="picotls_8h_html_a0d7f1003ee015729b242cce9fe118df5"><div class="ttname"><a href="picotls_8h.html#a0d7f1003ee015729b242cce9fe118df5">ptls_build_certificate_message</a></div><div class="ttdeci">int ptls_build_certificate_message(ptls_buffer_t *buf, ptls_iovec_t request_context, ptls_iovec_t *certificates, size_t num_certificates, ptls_iovec_t ocsp_status)</div><div class="ttdoc">build the body of a Certificate message. </div><div class="ttdef"><b>Definition:</b> picotls.c:2379</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a3f9776853286948493be43f28874fd66"><div class="ttname"><a href="structst__ptls__context__t.html#a3f9776853286948493be43f28874fd66">st_ptls_context_t::list</a></div><div class="ttdeci">ptls_iovec_t * list</div><div class="ttdef"><b>Definition:</b> picotls.h:526</div></div>
<div class="ttc" id="picotls_8h_html_a17b1f731fc08806d7911d6dbad06a46b"><div class="ttname"><a href="picotls_8h.html#a17b1f731fc08806d7911d6dbad06a46b">ptls_send</a></div><div class="ttdeci">int ptls_send(ptls_t *tls, ptls_buffer_t *sendbuf, const void *input, size_t inlen)</div><div class="ttdoc">encrypts given buffer into multiple TLS records </div><div class="ttdef"><b>Definition:</b> picotls.c:4510</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a5e55174d6f18868b84b97b8b7912e9dc"><div class="ttname"><a href="structst__ptls__context__t.html#a5e55174d6f18868b84b97b8b7912e9dc">st_ptls_context_t::random_bytes</a></div><div class="ttdeci">void(* random_bytes)(void *buf, size_t len)</div><div class="ttdoc">PRNG to be used. </div><div class="ttdef"><b>Definition:</b> picotls.h:509</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_aa2475f9382f0088dff79950f1966acd1"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#aa2475f9382f0088dff79950f1966acd1">st_ptls_aead_algorithm_t::setup_crypto</a></div><div class="ttdeci">int(* setup_crypto)(ptls_aead_context_t *ctx, int is_enc, const void *key)</div><div class="ttdoc">callback that sets up the crypto </div><div class="ttdef"><b>Definition:</b> picotls.h:302</div></div>
<div class="ttc" id="picotls_8h_html_a6f5ef09de44ae8adae89bed994848170"><div class="ttname"><a href="picotls_8h.html#a6f5ef09de44ae8adae89bed994848170">ptls_message_emitter_t</a></div><div class="ttdeci">struct st_ptls_message_emitter_t ptls_message_emitter_t</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_ae6aeb4d46c7234ea19982bce16da392e"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#ae6aeb4d46c7234ea19982bce16da392e">st_ptls_handshake_properties_t::additional_extensions</a></div><div class="ttdeci">ptls_raw_extension_t * additional_extensions</div><div class="ttdoc">an optional list of additional extensions to send either in CH or EE, terminated by type == UINT16_MA...</div><div class="ttdef"><b>Definition:</b> picotls.h:695</div></div>
<div class="ttc" id="structst__ptls__hash__context__t_html_a77ddb62cd2358c16d8aa88101b39e146"><div class="ttname"><a href="structst__ptls__hash__context__t.html#a77ddb62cd2358c16d8aa88101b39e146">st_ptls_hash_context_t::update</a></div><div class="ttdeci">void(* update)(struct st_ptls_hash_context_t *ctx, const void *src, size_t len)</div><div class="ttdoc">feeds additional data into the hash context </div><div class="ttdef"><b>Definition:</b> picotls.h:330</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_a188e81d4226726d0aa781a8b0cb6b60f"><div class="ttname"><a href="structst__ptls__aead__context__t.html#a188e81d4226726d0aa781a8b0cb6b60f">st_ptls_aead_context_t::do_encrypt_init</a></div><div class="ttdeci">void(* do_encrypt_init)(struct st_ptls_aead_context_t *ctx, const void *iv, const void *aad, size_t aadlen)</div><div class="ttdef"><b>Definition:</b> picotls.h:263</div></div>
<div class="ttc" id="picotls_8h_html_a04bb46d751b8ee324d6fe885e3cd50e7"><div class="ttname"><a href="picotls_8h.html#a04bb46d751b8ee324d6fe885e3cd50e7">ptls_aead_new</a></div><div class="ttdeci">ptls_aead_context_t * ptls_aead_new(ptls_aead_algorithm_t *aead, ptls_hash_algorithm_t *hash, int is_enc, const void *secret, const char *label_prefix)</div><div class="ttdoc">instantiates an AEAD cipher given a secret, which is expanded using hkdf to a set of key and iv ...</div><div class="ttdef"><b>Definition:</b> picotls.c:4812</div></div>
<div class="ttc" id="picotls_8h_html_a74302ee2c0642a5f161c8b5d3b5dfc39"><div class="ttname"><a href="picotls_8h.html#a74302ee2c0642a5f161c8b5d3b5dfc39">ptls_calc_hash</a></div><div class="ttdeci">int ptls_calc_hash(ptls_hash_algorithm_t *algo, void *output, const void *src, size_t len)</div><div class="ttdef"><b>Definition:</b> picotls.c:4651</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a40cb7a5d43562f6b15ffc768f296ea4d"><div class="ttname"><a href="structst__ptls__context__t.html#a40cb7a5d43562f6b15ffc768f296ea4d">st_ptls_context_t::esni</a></div><div class="ttdeci">ptls_esni_context_t ** esni</div><div class="ttdoc">list of ESNI data terminated by NULL </div><div class="ttdef"><b>Definition:</b> picotls.h:532</div></div>
<div class="ttc" id="structst__ptls__hash__algorithm__t_html_a20aac0b6277eca956fbd88f871bdde36"><div class="ttname"><a href="structst__ptls__hash__algorithm__t.html#a20aac0b6277eca956fbd88f871bdde36">st_ptls_hash_algorithm_t::digest_size</a></div><div class="ttdeci">size_t digest_size</div><div class="ttdoc">digest size </div><div class="ttdef"><b>Definition:</b> picotls.h:352</div></div>
<div class="ttc" id="picotls_8h_html_ae45f2f3d4be7bf98b8598de172189379"><div class="ttname"><a href="picotls_8h.html#ae45f2f3d4be7bf98b8598de172189379">PTLS_CALLBACK_TYPE0</a></div><div class="ttdeci">#define PTLS_CALLBACK_TYPE0(ret, name)</div><div class="ttdef"><b>Definition:</b> picotls.h:393</div></div>
<div class="ttc" id="structst__ptls__key__schedule__t_html"><div class="ttname"><a href="structst__ptls__key__schedule__t.html">st_ptls_key_schedule_t</a></div><div class="ttdef"><b>Definition:</b> picotls.c:344</div></div>
<div class="ttc" id="structst__ptls__key__exchange__context__t_html_aad610065e5a9bdfee7e5c7a46a1a2ea6"><div class="ttname"><a href="structst__ptls__key__exchange__context__t.html#aad610065e5a9bdfee7e5c7a46a1a2ea6">st_ptls_key_exchange_context_t::algo</a></div><div class="ttdeci">const struct st_ptls_key_exchange_algorithm_t * algo</div><div class="ttdoc">the underlying algorithm </div><div class="ttdef"><b>Definition:</b> picotls.h:197</div></div>
<div class="ttc" id="picotls_8h_html_a2b06abcca441f5b988b8d513d5e53086"><div class="ttname"><a href="picotls_8h.html#a2b06abcca441f5b988b8d513d5e53086">ptls_aead_algorithm_t</a></div><div class="ttdeci">const struct st_ptls_aead_algorithm_t ptls_aead_algorithm_t</div><div class="ttdoc">An AEAD cipher. </div></div>
<div class="ttc" id="structst__ptls__cipher__suite__t_html"><div class="ttname"><a href="structst__ptls__cipher__suite__t.html">st_ptls_cipher_suite_t</a></div><div class="ttdef"><b>Definition:</b> picotls.h:363</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a5413b49ca15afa370fbba2e56f793521"><div class="ttname"><a href="structst__ptls__context__t.html#a5413b49ca15afa370fbba2e56f793521">st_ptls_context_t::log_secret</a></div><div class="ttdeci">ptls_log_secret_t * log_secret</div><div class="ttdef"><b>Definition:</b> picotls.h:594</div></div>
<div class="ttc" id="structst__ptls__hash__context__t_html"><div class="ttname"><a href="structst__ptls__hash__context__t.html">st_ptls_hash_context_t</a></div><div class="ttdoc">A hash context. </div><div class="ttdef"><b>Definition:</b> picotls.h:326</div></div>
<div class="ttc" id="structst__ptls__message__emitter__t_html_a8518235c00ebae7606e357ba093a2d1e"><div class="ttname"><a href="structst__ptls__message__emitter__t.html#a8518235c00ebae7606e357ba093a2d1e">st_ptls_message_emitter_t::begin_message</a></div><div class="ttdeci">int(* begin_message)(struct st_ptls_message_emitter_t *self)</div><div class="ttdef"><b>Definition:</b> picotls.h:375</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_a3c24671b14d54653d4effaba190abefa"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#a3c24671b14d54653d4effaba190abefa">st_ptls_aead_algorithm_t::tag_size</a></div><div class="ttdeci">size_t tag_size</div><div class="ttdoc">size of the tag </div><div class="ttdef"><b>Definition:</b> picotls.h:293</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a719e7a766af65cb0ead4cce911ba7fc6"><div class="ttname"><a href="structst__ptls__context__t.html#a719e7a766af65cb0ead4cce911ba7fc6">st_ptls_context_t::ticket_lifetime</a></div><div class="ttdeci">uint32_t ticket_lifetime</div><div class="ttdoc">lifetime of a session ticket (server-only) </div><div class="ttdef"><b>Definition:</b> picotls.h:552</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_a3707224f93425758d39ca6c7a7768c8c"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#a3707224f93425758d39ca6c7a7768c8c">st_ptls_aead_algorithm_t::iv_size</a></div><div class="ttdeci">size_t iv_size</div><div class="ttdoc">size of the IV </div><div class="ttdef"><b>Definition:</b> picotls.h:289</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html">st_ptls_on_client_hello_parameters_t</a></div><div class="ttdoc">arguments passsed to the on_client_hello callback </div><div class="ttdef"><b>Definition:</b> picotls.h:406</div></div>
<div class="ttc" id="picotls_8h_html_ab8af003866ffad57334b31bf5290cbe8"><div class="ttname"><a href="picotls_8h.html#ab8af003866ffad57334b31bf5290cbe8">ptls_get_negotiated_protocol</a></div><div class="ttdeci">const char * ptls_get_negotiated_protocol(ptls_t *tls)</div><div class="ttdoc">returns the negotiated protocol (or NULL) </div><div class="ttdef"><b>Definition:</b> picotls.c:4067</div></div>
<div class="ttc" id="picotls_8h_html_af1dea0d2db4d4d0d1e46c4ed9f8f4130"><div class="ttname"><a href="picotls_8h.html#af1dea0d2db4d4d0d1e46c4ed9f8f4130">ptls_cipher_suite_t</a></div><div class="ttdeci">const struct st_ptls_cipher_suite_t ptls_cipher_suite_t</div></div>
<div class="ttc" id="picotls_8h_html_a41fbce078a20dbc2fe15bb0b25da3411"><div class="ttname"><a href="picotls_8h.html#a41fbce078a20dbc2fe15bb0b25da3411">ptls_set_negotiated_protocol</a></div><div class="ttdeci">int ptls_set_negotiated_protocol(ptls_t *tls, const char *protocol, size_t protocol_len)</div><div class="ttdoc">sets the negotiated protocol. </div><div class="ttdef"><b>Definition:</b> picotls.c:4072</div></div>
<div class="ttc" id="structst__ptls__key__exchange__algorithm__t_html"><div class="ttname"><a href="structst__ptls__key__exchange__algorithm__t.html">st_ptls_key_exchange_algorithm_t</a></div><div class="ttdoc">A key exchange algorithm. </div><div class="ttdef"><b>Definition:</b> picotls.h:211</div></div>
<div class="ttc" id="picotls_8h_html_ae1e133404f263bf8d08e027a47d41b14a871251d097d802df29d54855dbd5cca6"><div class="ttname"><a href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14a871251d097d802df29d54855dbd5cca6">PTLS_HASH_FINAL_MODE_SNAPSHOT</a></div><div class="ttdoc">obtains the digest while leaving the context as-is </div><div class="ttdef"><b>Definition:</b> picotls.h:320</div></div>
<div class="ttc" id="picotls_8h_html_ae1e133404f263bf8d08e027a47d41b14aa215d40d6b824cace989649c5cf8eeaa"><div class="ttname"><a href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14aa215d40d6b824cace989649c5cf8eeaa">PTLS_HASH_FINAL_MODE_RESET</a></div><div class="ttdoc">obtains the digest and reset the context to initial state </div><div class="ttdef"><b>Definition:</b> picotls.h:316</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a3de2d7891343c2ae713bab76110e8526"><div class="ttname"><a href="structst__ptls__context__t.html#a3de2d7891343c2ae713bab76110e8526">st_ptls_context_t::encrypt_ticket</a></div><div class="ttdeci">ptls_encrypt_ticket_t * encrypt_ticket</div><div class="ttdef"><b>Definition:</b> picotls.h:586</div></div>
<div class="ttc" id="picotls_8h_html_ad8b4abd44ba4d5f46a72ec9c08b07229"><div class="ttname"><a href="picotls_8h.html#ad8b4abd44ba4d5f46a72ec9c08b07229">ptls_hkdf_expand_label</a></div><div class="ttdeci">int ptls_hkdf_expand_label(ptls_hash_algorithm_t *algo, void *output, size_t outlen, ptls_iovec_t secret, const char *label, ptls_iovec_t hash_value, const char *label_prefix)</div><div class="ttdef"><b>Definition:</b> picotls.c:4755</div></div>
<div class="ttc" id="structst__ptls__cipher__algorithm__t_html_a527567e3632260a9e616e6cb89d28878"><div class="ttname"><a href="structst__ptls__cipher__algorithm__t.html#a527567e3632260a9e616e6cb89d28878">st_ptls_cipher_algorithm_t::key_size</a></div><div class="ttdeci">size_t key_size</div><div class="ttdef"><b>Definition:</b> picotls.h:248</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_aeed1d50318091605941b2aab4338dc0c"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#aeed1d50318091605941b2aab4338dc0c">st_ptls_handshake_properties_t::selected_psk_binder</a></div><div class="ttdeci">struct st_ptls_handshake_properties_t::@9::@12::@14 selected_psk_binder</div><div class="ttdoc">psk binder being selected (len is set to zero if none) </div></div>
<div class="ttc" id="picotls_8h_html_a55b4668776166a96a7acbfe0c90d1ca8"><div class="ttname"><a href="picotls_8h.html#a55b4668776166a96a7acbfe0c90d1ca8">ptls_server_name_is_ipaddr</a></div><div class="ttdeci">int ptls_server_name_is_ipaddr(const char *name)</div><div class="ttdoc">checks if a server name is an IP address. </div><div class="ttdef"><b>Definition:</b> picotls.c:5068</div></div>
<div class="ttc" id="structst__ptls__buffer__t_html_a099e58c6cf4d258f47c6b525b3c45e12"><div class="ttname"><a href="structst__ptls__buffer__t.html#a099e58c6cf4d258f47c6b525b3c45e12">st_ptls_buffer_t::is_allocated</a></div><div class="ttdeci">int is_allocated</div><div class="ttdef"><b>Definition:</b> picotls.h:187</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_ae4e60ef823dae4c8fcd38d6c5a0869c9"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#ae4e60ef823dae4c8fcd38d6c5a0869c9">st_ptls_on_client_hello_parameters_t::list</a></div><div class="ttdeci">ptls_iovec_t * list</div><div class="ttdef"><b>Definition:</b> picotls.h:415</div></div>
<div class="ttc" id="structst__ptls__cipher__context__t_html"><div class="ttname"><a href="structst__ptls__cipher__context__t.html">st_ptls_cipher_context_t</a></div><div class="ttdoc">context of a symmetric cipher </div><div class="ttdef"><b>Definition:</b> picotls.h:235</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_ab01e22f4399901ea14015136cd53c496"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#ab01e22f4399901ea14015136cd53c496">st_ptls_on_client_hello_parameters_t::server_name</a></div><div class="ttdeci">ptls_iovec_t server_name</div><div class="ttdoc">SNI value received from the client. </div><div class="ttdef"><b>Definition:</b> picotls.h:410</div></div>
<div class="ttc" id="picotls_8h_html_a5694f93f231059ce9fadae6ad893d20e"><div class="ttname"><a href="picotls_8h.html#a5694f93f231059ce9fadae6ad893d20e">ptls_set_context</a></div><div class="ttdeci">void ptls_set_context(ptls_t *tls, ptls_context_t *ctx)</div><div class="ttdoc">updates the context of a connection. </div><div class="ttdef"><b>Definition:</b> picotls.c:4026</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_a895a63f41183ae18f0a1ac5294dec881"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#a895a63f41183ae18f0a1ac5294dec881">st_ptls_aead_algorithm_t::key_size</a></div><div class="ttdeci">size_t key_size</div><div class="ttdoc">key size </div><div class="ttdef"><b>Definition:</b> picotls.h:285</div></div>
<div class="ttc" id="picotls_8h_html_aa77dcaa131915406a4a03be70e268ff0"><div class="ttname"><a href="picotls_8h.html#aa77dcaa131915406a4a03be70e268ff0">ptls_cipher_init</a></div><div class="ttdeci">static void ptls_cipher_init(ptls_cipher_context_t *ctx, const void *iv)</div><div class="ttdoc">initializes the IV; this function must be called prior to calling ptls_cipher_encrypt ...</div><div class="ttdef"><b>Definition:</b> picotls.h:1131</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_a63d568da456b40aca4ad345c253db76d"><div class="ttname"><a href="structst__ptls__esni__context__t.html#a63d568da456b40aca4ad345c253db76d">st_ptls_esni_context_t::padded_length</a></div><div class="ttdeci">uint16_t padded_length</div><div class="ttdef"><b>Definition:</b> picotls.h:388</div></div>
<div class="ttc" id="structst__ptls__message__emitter__t_html_a5eb9e7bc82dfa36221c3c04c3ff49684"><div class="ttname"><a href="structst__ptls__message__emitter__t.html#a5eb9e7bc82dfa36221c3c04c3ff49684">st_ptls_message_emitter_t::enc</a></div><div class="ttdeci">struct st_ptls_traffic_protection_t * enc</div><div class="ttdef"><b>Definition:</b> picotls.h:373</div></div>
<div class="ttc" id="structst__ptls__cipher__context__t_html_a3bdc4a6af3b603f832e3724d8bab05a5"><div class="ttname"><a href="structst__ptls__cipher__context__t.html#a3bdc4a6af3b603f832e3724d8bab05a5">st_ptls_cipher_context_t::algo</a></div><div class="ttdeci">const struct st_ptls_cipher_algorithm_t * algo</div><div class="ttdef"><b>Definition:</b> picotls.h:236</div></div>
<div class="ttc" id="picotls_8h_html_add70aeed61db77e5f28c6970f1463681"><div class="ttname"><a href="picotls_8h.html#add70aeed61db77e5f28c6970f1463681">ptls_esni_init_context</a></div><div class="ttdeci">int ptls_esni_init_context(ptls_context_t *ctx, ptls_esni_context_t *esni, ptls_iovec_t esni_keys, ptls_key_exchange_context_t **key_exchanges)</div><div class="ttdef"><b>Definition:</b> picotls.c:4955</div></div>
<div class="ttc" id="picotls_8h_html_ac6485827fd640c2526e24b4592172873"><div class="ttname"><a href="picotls_8h.html#ac6485827fd640c2526e24b4592172873">ptls_get_record_overhead</a></div><div class="ttdeci">size_t ptls_get_record_overhead(ptls_t *tls)</div><div class="ttdoc">returns per-record overhead </div><div class="ttdef"><b>Definition:</b> picotls.c:4539</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_aa3e1ae9d602dabd0e078bab24a894838"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#aa3e1ae9d602dabd0e078bab24a894838">st_ptls_handshake_properties_t::additional_data</a></div><div class="ttdeci">ptls_iovec_t additional_data</div><div class="ttdoc">additional data to be used for verifying the cookie </div><div class="ttdef"><b>Definition:</b> picotls.h:680</div></div>
<div class="ttc" id="picotls_8h_html_ad29f9c5575e2c4123927d796e4921e7e"><div class="ttname"><a href="picotls_8h.html#ad29f9c5575e2c4123927d796e4921e7e">ptls_update_key</a></div><div class="ttdeci">int ptls_update_key(ptls_t *tls, int request_update)</div><div class="ttdoc">updates the send traffic key (as well as asks the peer to update) </div><div class="ttdef"><b>Definition:</b> picotls.c:4531</div></div>
<div class="ttc" id="picotls_8h_html_a0ba1b8374ab826173b83493093b2aceb"><div class="ttname"><a href="picotls_8h.html#a0ba1b8374ab826173b83493093b2aceb">ptls_aead_encrypt</a></div><div class="ttdeci">size_t ptls_aead_encrypt(ptls_aead_context_t *ctx, void *output, const void *input, size_t inlen, uint64_t seq, const void *aad, size_t aadlen)</div><div class="ttdef"><b>Definition:</b> picotls.c:4825</div></div>
<div class="ttc" id="picotls_8h_html_a191fd22eb98e7eb3de49e83620d30015"><div class="ttname"><a href="picotls_8h.html#a191fd22eb98e7eb3de49e83620d30015">ptls_handshake_is_complete</a></div><div class="ttdeci">int ptls_handshake_is_complete(ptls_t *tls)</div><div class="ttdoc">returns if the handshake has been completed </div><div class="ttdef"><b>Definition:</b> picotls.c:4091</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_aa45a113dbd5b0f4fc80d3d2a9353d44b"><div class="ttname"><a href="structst__ptls__esni__context__t.html#aa45a113dbd5b0f4fc80d3d2a9353d44b">st_ptls_esni_context_t::not_after</a></div><div class="ttdeci">uint64_t not_after</div><div class="ttdef"><b>Definition:</b> picotls.h:390</div></div>
<div class="ttc" id="certificate__compression_8c_html_ac71a8cfdde90b148144bfc42a6a713f9"><div class="ttname"><a href="certificate__compression_8c.html#ac71a8cfdde90b148144bfc42a6a713f9">algorithms</a></div><div class="ttdeci">static const uint16_t algorithms[]</div><div class="ttdef"><b>Definition:</b> certificate_compression.c:46</div></div>
<div class="ttc" id="picotls_8h_html_a3c9053bc53d8840504dcb6e25a33c7dd"><div class="ttname"><a href="picotls_8h.html#a3c9053bc53d8840504dcb6e25a33c7dd">ptls_buffer_t</a></div><div class="ttdeci">struct st_ptls_buffer_t ptls_buffer_t</div><div class="ttdoc">used for storing output </div></div>
<div class="ttc" id="picotls_8h_html_a4f664904be533a2bddea5e4c98838497"><div class="ttname"><a href="picotls_8h.html#a4f664904be533a2bddea5e4c98838497">ptls_buffer_push_asn1_ubigint</a></div><div class="ttdeci">int ptls_buffer_push_asn1_ubigint(ptls_buffer_t *buf, const void *bignum, size_t size)</div><div class="ttdoc">pushes an unsigned bigint </div><div class="ttdef"><b>Definition:</b> picotls.c:531</div></div>
<div class="ttc" id="structst__ptls__cipher__algorithm__t_html_aadfae2ab2b1bbc5f0f06d2e03edf657a"><div class="ttname"><a href="structst__ptls__cipher__algorithm__t.html#aadfae2ab2b1bbc5f0f06d2e03edf657a">st_ptls_cipher_algorithm_t::context_size</a></div><div class="ttdeci">size_t context_size</div><div class="ttdef"><b>Definition:</b> picotls.h:250</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html">st_ptls_aead_algorithm_t</a></div><div class="ttdoc">An AEAD cipher. </div><div class="ttdef"><b>Definition:</b> picotls.h:273</div></div>
<div class="ttc" id="structst__ptls__cipher__algorithm__t_html"><div class="ttname"><a href="structst__ptls__cipher__algorithm__t.html">st_ptls_cipher_algorithm_t</a></div><div class="ttdoc">a symmetric cipher </div><div class="ttdef"><b>Definition:</b> picotls.h:246</div></div>
<div class="ttc" id="picotls_8h_html_aa569bd382fdcb4a3b4c6906bd8530366"><div class="ttname"><a href="picotls_8h.html#aa569bd382fdcb4a3b4c6906bd8530366">ptls_iovec_t</a></div><div class="ttdeci">struct st_ptls_iovec_t ptls_iovec_t</div><div class="ttdoc">represents a sequence of octets </div></div>
<div class="ttc" id="picotls_8h_html_a850d1876076b7a5061ffae37aa929b41"><div class="ttname"><a href="picotls_8h.html#a850d1876076b7a5061ffae37aa929b41">ptls_aead__build_iv</a></div><div class="ttdeci">void ptls_aead__build_iv(ptls_aead_context_t *ctx, uint8_t *iv, uint64_t seq)</div><div class="ttdoc">internal </div><div class="ttdef"><b>Definition:</b> picotls.c:4837</div></div>
<div class="ttc" id="structst__ptls__iovec__t_html_a6a3ca90e0fee18ab6a55e47982271876"><div class="ttname"><a href="structst__ptls__iovec__t.html#a6a3ca90e0fee18ab6a55e47982271876">st_ptls_iovec_t::base</a></div><div class="ttdeci">uint8_t * base</div><div class="ttdef"><b>Definition:</b> picotls.h:176</div></div>
<div class="ttc" id="picotls_8h_html_a0129a2c9d51477ddaa75205b3f2072ee"><div class="ttname"><a href="picotls_8h.html#a0129a2c9d51477ddaa75205b3f2072ee">ptls__key_schedule_update_hash</a></div><div class="ttdeci">void ptls__key_schedule_update_hash(ptls_key_schedule_t *sched, const uint8_t *msg, size_t msglen)</div><div class="ttdoc">internal </div><div class="ttdef"><b>Definition:</b> picotls.c:876</div></div>
<div class="ttc" id="wincompat_8h_html_a8af93bbb66534e14d651bbb0638ee796"><div class="ttname"><a href="wincompat_8h.html#a8af93bbb66534e14d651bbb0638ee796">ssize_t</a></div><div class="ttdeci">#define ssize_t</div><div class="ttdef"><b>Definition:</b> wincompat.h:5</div></div>
<div class="ttc" id="structst__ptls__aead__algorithm__t_html_abb9c41628e75453184a80821f7f88cf1"><div class="ttname"><a href="structst__ptls__aead__algorithm__t.html#abb9c41628e75453184a80821f7f88cf1">st_ptls_aead_algorithm_t::ctr_cipher</a></div><div class="ttdeci">ptls_cipher_algorithm_t * ctr_cipher</div><div class="ttdoc">the underlying key stream </div><div class="ttdef"><b>Definition:</b> picotls.h:281</div></div>
<div class="ttc" id="picotls_8h_html_a93aa51d621b1cf204e5ea455db7e747e"><div class="ttname"><a href="picotls_8h.html#a93aa51d621b1cf204e5ea455db7e747e">ptls_aead_encrypt_init</a></div><div class="ttdeci">static void ptls_aead_encrypt_init(ptls_aead_context_t *ctx, uint64_t seq, const void *aad, size_t aadlen)</div><div class="ttdoc">initializes the internal state of the encryptor </div><div class="ttdef"><b>Definition:</b> picotls.h:1141</div></div>
<div class="ttc" id="picotls_8h_html_aae19f39e79c5f188656386aeb453114f"><div class="ttname"><a href="picotls_8h.html#aae19f39e79c5f188656386aeb453114f">ptls_decompress_certificate_t</a></div><div class="ttdeci">struct st_ptls_decompress_certificate_t ptls_decompress_certificate_t</div></div>
<div class="ttc" id="t_2picotls_8c_html_ac0c4d141c5f6cd347ca3c4d83678c398"><div class="ttname"><a href="t_2picotls_8c.html#ac0c4d141c5f6cd347ca3c4d83678c398">buf</a></div><div class="ttdeci">uint8_t buf[32]</div><div class="ttdef"><b>Definition:</b> picotls.c:290</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_af01d9583d257d95708246970bc78b514"><div class="ttname"><a href="structst__ptls__aead__context__t.html#af01d9583d257d95708246970bc78b514">st_ptls_aead_context_t::dispose_crypto</a></div><div class="ttdeci">void(* dispose_crypto)(struct st_ptls_aead_context_t *ctx)</div><div class="ttdef"><b>Definition:</b> picotls.h:262</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_ae59a54bcc7bca697db8c38a14f6642f9"><div class="ttname"><a href="structst__ptls__aead__context__t.html#ae59a54bcc7bca697db8c38a14f6642f9">st_ptls_aead_context_t::algo</a></div><div class="ttdeci">const struct st_ptls_aead_algorithm_t * algo</div><div class="ttdef"><b>Definition:</b> picotls.h:259</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a712a4d57ba7d5f273ffec970bdb54565"><div class="ttname"><a href="structst__ptls__context__t.html#a712a4d57ba7d5f273ffec970bdb54565">st_ptls_context_t::send_change_cipher_spec</a></div><div class="ttdeci">unsigned send_change_cipher_spec</div><div class="ttdoc">if ChangeCipherSpec message should be sent during handshake </div><div class="ttdef"><b>Definition:</b> picotls.h:573</div></div>
<div class="ttc" id="tls_8c_html_a4f25450b3aa01cc353142a2b8d76cfd9"><div class="ttname"><a href="tls_8c.html#a4f25450b3aa01cc353142a2b8d76cfd9">encrypt_ticket</a></div><div class="ttdeci">static ptls_encrypt_ticket_t encrypt_ticket</div><div class="ttdef"><b>Definition:</b> tls.c:892</div></div>
<div class="ttc" id="picotls_8h_html_a757ec632327d89ef1c52b279362442e1"><div class="ttname"><a href="picotls_8h.html#a757ec632327d89ef1c52b279362442e1">ptls_hash_final_mode_t</a></div><div class="ttdeci">enum en_ptls_hash_final_mode_t ptls_hash_final_mode_t</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a012ace0756de1b672b7960caf78fa51d"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a012ace0756de1b672b7960caf78fa51d">st_ptls_handshake_properties_t::negotiated_protocols</a></div><div class="ttdeci">struct st_ptls_handshake_properties_t::@9::@11::@13 negotiated_protocols</div><div class="ttdoc">list of protocols offered through ALPN </div></div>
<div class="ttc" id="picotls_8h_html_ae95e3b2be5491c9d4e1284d0b2917bc9"><div class="ttname"><a href="picotls_8h.html#ae95e3b2be5491c9d4e1284d0b2917bc9">ptls_decode24</a></div><div class="ttdeci">int ptls_decode24(uint32_t *value, const uint8_t **src, const uint8_t *end)</div><div class="ttdef"><b>Definition:</b> picotls.c:731</div></div>
<div class="ttc" id="picotls_8h_html_a3bc4e32d3a4145414426aa251dbf2c77"><div class="ttname"><a href="picotls_8h.html#a3bc4e32d3a4145414426aa251dbf2c77">ptls_cipher_algorithm_t</a></div><div class="ttdeci">const struct st_ptls_cipher_algorithm_t ptls_cipher_algorithm_t</div><div class="ttdoc">a symmetric cipher </div></div>
<div class="ttc" id="structst__ptls__context__t_html_a4a9215da82662bfc0fcefa6bd4efcfa5"><div class="ttname"><a href="structst__ptls__context__t.html#a4a9215da82662bfc0fcefa6bd4efcfa5">st_ptls_context_t::cipher_suites</a></div><div class="ttdeci">ptls_cipher_suite_t ** cipher_suites</div><div class="ttdoc">list of supported cipher-suites terminated by NULL </div><div class="ttdef"><b>Definition:</b> picotls.h:521</div></div>
<div class="ttc" id="picotls_8h_html_ad7908a62ead44bf0058b3672cd4321fc"><div class="ttname"><a href="picotls_8h.html#ad7908a62ead44bf0058b3672cd4321fc">ptls_aead_decrypt</a></div><div class="ttdeci">static size_t ptls_aead_decrypt(ptls_aead_context_t *ctx, void *output, const void *input, size_t inlen, uint64_t seq, const void *aad, size_t aadlen)</div><div class="ttdoc">decrypts an AEAD record </div><div class="ttdef"><b>Definition:</b> picotls.h:1159</div></div>
<div class="ttc" id="picotls_8h_html_aa371ef01225d2416fb19cb54bc85150b"><div class="ttname"><a href="picotls_8h.html#aa371ef01225d2416fb19cb54bc85150b">ptls_on_client_hello_parameters_t</a></div><div class="ttdeci">struct st_ptls_on_client_hello_parameters_t ptls_on_client_hello_parameters_t</div><div class="ttdoc">arguments passsed to the on_client_hello callback </div></div>
<div class="ttc" id="structst__ptls__hash__algorithm__t_html_ad345d651135a934f00ec6c42a729b2c0"><div class="ttname"><a href="structst__ptls__hash__algorithm__t.html#ad345d651135a934f00ec6c42a729b2c0">st_ptls_hash_algorithm_t::block_size</a></div><div class="ttdeci">size_t block_size</div><div class="ttdoc">block size </div><div class="ttdef"><b>Definition:</b> picotls.h:348</div></div>
<div class="ttc" id="picotls_8h_html_ad44b4fd94d7f19cdf846abf90260255c"><div class="ttname"><a href="picotls_8h.html#ad44b4fd94d7f19cdf846abf90260255c">ptls_aead_encrypt_final</a></div><div class="ttdeci">static size_t ptls_aead_encrypt_final(ptls_aead_context_t *ctx, void *output)</div><div class="ttdoc">emits buffered data (if any) and the GCM tag </div><div class="ttdef"><b>Definition:</b> picotls.h:1154</div></div>
<div class="ttc" id="structst__ptls__key__exchange__context__t_html"><div class="ttname"><a href="structst__ptls__key__exchange__context__t.html">st_ptls_key_exchange_context_t</a></div><div class="ttdoc">key exchange context built by ptls_key_exchange_algorithm::create. </div><div class="ttdef"><b>Definition:</b> picotls.h:193</div></div>
<div class="ttc" id="picotls_8h_html_ade514b23e0a4211e5a8cec8268f7f834"><div class="ttname"><a href="picotls_8h.html#ade514b23e0a4211e5a8cec8268f7f834">ptls_esni_context_t</a></div><div class="ttdeci">struct st_ptls_esni_context_t ptls_esni_context_t</div><div class="ttdoc">holds ESNIKeys and the private key (instantiated by ptls_esni_parse, freed using ptls_esni_dispose) ...</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_a6610d6f28759c2909873594c05b6dd4a"><div class="ttname"><a href="structst__ptls__aead__context__t.html#a6610d6f28759c2909873594c05b6dd4a">st_ptls_aead_context_t::do_encrypt_update</a></div><div class="ttdeci">size_t(* do_encrypt_update)(struct st_ptls_aead_context_t *ctx, void *output, const void *input, size_t inlen)</div><div class="ttdef"><b>Definition:</b> picotls.h:264</div></div>
<div class="ttc" id="t_2picotls_8c_html_a7360b55975153b822efc5217b7734e6a"><div class="ttname"><a href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> picotls.c:291</div></div>
<div class="ttc" id="picotls_8h_html_ae57011fb3506f15237ead4f3146acc01"><div class="ttname"><a href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01">ptls_cipher_free</a></div><div class="ttdeci">void ptls_cipher_free(ptls_cipher_context_t *ctx)</div><div class="ttdoc">destroys a symmetric cipher </div><div class="ttdef"><b>Definition:</b> picotls.c:4778</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_af1164a4e4ebf1f08a08409c310f405ac"><div class="ttname"><a href="structst__ptls__esni__context__t.html#af1164a4e4ebf1f08a08409c310f405ac">st_ptls_esni_context_t::key_exchanges</a></div><div class="ttdeci">ptls_key_exchange_context_t ** key_exchanges</div><div class="ttdef"><b>Definition:</b> picotls.h:383</div></div>
<div class="ttc" id="structst__ptls__key__exchange__algorithm__t_html_a0ca0edbaae452688553dcef9eab5f2fa"><div class="ttname"><a href="structst__ptls__key__exchange__algorithm__t.html#a0ca0edbaae452688553dcef9eab5f2fa">st_ptls_key_exchange_algorithm_t::create</a></div><div class="ttdeci">int(* create)(const struct st_ptls_key_exchange_algorithm_t *algo, ptls_key_exchange_context_t **ctx)</div><div class="ttdoc">creates a context for asynchronous key exchange. </div><div class="ttdef"><b>Definition:</b> picotls.h:220</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_af843dbaa97d6cb47c7dee486e4b361cb"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#af843dbaa97d6cb47c7dee486e4b361cb">st_ptls_handshake_properties_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> picotls.h:666</div></div>
<div class="ttc" id="tassert_8h_html_a53022762464514790477ba81ce0ab36a"><div class="ttname"><a href="tassert_8h.html#a53022762464514790477ba81ce0ab36a">assert</a></div><div class="ttdeci">#define assert(expr)</div><div class="ttdef"><b>Definition:</b> tassert.h:27</div></div>
<div class="ttc" id="structst__ptls__cipher__context__t_html_a12a884b0d156b21e143121e462cf3aec"><div class="ttname"><a href="structst__ptls__cipher__context__t.html#a12a884b0d156b21e143121e462cf3aec">st_ptls_cipher_context_t::do_dispose</a></div><div class="ttdeci">void(* do_dispose)(struct st_ptls_cipher_context_t *ctx)</div><div class="ttdef"><b>Definition:</b> picotls.h:238</div></div>
<div class="ttc" id="structst__ptls__raw__extension__t_html_afc0ee1c62890633ccc1f77107b9674bb"><div class="ttname"><a href="structst__ptls__raw__extension__t.html#afc0ee1c62890633ccc1f77107b9674bb">st_ptls_raw_extension_t::data</a></div><div class="ttdeci">ptls_iovec_t data</div><div class="ttdef"><b>Definition:</b> picotls.h:615</div></div>
<div class="ttc" id="structst__ptls__key__exchange__context__t_html_af9eb383509f984d4cb7e2ae76ab5cc35"><div class="ttname"><a href="structst__ptls__key__exchange__context__t.html#af9eb383509f984d4cb7e2ae76ab5cc35">st_ptls_key_exchange_context_t::on_exchange</a></div><div class="ttdeci">int(* on_exchange)(struct st_ptls_key_exchange_context_t **keyex, int release, ptls_iovec_t *secret, ptls_iovec_t peerkey)</div><div class="ttdoc">If release is set, the callee frees resources allocated to the context and set *keyex to NULL...</div><div class="ttdef"><b>Definition:</b> picotls.h:205</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a73a61c1af7556581b21f97b67c2592a0"><div class="ttname"><a href="structst__ptls__context__t.html#a73a61c1af7556581b21f97b67c2592a0">st_ptls_context_t::update_open_count</a></div><div class="ttdeci">ptls_update_open_count_t * update_open_count</div><div class="ttdef"><b>Definition:</b> picotls.h:598</div></div>
<div class="ttc" id="picotls_8h_html_a6d73fdc0d0da73a43906921c57a452ad"><div class="ttname"><a href="picotls_8h.html#a6d73fdc0d0da73a43906921c57a452ad">ptls_buffer__do_pushv</a></div><div class="ttdeci">int ptls_buffer__do_pushv(ptls_buffer_t *buf, const void *src, size_t len)</div><div class="ttdoc">internal </div><div class="ttdef"><b>Definition:</b> picotls.c:512</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a1f0a2bc5339da566f052d22ea9a6ffcb"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a1f0a2bc5339da566f052d22ea9a6ffcb">st_ptls_handshake_properties_t::session_ticket</a></div><div class="ttdeci">ptls_iovec_t session_ticket</div><div class="ttdoc">session ticket sent to the application via save_ticket callback </div><div class="ttdef"><b>Definition:</b> picotls.h:639</div></div>
<div class="ttc" id="structst__ptls__aead__context__t_html_a44f606086b767744ece15f652b85d3b5"><div class="ttname"><a href="structst__ptls__aead__context__t.html#a44f606086b767744ece15f652b85d3b5">st_ptls_aead_context_t::do_encrypt_final</a></div><div class="ttdeci">size_t(* do_encrypt_final)(struct st_ptls_aead_context_t *ctx, void *output)</div><div class="ttdef"><b>Definition:</b> picotls.h:265</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a0c4f83bebeed217f7c2a06bc82c3c9dd"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a0c4f83bebeed217f7c2a06bc82c3c9dd">st_ptls_handshake_properties_t::retry_uses_cookie</a></div><div class="ttdeci">unsigned retry_uses_cookie</div><div class="ttdoc">if retry should be stateless (cookie.key MUST be set when this option is used) </div><div class="ttdef"><b>Definition:</b> picotls.h:689</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a0b37ccad85147cfeb089a171f7ca0302"><div class="ttname"><a href="structst__ptls__context__t.html#a0b37ccad85147cfeb089a171f7ca0302">st_ptls_context_t::omit_end_of_early_data</a></div><div class="ttdeci">unsigned omit_end_of_early_data</div><div class="ttdoc">if set, EOED will not be emitted or accepted </div><div class="ttdef"><b>Definition:</b> picotls.h:582</div></div>
<div class="ttc" id="picotls_8h_html_a5d637d5f1fe107549ad1a14258291588"><div class="ttname"><a href="picotls_8h.html#a5d637d5f1fe107549ad1a14258291588">ptls_aead_context_t</a></div><div class="ttdeci">struct st_ptls_aead_context_t ptls_aead_context_t</div><div class="ttdoc">AEAD context. </div></div>
<div class="ttc" id="structst__ptls__raw__extension__t_html"><div class="ttname"><a href="structst__ptls__raw__extension__t.html">st_ptls_raw_extension_t</a></div><div class="ttdef"><b>Definition:</b> picotls.h:613</div></div>
<div class="ttc" id="picotls_8h_html_a17e82d69963adbcc3ccd40af02c3f597"><div class="ttname"><a href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597">ptls_iovec_init</a></div><div class="ttdeci">static ptls_iovec_t ptls_iovec_init(const void *p, size_t len)</div><div class="ttdoc">builds a new ptls_iovec_t instance using the supplied parameters </div><div class="ttdef"><b>Definition:</b> picotls.h:1105</div></div>
<div class="ttc" id="structst__ptls__context__t_html_aa9922222dbb79bcd79cfc0ee64150e12"><div class="ttname"><a href="structst__ptls__context__t.html#aa9922222dbb79bcd79cfc0ee64150e12">st_ptls_context_t::require_client_authentication</a></div><div class="ttdeci">unsigned require_client_authentication</div><div class="ttdoc">if set, the server requests client certificates to authenticate the client. </div><div class="ttdef"><b>Definition:</b> picotls.h:578</div></div>
<div class="ttc" id="lib_2openssl_8c_html_a7ed99c87b711d8e2e5d8a87d9b8b3d75"><div class="ttname"><a href="lib_2openssl_8c.html#a7ed99c87b711d8e2e5d8a87d9b8b3d75">verify_sign</a></div><div class="ttdeci">static int verify_sign(void *verify_ctx, ptls_iovec_t data, ptls_iovec_t signature)</div><div class="ttdef"><b>Definition:</b> openssl.c:904</div></div>
<div class="ttc" id="lib_2openssl_8c_html_af035e4d439e5efcf2108c1ebdf82c39f"><div class="ttname"><a href="lib_2openssl_8c.html#af035e4d439e5efcf2108c1ebdf82c39f">sign_certificate</a></div><div class="ttdeci">static int sign_certificate(ptls_sign_certificate_t *_self, ptls_t *tls, uint16_t *selected_algorithm, ptls_buffer_t *outbuf, ptls_iovec_t input, const uint16_t *algorithms, size_t num_algorithms)</div><div class="ttdef"><b>Definition:</b> openssl.c:878</div></div>
<div class="ttc" id="picotls_8h_html_acbb30b5e02fad52e63b99be678d8a43c"><div class="ttname"><a href="picotls_8h.html#acbb30b5e02fad52e63b99be678d8a43c">ptls_get_client_random</a></div><div class="ttdeci">ptls_iovec_t ptls_get_client_random(ptls_t *tls)</div><div class="ttdoc">returns the client-random </div><div class="ttdef"><b>Definition:</b> picotls.c:4033</div></div>
<div class="ttc" id="picotls_8h_html_aefec8568e3aed02938b396752d54d5e5"><div class="ttname"><a href="picotls_8h.html#aefec8568e3aed02938b396752d54d5e5">ptls_get_data_ptr</a></div><div class="ttdeci">void ** ptls_get_data_ptr(ptls_t *tls)</div><div class="ttdoc">returns a pointer to user data pointer (client is reponsible for freeing the associated data prior to...</div><div class="ttdef"><b>Definition:</b> picotls.c:4101</div></div>
<div class="ttc" id="structst__ptls__key__exchange__algorithm__t_html_a01dac78eb934011730fef5d5d3789a12"><div class="ttname"><a href="structst__ptls__key__exchange__algorithm__t.html#a01dac78eb934011730fef5d5d3789a12">st_ptls_key_exchange_algorithm_t::data</a></div><div class="ttdeci">intptr_t data</div><div class="ttdoc">crypto-specific data </div><div class="ttdef"><b>Definition:</b> picotls.h:229</div></div>
<div class="ttc" id="picotls_8h_html_ab1279dc8d5b7b0d1dff091118eddc322"><div class="ttname"><a href="picotls_8h.html#ab1279dc8d5b7b0d1dff091118eddc322">ptls_receive</a></div><div class="ttdeci">int ptls_receive(ptls_t *tls, ptls_buffer_t *plaintextbuf, const void *input, size_t *len)</div><div class="ttdoc">decrypts the first record within given buffer </div><div class="ttdef"><b>Definition:</b> picotls.c:4454</div></div>
<div class="ttc" id="picotls_8h_html_aadec89f296f10258b21ce9daa255d485"><div class="ttname"><a href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485">ptls_aead_free</a></div><div class="ttdeci">void ptls_aead_free(ptls_aead_context_t *ctx)</div><div class="ttdoc">destroys an AEAD cipher context </div><div class="ttdef"><b>Definition:</b> picotls.c:4818</div></div>
<div class="ttc" id="structst__ptls__message__emitter__t_html_aad9a41adb1cca3126e1fe3dc5b5b6e7a"><div class="ttname"><a href="structst__ptls__message__emitter__t.html#aad9a41adb1cca3126e1fe3dc5b5b6e7a">st_ptls_message_emitter_t::buf</a></div><div class="ttdeci">ptls_buffer_t * buf</div><div class="ttdef"><b>Definition:</b> picotls.h:372</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a4b1b564adcf4b4f35b651d995f61c03b"><div class="ttname"><a href="structst__ptls__context__t.html#a4b1b564adcf4b4f35b651d995f61c03b">st_ptls_context_t::emit_certificate</a></div><div class="ttdeci">ptls_emit_certificate_t * emit_certificate</div><div class="ttdef"><b>Definition:</b> picotls.h:540</div></div>
<div class="ttc" id="picotls_8h_html_a81fafd2f07929ad23e495dc140b61ea2"><div class="ttname"><a href="picotls_8h.html#a81fafd2f07929ad23e495dc140b61ea2">ptls_load_certificates</a></div><div class="ttdeci">int ptls_load_certificates(ptls_context_t *ctx, char const *cert_pem_file)</div><div class="ttdef"><b>Definition:</b> pembase64.c:356</div></div>
<div class="ttc" id="picotls_8h_html_a5db4538399b7412c4dc994ed9041e952"><div class="ttname"><a href="picotls_8h.html#a5db4538399b7412c4dc994ed9041e952">ptls_hmac_create</a></div><div class="ttdeci">ptls_hash_context_t * ptls_hmac_create(ptls_hash_algorithm_t *algo, const void *key, size_t key_size)</div><div class="ttdef"><b>Definition:</b> picotls.c:4662</div></div>
<div class="ttc" id="structst__ptls__buffer__t_html_a4a96dcd8b941d061b85c7d3979890b1e"><div class="ttname"><a href="structst__ptls__buffer__t.html#a4a96dcd8b941d061b85c7d3979890b1e">st_ptls_buffer_t::base</a></div><div class="ttdeci">uint8_t * base</div><div class="ttdef"><b>Definition:</b> picotls.h:184</div></div>
<div class="ttc" id="picotls_8h_html_ad455cec1729e42dfb9e6468ccbe46f2b"><div class="ttname"><a href="picotls_8h.html#ad455cec1729e42dfb9e6468ccbe46f2b">PTLS_CALLBACK_TYPE</a></div><div class="ttdeci">#define PTLS_CALLBACK_TYPE(ret, name,...)</div><div class="ttdef"><b>Definition:</b> picotls.h:398</div></div>
<div class="ttc" id="picotls_8h_html_ac588b1d2fe517759aa70995aa643bd96"><div class="ttname"><a href="picotls_8h.html#ac588b1d2fe517759aa70995aa643bd96">ptls_key_exchange_algorithm_t</a></div><div class="ttdeci">const struct st_ptls_key_exchange_algorithm_t ptls_key_exchange_algorithm_t</div><div class="ttdoc">A key exchange algorithm. </div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_ac757d68182ccf9a54720a788931a7391"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#ac757d68182ccf9a54720a788931a7391">st_ptls_on_client_hello_parameters_t::esni</a></div><div class="ttdeci">uint8_t esni</div><div class="ttdoc">if ESNI was used </div><div class="ttdef"><b>Definition:</b> picotls.h:429</div></div>
<div class="ttc" id="picotls_8h_html_a40796f9d4489a0adfaa5eb48a6252a69"><div class="ttname"><a href="picotls_8h.html#a40796f9d4489a0adfaa5eb48a6252a69">ptls_hash_context_t</a></div><div class="ttdeci">struct st_ptls_hash_context_t ptls_hash_context_t</div><div class="ttdoc">A hash context. </div></div>
<div class="ttc" id="picotls_8h_html_a48da6806321331d00677c66444d7143d"><div class="ttname"><a href="picotls_8h.html#a48da6806321331d00677c66444d7143d">ptls_is_psk_handshake</a></div><div class="ttdeci">int ptls_is_psk_handshake(ptls_t *tls)</div><div class="ttdoc">returns if a PSK (or PSK-DHE) handshake was performed </div><div class="ttdef"><b>Definition:</b> picotls.c:4096</div></div>
<div class="ttc" id="structst__ptls__raw__extension__t_html_ae6fab3cc862956a1ea71b194a1142ae7"><div class="ttname"><a href="structst__ptls__raw__extension__t.html#ae6fab3cc862956a1ea71b194a1142ae7">st_ptls_raw_extension_t::type</a></div><div class="ttdeci">uint16_t type</div><div class="ttdef"><b>Definition:</b> picotls.h:614</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a98f5bb251599e1b78a900e1197fd2025"><div class="ttname"><a href="structst__ptls__context__t.html#a98f5bb251599e1b78a900e1197fd2025">st_ptls_context_t::save_ticket</a></div><div class="ttdeci">ptls_save_ticket_t * save_ticket</div><div class="ttdef"><b>Definition:</b> picotls.h:590</div></div>
<div class="ttc" id="test__queue_8c_html_a5391b7f1199d134d62d41f3734ad4322"><div class="ttname"><a href="test__queue_8c.html#a5391b7f1199d134d62d41f3734ad4322">r</a></div><div class="ttdeci">#define r(m)</div><div class="ttdef"><b>Definition:</b> test_queue.c:34</div></div>
<div class="ttc" id="structst__ptls__context__t_html_aa84bd8239640d6a9bbb85ccfcd5943fe"><div class="ttname"><a href="structst__ptls__context__t.html#aa84bd8239640d6a9bbb85ccfcd5943fe">st_ptls_context_t::use_exporter</a></div><div class="ttdeci">unsigned use_exporter</div><div class="ttdoc">if exporter master secrets should be recorded </div><div class="ttdef"><b>Definition:</b> picotls.h:569</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_af7f0388d48981a97a285dce2f6bf7b8a"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#af7f0388d48981a97a285dce2f6bf7b8a">st_ptls_handshake_properties_t::enforce_retry</a></div><div class="ttdeci">unsigned enforce_retry</div><div class="ttdoc">if HRR should always be sent </div><div class="ttdef"><b>Definition:</b> picotls.h:685</div></div>
<div class="ttc" id="picotls_8h_html_ae421cae6e308667fba6bc220233087f0"><div class="ttname"><a href="picotls_8h.html#ae421cae6e308667fba6bc220233087f0">ptls_hash_algorithm_t</a></div><div class="ttdeci">const struct st_ptls_hash_algorithm_t ptls_hash_algorithm_t</div><div class="ttdoc">A hash algorithm and its properties. </div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html_a1a01e78ae37724d84a0cf838a842da9f"><div class="ttname"><a href="structst__ptls__esni__context__t.html#a1a01e78ae37724d84a0cf838a842da9f">st_ptls_esni_context_t::cipher_suites</a></div><div class="ttdeci">struct st_ptls_esni_context_t::@4 * cipher_suites</div></div>
<div class="ttc" id="picotls_8h_html_ae1e133404f263bf8d08e027a47d41b14a65703dfcdaf9b71ed80df327810ca095"><div class="ttname"><a href="picotls_8h.html#ae1e133404f263bf8d08e027a47d41b14a65703dfcdaf9b71ed80df327810ca095">PTLS_HASH_FINAL_MODE_FREE</a></div><div class="ttdoc">obtains the digest and frees the context </div><div class="ttdef"><b>Definition:</b> picotls.h:312</div></div>
<div class="ttc" id="picotls_8h_html_aace42c0ca1898cb625aa1719dcfe67f0"><div class="ttname"><a href="picotls_8h.html#aace42c0ca1898cb625aa1719dcfe67f0">ptls_hkdf_extract</a></div><div class="ttdeci">int ptls_hkdf_extract(ptls_hash_algorithm_t *hash, void *output, ptls_iovec_t salt, ptls_iovec_t ikm)</div><div class="ttdef"><b>Definition:</b> picotls.c:4684</div></div>
<div class="ttc" id="structst__ptls__context__t_html_ae3dfc40950255ba317e70973f7862946"><div class="ttname"><a href="structst__ptls__context__t.html#ae3dfc40950255ba317e70973f7862946">st_ptls_context_t::update_traffic_key</a></div><div class="ttdeci">ptls_update_traffic_key_t * update_traffic_key</div><div class="ttdef"><b>Definition:</b> picotls.h:602</div></div>
<div class="ttc" id="picotls_8h_html_a0a8567d56275ef767b54b865aa8805bd"><div class="ttname"><a href="picotls_8h.html#a0a8567d56275ef767b54b865aa8805bd">ptls_export_secret</a></div><div class="ttdeci">int ptls_export_secret(ptls_t *tls, void *output, size_t outlen, const char *label, ptls_iovec_t context_value, int is_early)</div><div class="ttdef"><b>Definition:</b> picotls.c:4560</div></div>
<div class="ttc" id="structst__ptls__message__emitter__t_html_a961460efa5e7059dd20165229a647c48"><div class="ttname"><a href="structst__ptls__message__emitter__t.html#a961460efa5e7059dd20165229a647c48">st_ptls_message_emitter_t::commit_message</a></div><div class="ttdeci">int(* commit_message)(struct st_ptls_message_emitter_t *self)</div><div class="ttdef"><b>Definition:</b> picotls.h:376</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_aeec43aff6597e285c274772f191d6753"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#aeec43aff6597e285c274772f191d6753">st_ptls_handshake_properties_t::server</a></div><div class="ttdeci">struct st_ptls_handshake_properties_t::@9::@12 server</div></div>
<div class="ttc" id="norx_8c_html_ad53dd54175d41b74c6be656ddd32c8fd"><div class="ttname"><a href="norx_8c.html#ad53dd54175d41b74c6be656ddd32c8fd">input</a></div><div class="ttdeci">static void input(norx32_ctx *ctx, uint32_t type, const uint8_t *buf, size_t nbuf)</div><div class="ttdef"><b>Definition:</b> norx.c:204</div></div>
<div class="ttc" id="structst__ptls__buffer__t_html"><div class="ttname"><a href="structst__ptls__buffer__t.html">st_ptls_buffer_t</a></div><div class="ttdoc">used for storing output </div><div class="ttdef"><b>Definition:</b> picotls.h:183</div></div>
<div class="ttc" id="structtls_html"><div class="ttname"><a href="structtls.html">tls</a></div><div class="ttdef"><b>Definition:</b> tls.h:55</div></div>
<div class="ttc" id="picotls_8h_html_ac80d132d2606d2af959cf5ab4f574766"><div class="ttname"><a href="picotls_8h.html#ac80d132d2606d2af959cf5ab4f574766">ptls_aead_encrypt_update</a></div><div class="ttdeci">static size_t ptls_aead_encrypt_update(ptls_aead_context_t *ctx, void *output, const void *input, size_t inlen)</div><div class="ttdoc">encrypts the input and updates the GCM state </div><div class="ttdef"><b>Definition:</b> picotls.h:1149</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a8b8c566f2024f8f5a7a17bca54656ef1"><div class="ttname"><a href="structst__ptls__context__t.html#a8b8c566f2024f8f5a7a17bca54656ef1">st_ptls_context_t::on_client_hello</a></div><div class="ttdeci">ptls_on_client_hello_t * on_client_hello</div><div class="ttdef"><b>Definition:</b> picotls.h:536</div></div>
<div class="ttc" id="picotls_8h_html_ac74362872a2014306e0a73d0b78963d4"><div class="ttname"><a href="picotls_8h.html#ac74362872a2014306e0a73d0b78963d4">PTLS_MAX_IV_SIZE</a></div><div class="ttdeci">#define PTLS_MAX_IV_SIZE</div><div class="ttdef"><b>Definition:</b> picotls.h:51</div></div>
<div class="ttc" id="lib_2picotls_8c_html_a8585bf4362e3a8747e1a1df5a784c057"><div class="ttname"><a href="lib_2picotls_8c.html#a8585bf4362e3a8747e1a1df5a784c057">get_time</a></div><div class="ttdeci">static uint64_t get_time(ptls_get_time_t *self)</div><div class="ttdef"><b>Definition:</b> picotls.c:4874</div></div>
<div class="ttc" id="structst__ptls__context__t_html_af64bd984b75a6cd8e71de1324ee8efe2"><div class="ttname"><a href="structst__ptls__context__t.html#af64bd984b75a6cd8e71de1324ee8efe2">st_ptls_context_t::hkdf_label_prefix__obsolete</a></div><div class="ttdeci">const char * hkdf_label_prefix__obsolete</div><div class="ttdoc">the field is obsolete; should be set to NULL for QUIC draft-17. </div><div class="ttdef"><b>Definition:</b> picotls.h:561</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a4df8be7485bb310b53a4447bfd8a0f19"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a4df8be7485bb310b53a4447bfd8a0f19">st_ptls_handshake_properties_t::base</a></div><div class="ttdeci">uint8_t base[PTLS_MAX_DIGEST_SIZE]</div><div class="ttdef"><b>Definition:</b> picotls.h:665</div></div>
<div class="ttc" id="picotls_8h_html_a4c8998052323166300a9b59bc6443337"><div class="ttname"><a href="picotls_8h.html#a4c8998052323166300a9b59bc6443337">ptls_is_server</a></div><div class="ttdeci">int ptls_is_server(ptls_t *tls)</div><div class="ttdoc">Returns if the context is a server context. </div><div class="ttdef"><b>Definition:</b> picotls.c:4883</div></div>
<div class="ttc" id="structst__ptls__cipher__suite__t_html_af0c711b190c378c2993839fcc9612c9a"><div class="ttname"><a href="structst__ptls__cipher__suite__t.html#af0c711b190c378c2993839fcc9612c9a">st_ptls_cipher_suite_t::hash</a></div><div class="ttdeci">ptls_hash_algorithm_t * hash</div><div class="ttdef"><b>Definition:</b> picotls.h:366</div></div>
<div class="ttc" id="structst__ptls__context__t_html_a3735963f99387d0cd474c814341c6b03"><div class="ttname"><a href="structst__ptls__context__t.html#a3735963f99387d0cd474c814341c6b03">st_ptls_context_t::get_time</a></div><div class="ttdeci">ptls_get_time_t * get_time</div><div class="ttdef"><b>Definition:</b> picotls.h:513</div></div>
<div class="ttc" id="structst__ptls__cipher__context__t_html_a5735326f249b86955577cd8181e5d5c4"><div class="ttname"><a href="structst__ptls__cipher__context__t.html#a5735326f249b86955577cd8181e5d5c4">st_ptls_cipher_context_t::do_init</a></div><div class="ttdeci">void(* do_init)(struct st_ptls_cipher_context_t *ctx, const void *iv)</div><div class="ttdef"><b>Definition:</b> picotls.h:239</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a2274c427a2db1581be49459391e13a59"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a2274c427a2db1581be49459391e13a59">st_ptls_handshake_properties_t::client</a></div><div class="ttdeci">struct st_ptls_handshake_properties_t::@9::@11 client</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_ac88edb6177f2f206a8b153707ac286cc"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#ac88edb6177f2f206a8b153707ac286cc">st_ptls_handshake_properties_t::early_data_accepted_by_peer</a></div><div class="ttdeci">unsigned early_data_accepted_by_peer</div><div class="ttdoc">if early-data has been accepted by peer. </div><div class="ttdef"><b>Definition:</b> picotls.h:650</div></div>
<div class="ttc" id="structst__ptls__context__t_html_aa936b23df016f933eaf8ee2474300f6a"><div class="ttname"><a href="structst__ptls__context__t.html#aa936b23df016f933eaf8ee2474300f6a">st_ptls_context_t::verify_certificate</a></div><div class="ttdeci">ptls_verify_certificate_t * verify_certificate</div><div class="ttdef"><b>Definition:</b> picotls.h:548</div></div>
<div class="ttc" id="picotls_8h_html_a5e5f3adbb5902ee128ee1496e696f32d"><div class="ttname"><a href="picotls_8h.html#a5e5f3adbb5902ee128ee1496e696f32d">ptls_cipher_context_t</a></div><div class="ttdeci">struct st_ptls_cipher_context_t ptls_cipher_context_t</div><div class="ttdoc">context of a symmetric cipher </div></div>
<div class="ttc" id="structst__ptls__iovec__t_html_aa5ab20f9aa80ae7de96cff7cdf5aac57"><div class="ttname"><a href="structst__ptls__iovec__t.html#aa5ab20f9aa80ae7de96cff7cdf5aac57">st_ptls_iovec_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> picotls.h:177</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a7d1c6d18a71c786fe8ff9d1961e64ea7"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a7d1c6d18a71c786fe8ff9d1961e64ea7">st_ptls_handshake_properties_t::collect_extension</a></div><div class="ttdeci">int(* collect_extension)(ptls_t *tls, struct st_ptls_handshake_properties_t *properties, uint16_t type)</div><div class="ttdoc">an optional callback that returns a boolean value indicating if a particular extension should be coll...</div><div class="ttdef"><b>Definition:</b> picotls.h:699</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html">st_ptls_handshake_properties_t</a></div><div class="ttdoc">optional arguments to client-driven handshake </div><div class="ttdef"><b>Definition:</b> picotls.h:626</div></div>
<div class="ttc" id="picotls_8h_html_a7b871b714f154f9486d248ba42999531"><div class="ttname"><a href="picotls_8h.html#a7b871b714f154f9486d248ba42999531">PTLS_MAX_DIGEST_SIZE</a></div><div class="ttdeci">#define PTLS_MAX_DIGEST_SIZE</div><div class="ttdef"><b>Definition:</b> picotls.h:52</div></div>
<div class="ttc" id="picotls_8h_html_ac31fa41db2dea59eccf6284ce9aa5e7e"><div class="ttname"><a href="picotls_8h.html#ac31fa41db2dea59eccf6284ce9aa5e7e">ptls_get_context</a></div><div class="ttdeci">ptls_context_t * ptls_get_context(ptls_t *tls)</div><div class="ttdoc">returns address of the crypto callbacks that the connection is using </div><div class="ttdef"><b>Definition:</b> picotls.c:4021</div></div>
<div class="ttc" id="structst__ptls__esni__context__t_html"><div class="ttname"><a href="structst__ptls__esni__context__t.html">st_ptls_esni_context_t</a></div><div class="ttdoc">holds ESNIKeys and the private key (instantiated by ptls_esni_parse, freed using ptls_esni_dispose) ...</div><div class="ttdef"><b>Definition:</b> picotls.h:382</div></div>
<div class="ttc" id="structst__ptls__key__exchange__algorithm__t_html_a06fe9adb6ddab04b281a81fd10e0fb20"><div class="ttname"><a href="structst__ptls__key__exchange__algorithm__t.html#a06fe9adb6ddab04b281a81fd10e0fb20">st_ptls_key_exchange_algorithm_t::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdoc">ID defined by the TLS specification. </div><div class="ttdef"><b>Definition:</b> picotls.h:215</div></div>
<div class="ttc" id="picotls_8h_html_a02857b034439952d3f33e58e56f7e6a3"><div class="ttname"><a href="picotls_8h.html#a02857b034439952d3f33e58e56f7e6a3">ptls_hkdf_expand</a></div><div class="ttdeci">int ptls_hkdf_expand(ptls_hash_algorithm_t *hash, void *output, size_t outlen, ptls_iovec_t prk, ptls_iovec_t info)</div><div class="ttdef"><b>Definition:</b> picotls.c:4698</div></div>
<div class="ttc" id="structst__ptls__iovec__t_html"><div class="ttname"><a href="structst__ptls__iovec__t.html">st_ptls_iovec_t</a></div><div class="ttdoc">represents a sequence of octets </div><div class="ttdef"><b>Definition:</b> picotls.h:175</div></div>
<div class="ttc" id="picotls_8h_html_a50aa9860710e7b2a1002ecbd4438c69e"><div class="ttname"><a href="picotls_8h.html#a50aa9860710e7b2a1002ecbd4438c69e">ptls_decode64</a></div><div class="ttdeci">int ptls_decode64(uint64_t *value, const uint8_t **src, const uint8_t *end)</div><div class="ttdef"><b>Definition:</b> picotls.c:749</div></div>
<div class="ttc" id="lib_2picotls_8c_html_a7e917599d9876a6c3fa9e470c64fcf67"><div class="ttname"><a href="lib_2picotls_8c.html#a7e917599d9876a6c3fa9e470c64fcf67">update_traffic_key</a></div><div class="ttdeci">static int update_traffic_key(ptls_t *tls, int is_enc)</div><div class="ttdef"><b>Definition:</b> picotls.c:3841</div></div>
<div class="ttc" id="t_2picotls_8c_html_a44502cfddc409d1237460605e1fcf6f7"><div class="ttname"><a href="t_2picotls_8c.html#a44502cfddc409d1237460605e1fcf6f7">verify_certificate</a></div><div class="ttdeci">ptls_verify_certificate_t * verify_certificate</div><div class="ttdef"><b>Definition:</b> picotls.c:47</div></div>
<div class="ttc" id="structst__ptls__key__exchange__algorithm__t_html_ab3000798ea98afb83d6bf5f7eda3ec6c"><div class="ttname"><a href="structst__ptls__key__exchange__algorithm__t.html#ab3000798ea98afb83d6bf5f7eda3ec6c">st_ptls_key_exchange_algorithm_t::exchange</a></div><div class="ttdeci">int(* exchange)(const struct st_ptls_key_exchange_algorithm_t *algo, ptls_iovec_t *pubkey, ptls_iovec_t *secret, ptls_iovec_t peerkey)</div><div class="ttdoc">implements synchronous key exchange. </div><div class="ttdef"><b>Definition:</b> picotls.h:224</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_afc7a0da22ad5b4c8fd41ad0c35bf2dd8"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#afc7a0da22ad5b4c8fd41ad0c35bf2dd8">st_ptls_handshake_properties_t::negotiate_before_key_exchange</a></div><div class="ttdeci">unsigned negotiate_before_key_exchange</div><div class="ttdoc">negotiate the key exchange method before sending key_share </div><div class="ttdef"><b>Definition:</b> picotls.h:654</div></div>
<div class="ttc" id="structst__ptls__cipher__algorithm__t_html_a2ccd97b3e25bec06579d2063bb72b5fe"><div class="ttname"><a href="structst__ptls__cipher__algorithm__t.html#a2ccd97b3e25bec06579d2063bb72b5fe">st_ptls_cipher_algorithm_t::iv_size</a></div><div class="ttdeci">size_t iv_size</div><div class="ttdef"><b>Definition:</b> picotls.h:249</div></div>
<div class="ttc" id="structst__ptls__handshake__properties__t_html_a66c6c55ed97e904247950431fac3aa61"><div class="ttname"><a href="structst__ptls__handshake__properties__t.html#a66c6c55ed97e904247950431fac3aa61">st_ptls_handshake_properties_t::cookie</a></div><div class="ttdeci">struct st_ptls_handshake_properties_t::@9::@12::@15 cookie</div><div class="ttdoc">parameters related to use of the Cookie extension </div></div>
<div class="ttc" id="tls_8c_html_a3a920c80db919ca11a75003ebcceacb8"><div class="ttname"><a href="tls_8c.html#a3a920c80db919ca11a75003ebcceacb8">save_ticket</a></div><div class="ttdeci">static ptls_save_ticket_t save_ticket</div><div class="ttdef"><b>Definition:</b> tls.c:891</div></div>
<div class="ttc" id="structst__ptls__on__client__hello__parameters__t_html_a25d69aca7700f1be74058dd7faf905f0"><div class="ttname"><a href="structst__ptls__on__client__hello__parameters__t.html#a25d69aca7700f1be74058dd7faf905f0">st_ptls_on_client_hello_parameters_t::certificate_compression_algorithms</a></div><div class="ttdeci">struct st_ptls_on_client_hello_parameters_t::@7 certificate_compression_algorithms</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 28 2019 08:02:42 for quant by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
