<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>quant: deps/warpcore/lib/src/klib/ksw.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quant
   &#160;<span id="projectnumber">0.0.17</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_82ce5dd3950c6393668b7cc23fc52b28.html">deps</a></li><li class="navelem"><a class="el" href="dir_63a5f3da5bb346670840ad293d558300.html">warpcore</a></li><li class="navelem"><a class="el" href="dir_f4c0bb2795bdb545195b8a1e3a07cf5b.html">lib</a></li><li class="navelem"><a class="el" href="dir_096e6e3b4888cf9e4ce0fc18373c588c.html">src</a></li><li class="navelem"><a class="el" href="dir_0bfcca9d5142e8a4b7504cf96386a1ac.html">klib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ksw.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;emmintrin.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="warpcore_2lib_2src_2klib_2ksw_8h_source.html">ksw.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ksw.c:</div>
<div class="dyncontent">
<div class="center"><img src="warpcore_2lib_2src_2klib_2ksw_8c__incl.png" border="0" usemap="#deps_2warpcore_2lib_2src_2klib_2ksw_8c" alt=""/></div>
<map name="deps_2warpcore_2lib_2src_2klib_2ksw_8c" id="deps_2warpcore_2lib_2src_2klib_2ksw_8c">
<area shape="rect" id="node5" href="warpcore_2lib_2src_2klib_2ksw_8h.html" title="ksw.h" alt="" coords="259,96,316,123"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__kswq__t.html">_kswq_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structeh__t.html">eh_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:affde14445f49f65ff4f5b592e44ee71a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#affde14445f49f65ff4f5b592e44ee71a">LIKELY</a>(x)&#160;&#160;&#160;(x)</td></tr>
<tr class="separator:affde14445f49f65ff4f5b592e44ee71a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10d0a221f4d7a706701b806c8135fd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#ab10d0a221f4d7a706701b806c8135fd7">UNLIKELY</a>(x)&#160;&#160;&#160;(x)</td></tr>
<tr class="separator:ab10d0a221f4d7a706701b806c8135fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd40006efbe6d978381de40766e3b63"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a4bd40006efbe6d978381de40766e3b63">__max_16</a>(ret, xx)</td></tr>
<tr class="separator:a4bd40006efbe6d978381de40766e3b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a287a82314c2dd8a20b9aea52a422a34b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a287a82314c2dd8a20b9aea52a422a34b">__max_8</a>(ret, xx)</td></tr>
<tr class="separator:a287a82314c2dd8a20b9aea52a422a34b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa48b28e62c168ecef26792b023bedb09"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#aa48b28e62c168ecef26792b023bedb09">MINUS_INF</a>&#160;&#160;&#160;-0x40000000</td></tr>
<tr class="separator:aa48b28e62c168ecef26792b023bedb09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a295f1f9c1e0144e81d4c5900a6698601"><td class="memItemLeft" align="right" valign="top"><a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a295f1f9c1e0144e81d4c5900a6698601">ksw_qinit</a> (int size, int qlen, const uint8_t *query, int m, const int8_t *mat)</td></tr>
<tr class="memdesc:a295f1f9c1e0144e81d4c5900a6698601"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the query data structure.  <a href="#a295f1f9c1e0144e81d4c5900a6698601">More...</a><br/></td></tr>
<tr class="separator:a295f1f9c1e0144e81d4c5900a6698601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588d7f69adc022a80402b5bfd3509dd3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkswr__t.html">kswr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a588d7f69adc022a80402b5bfd3509dd3">ksw_u8</a> (<a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> *q, int tlen, const uint8_t *target, int _gapo, int _gape, int xtra)</td></tr>
<tr class="separator:a588d7f69adc022a80402b5bfd3509dd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabfa7570c5882f97217fbd4e7b7aedc4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkswr__t.html">kswr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#aabfa7570c5882f97217fbd4e7b7aedc4">ksw_i16</a> (<a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> *q, int tlen, const uint8_t *target, int _gapo, int _gape, int xtra)</td></tr>
<tr class="separator:aabfa7570c5882f97217fbd4e7b7aedc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b86b0e1cab2423ed292be074a3c5c27"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27">revseq</a> (int l, uint8_t *s)</td></tr>
<tr class="separator:a9b86b0e1cab2423ed292be074a3c5c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa77df9211e983ff979de29cba01a9263"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkswr__t.html">kswr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#aa77df9211e983ff979de29cba01a9263">ksw_align</a> (int qlen, uint8_t *query, int tlen, uint8_t *target, int m, const int8_t *mat, int gapo, int gape, int xtra, <a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> **qry)</td></tr>
<tr class="memdesc:aa77df9211e983ff979de29cba01a9263"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligning two sequences.  <a href="#aa77df9211e983ff979de29cba01a9263">More...</a><br/></td></tr>
<tr class="separator:aa77df9211e983ff979de29cba01a9263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2faf4cafbc6a0b200557da0c0cac4da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#af2faf4cafbc6a0b200557da0c0cac4da">ksw_extend</a> (int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int gapo, int gape, int <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, int h0, int *_qle, int *_tle)</td></tr>
<tr class="separator:af2faf4cafbc6a0b200557da0c0cac4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a826957eb948116d000d8514b3cd85202"><td class="memItemLeft" align="right" valign="top">static uint32_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a826957eb948116d000d8514b3cd85202">push_cigar</a> (int *n_cigar, int *m_cigar, uint32_t *cigar, int op, int <a class="el" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>)</td></tr>
<tr class="separator:a826957eb948116d000d8514b3cd85202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3b660c0554a2d9817528194b6578a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#a7b3b660c0554a2d9817528194b6578a3">ksw_global</a> (int qlen, const uint8_t *query, int tlen, const uint8_t *target, int m, const int8_t *mat, int gapo, int gape, int <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, int *n_cigar_, uint32_t **cigar_)</td></tr>
<tr class="separator:a7b3b660c0554a2d9817528194b6578a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:add79ed614f910c5fcae1eead30104f28"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structkswr__t.html">kswr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="warpcore_2lib_2src_2klib_2ksw_8c.html#add79ed614f910c5fcae1eead30104f28">g_defr</a> = { 0, -1, -1, -1, -1, -1, -1 }</td></tr>
<tr class="separator:add79ed614f910c5fcae1eead30104f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a4bd40006efbe6d978381de40766e3b63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __max_16</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ret, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">xx&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div>
<div class="line">        (xx) = _mm_max_epu8((xx), _mm_srli_si128((xx), 8)); \</div>
<div class="line">        (xx) = _mm_max_epu8((xx), _mm_srli_si128((xx), 4)); \</div>
<div class="line">        (xx) = _mm_max_epu8((xx), _mm_srli_si128((xx), 2)); \</div>
<div class="line">        (xx) = _mm_max_epu8((xx), _mm_srli_si128((xx), 1)); \</div>
<div class="line">        (ret) = _mm_extract_epi16((xx), 0) &amp; 0x00ff; \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a287a82314c2dd8a20b9aea52a422a34b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __max_8</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ret, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">xx&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div>
<div class="line">        (xx) = _mm_max_epi16((xx), _mm_srli_si128((xx), 8)); \</div>
<div class="line">        (xx) = _mm_max_epi16((xx), _mm_srli_si128((xx), 4)); \</div>
<div class="line">        (xx) = _mm_max_epi16((xx), _mm_srli_si128((xx), 2)); \</div>
<div class="line">        (ret) = _mm_extract_epi16((xx), 0); \</div>
<div class="line">    } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="affde14445f49f65ff4f5b592e44ee71a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIKELY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(x)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa48b28e62c168ecef26792b023bedb09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MINUS_INF&#160;&#160;&#160;-0x40000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab10d0a221f4d7a706701b806c8135fd7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNLIKELY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(x)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa77df9211e983ff979de29cba01a9263"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkswr__t.html">kswr_t</a> ksw_align </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xtra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> **&#160;</td>
          <td class="paramname"><em>qry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligning two sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qlen</td><td>length of the query sequence (typically &lt;tlen) </td></tr>
    <tr><td class="paramname">query</td><td>query sequence with 0 &lt;= query[i] &lt; m </td></tr>
    <tr><td class="paramname">tlen</td><td>length of the target sequence </td></tr>
    <tr><td class="paramname">target</td><td>target sequence </td></tr>
    <tr><td class="paramname">m</td><td>number of residue types </td></tr>
    <tr><td class="paramname">mat</td><td>m*m scoring matrix in one-dimention array </td></tr>
    <tr><td class="paramname">gapo</td><td>gap open penalty; a gap of length l cost "-(gapo+l*gape)" </td></tr>
    <tr><td class="paramname">gape</td><td>gap extension penalty </td></tr>
    <tr><td class="paramname">xtra</td><td>extra information (see below) </td></tr>
    <tr><td class="paramname">qry</td><td>query profile (see below)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>alignment information in a struct; unset values to -1</dd></dl>
<p>When xtra==0, <a class="el" href="klib_2ksw_8h.html#aa77df9211e983ff979de29cba01a9263" title="Aligning two sequences. ">ksw_align()</a> uses a signed two-byte integer to store a score and only finds the best score and the end positions. The 2nd best score or the start positions are not attempted. The default behavior can be tuned by setting KSW_X* flags:</p>
<p>KSW_XBYTE: use an unsigned byte to store a score. If overflow occurs, <a class="el" href="structkswr__t.html#a0a22a140652a9e40a417a2d54e070829">kswr_t::score</a> will be set to 255</p>
<p>KSW_XSUBO: track the 2nd best score and the ending position on the target if the 2nd best is higher than (xtra&amp;0xffff)</p>
<p>KSW_XSTOP: stop if the maximum score is above (xtra&amp;0xffff)</p>
<p>KSW_XSTART: find the start positions</p>
<p>When *qry==NULL, <a class="el" href="klib_2ksw_8h.html#aa77df9211e983ff979de29cba01a9263" title="Aligning two sequences. ">ksw_align()</a> will compute and allocate the query profile and when the function returns, *qry will point to the profile, which can be deallocated simply by free(). If one query is aligned against multiple target sequences, *qry should be set to NULL during the first call and freed after the last call. Note that qry can equal 0. In this case, the query profile will be deallocated in <a class="el" href="klib_2ksw_8h.html#aa77df9211e983ff979de29cba01a9263" title="Aligning two sequences. ">ksw_align()</a>. </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="warpcore_2lib_2src_2klib_2ksw_8c_aa77df9211e983ff979de29cba01a9263_cgraph.png" border="0" usemap="#warpcore_2lib_2src_2klib_2ksw_8c_aa77df9211e983ff979de29cba01a9263_cgraph" alt=""/></div>
<map name="warpcore_2lib_2src_2klib_2ksw_8c_aa77df9211e983ff979de29cba01a9263_cgraph" id="warpcore_2lib_2src_2klib_2ksw_8c_aa77df9211e983ff979de29cba01a9263_cgraph">
<area shape="rect" id="node2" href="klib_2ksw_8c.html#a295f1f9c1e0144e81d4c5900a6698601" title="Initialize the query data structure. " alt="" coords="133,5,211,32"/><area shape="rect" id="node3" href="klib_2ksw_8c.html#aabfa7570c5882f97217fbd4e7b7aedc4" title="ksw_i16" alt="" coords="137,56,207,83"/><area shape="rect" id="node4" href="klib_2ksw_8c.html#a588d7f69adc022a80402b5bfd3509dd3" title="ksw_u8" alt="" coords="139,107,205,133"/><area shape="rect" id="node5" href="klib_2ksw_8c.html#a9b86b0e1cab2423ed292be074a3c5c27" title="revseq" alt="" coords="141,157,203,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af2faf4cafbc6a0b200557da0c0cac4da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksw_extend </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>h0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>_qle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>_tle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7b3b660c0554a2d9817528194b6578a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksw_global </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n_cigar_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t **&#160;</td>
          <td class="paramname"><em>cigar_</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="warpcore_2lib_2src_2klib_2ksw_8c_a7b3b660c0554a2d9817528194b6578a3_cgraph.png" border="0" usemap="#warpcore_2lib_2src_2klib_2ksw_8c_a7b3b660c0554a2d9817528194b6578a3_cgraph" alt=""/></div>
<map name="warpcore_2lib_2src_2klib_2ksw_8c_a7b3b660c0554a2d9817528194b6578a3_cgraph" id="warpcore_2lib_2src_2klib_2ksw_8c_a7b3b660c0554a2d9817528194b6578a3_cgraph">
<area shape="rect" id="node2" href="klib_2ksw_8c.html#a826957eb948116d000d8514b3cd85202" title="push_cigar" alt="" coords="141,5,227,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aabfa7570c5882f97217fbd4e7b7aedc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkswr__t.html">kswr_t</a> ksw_i16 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xtra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a295f1f9c1e0144e81d4c5900a6698601"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a>* ksw_qinit </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *&#160;</td>
          <td class="paramname"><em>mat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the query data structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>Number of bytes used to store a score; valid valures are 1 or 2 </td></tr>
    <tr><td class="paramname">qlen</td><td>Length of the query sequence </td></tr>
    <tr><td class="paramname">query</td><td>Query sequence </td></tr>
    <tr><td class="paramname">m</td><td>Size of the alphabet </td></tr>
    <tr><td class="paramname">mat</td><td>Scoring matrix in a one-dimension array</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Query data structure </dd></dl>

</div>
</div>
<a class="anchor" id="a588d7f69adc022a80402b5bfd3509dd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkswr__t.html">kswr_t</a> ksw_u8 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="klib_2ksw_8h.html#a9ff05689c463b0536ae63ffdc9d59a51">kswq_t</a> *&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_gapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_gape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xtra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a826957eb948116d000d8514b3cd85202"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t* push_cigar </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>n_cigar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>m_cigar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>cigar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a9b86b0e1cab2423ed292be074a3c5c27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void revseq </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="add79ed614f910c5fcae1eead30104f28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structkswr__t.html">kswr_t</a> g_defr = { 0, -1, -1, -1, -1, -1, -1 }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 17 2019 18:39:47 for quant by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
