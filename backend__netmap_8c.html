<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>quant: deps/warpcore/lib/src/backend_netmap.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quant
   &#160;<span id="projectnumber">0.0.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_82ce5dd3950c6393668b7cc23fc52b28.html">deps</a></li><li class="navelem"><a class="el" href="dir_63a5f3da5bb346670840ad293d558300.html">warpcore</a></li><li class="navelem"><a class="el" href="dir_f4c0bb2795bdb545195b8a1e3a07cf5b.html">lib</a></li><li class="navelem"><a class="el" href="dir_096e6e3b4888cf9e4ce0fc18373c588c.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">backend_netmap.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;net/if.h&gt;</code><br/>
<code>#include &lt;net/netmap_user.h&gt;</code><br/>
<code>#include &lt;netinet/if_ether.h&gt;</code><br/>
<code>#include &lt;poll.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;sys/ioctl.h&gt;</code><br/>
<code>#include &lt;sys/mman.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;khash.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="warpcore_8h_source.html">warpcore/warpcore.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="arp_8h_source.html">arp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="backend_8h_source.html">backend.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="eth_8h_source.html">eth.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="udp_8h_source.html">udp.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for backend_netmap.c:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c__incl.png" border="0" usemap="#deps_2warpcore_2lib_2src_2backend__netmap_8c" alt=""/></div>
<map name="deps_2warpcore_2lib_2src_2backend__netmap_8c" id="deps_2warpcore_2lib_2src_2backend__netmap_8c">
<area shape="rect" id="node16" href="warpcore_8h.html" title="warpcore/warpcore.h" alt="" coords="963,171,1105,197"/><area shape="rect" id="node25" href="arp_8h.html" title="arp.h" alt="" coords="717,171,768,197"/><area shape="rect" id="node26" href="backend_8h.html" title="backend.h" alt="" coords="1072,96,1153,123"/><area shape="rect" id="node27" href="udp_8h.html" title="udp.h" alt="" coords="826,171,880,197"/><area shape="rect" id="node28" href="eth_8h.html" title="eth.h" alt="" coords="628,96,679,123"/><area shape="rect" id="node19" href="deps_2warpcore_2lib_2include_2warpcore_2config_8h.html" title="warpcore/config.h" alt="" coords="1343,245,1468,272"/><area shape="rect" id="node20" href="plat_8h.html" title="warpcore/plat.h" alt="" coords="979,245,1089,272"/><area shape="rect" id="node21" href="queue_8h.html" title="warpcore/queue.h" alt="" coords="829,245,955,272"/><area shape="rect" id="node22" href="warpcore_2lib_2include_2warpcore_2util_8h.html" title="warpcore/util.h" alt="" coords="1636,245,1743,272"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a006a6d732d649728796cfe027e3041d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a006a6d732d649728796cfe027e3041d9">klib_unused</a></td></tr>
<tr class="separator:a006a6d732d649728796cfe027e3041d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a281a85c5e2760b47cd28cde4e6a5109b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a281a85c5e2760b47cd28cde4e6a5109b">w_set_sockopt</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s, const struct <a class="el" href="structw__sockopt.html">w_sockopt</a> *const opt)</td></tr>
<tr class="memdesc:a281a85c5e2760b47cd28cde4e6a5109b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the socket options.  <a href="#a281a85c5e2760b47cd28cde4e6a5109b">More...</a><br/></td></tr>
<tr class="separator:a281a85c5e2760b47cd28cde4e6a5109b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1efe6c54e4e30260d1c2630726b98eb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a1efe6c54e4e30260d1c2630726b98eb5">backend_init</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, const uint32_t nbufs, const bool is_lo, const bool is_left)</td></tr>
<tr class="memdesc:a1efe6c54e4e30260d1c2630726b98eb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the warpcore netmap backend for engine <code>w</code>.  <a href="#a1efe6c54e4e30260d1c2630726b98eb5">More...</a><br/></td></tr>
<tr class="separator:a1efe6c54e4e30260d1c2630726b98eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e43d05a55650db2be88e9eece99905d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a7e43d05a55650db2be88e9eece99905d">backend_cleanup</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>)</td></tr>
<tr class="memdesc:a7e43d05a55650db2be88e9eece99905d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shut a warpcore netmap engine down cleanly.  <a href="#a7e43d05a55650db2be88e9eece99905d">More...</a><br/></td></tr>
<tr class="separator:a7e43d05a55650db2be88e9eece99905d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3be98876f5c17d36d0436ca491ffd43a"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a3be98876f5c17d36d0436ca491ffd43a">pick_sport</a> (void)</td></tr>
<tr class="separator:a3be98876f5c17d36d0436ca491ffd43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e273595df14dd0f4ad2899eaebafe8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#aa5e273595df14dd0f4ad2899eaebafe8">backend_bind</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s, const struct <a class="el" href="structw__sockopt.html">w_sockopt</a> *const opt)</td></tr>
<tr class="memdesc:aa5e273595df14dd0f4ad2899eaebafe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Netmap-specific code to bind a warpcore socket.  <a href="#aa5e273595df14dd0f4ad2899eaebafe8">More...</a><br/></td></tr>
<tr class="separator:aa5e273595df14dd0f4ad2899eaebafe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10352237f3cab978ad3dbe7f25acb8cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a10352237f3cab978ad3dbe7f25acb8cc">backend_close</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s)</td></tr>
<tr class="memdesc:a10352237f3cab978ad3dbe7f25acb8cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The netmap backend performs no operation here.  <a href="#a10352237f3cab978ad3dbe7f25acb8cc">More...</a><br/></td></tr>
<tr class="separator:a10352237f3cab978ad3dbe7f25acb8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de137fe30801a3c8798185082b134be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a0de137fe30801a3c8798185082b134be">backend_connect</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s)</td></tr>
<tr class="memdesc:a0de137fe30801a3c8798185082b134be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect the given <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>, using the netmap backend.  <a href="#a0de137fe30801a3c8798185082b134be">More...</a><br/></td></tr>
<tr class="separator:a0de137fe30801a3c8798185082b134be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf46056f39cb452d908ddac8cf6e57c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#aaf46056f39cb452d908ddac8cf6e57c5">w_fd</a> (const struct <a class="el" href="structw__sock.html">w_sock</a> *const s)</td></tr>
<tr class="memdesc:aaf46056f39cb452d908ddac8cf6e57c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the file descriptor associated with a <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>.  <a href="#aaf46056f39cb452d908ddac8cf6e57c5">More...</a><br/></td></tr>
<tr class="separator:aaf46056f39cb452d908ddac8cf6e57c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21a4e848c9199be729d01d20b8eea3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d">w_rx</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s, struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const i)</td></tr>
<tr class="memdesc:af21a4e848c9199be729d01d20b8eea3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return any new data that has been received on a socket by appending it to the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> tail queue <code>i</code>.  <a href="#af21a4e848c9199be729d01d20b8eea3d">More...</a><br/></td></tr>
<tr class="separator:af21a4e848c9199be729d01d20b8eea3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f053bd8ffef52d164823134d732f51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#ac4f053bd8ffef52d164823134d732f51">w_tx</a> (const struct <a class="el" href="structw__sock.html">w_sock</a> *const s, struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const o)</td></tr>
<tr class="memdesc:ac4f053bd8ffef52d164823134d732f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loops over the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> structures in the <a class="el" href="structw__iov__sq.html" title="A tail queue of w_iov I/O vectors. ">w_iov_sq</a> <code>o</code>, sending them all over <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> <code>s</code>.  <a href="#ac4f053bd8ffef52d164823134d732f51">More...</a><br/></td></tr>
<tr class="separator:ac4f053bd8ffef52d164823134d732f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0508cfebe874ba0f3f2f230b4120e0d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#ab0508cfebe874ba0f3f2f230b4120e0d">w_nic_rx</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, const int32_t msec)</td></tr>
<tr class="memdesc:ab0508cfebe874ba0f3f2f230b4120e0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger netmap to make new received data available to <a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i...">w_rx()</a>.  <a href="#ab0508cfebe874ba0f3f2f230b4120e0d">More...</a><br/></td></tr>
<tr class="separator:ab0508cfebe874ba0f3f2f230b4120e0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fba5669717435248ca7b7945a9b9d75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a3fba5669717435248ca7b7945a9b9d75">w_nic_tx</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>)</td></tr>
<tr class="memdesc:a3fba5669717435248ca7b7945a9b9d75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push data placed in the TX rings via <a class="el" href="udp_8c.html#a5ff6c06e976086b17457bc7766bb8e0c" title="Sends a payload contained in a w_sock::ov via UDP. ">udp_tx()</a> and similar methods out onto the link.  <a href="#a3fba5669717435248ca7b7945a9b9d75">More...</a><br/></td></tr>
<tr class="separator:a3fba5669717435248ca7b7945a9b9d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b69177f908fb482ce2a3d5d59c5e0a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a23b69177f908fb482ce2a3d5d59c5e0a">w_rx_ready</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, struct w_sock_slist *const sl)</td></tr>
<tr class="memdesc:a23b69177f908fb482ce2a3d5d59c5e0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a w_sock_slist with pointers to some sockets with pending inbound data.  <a href="#a23b69177f908fb482ce2a3d5d59c5e0a">More...</a><br/></td></tr>
<tr class="separator:a23b69177f908fb482ce2a3d5d59c5e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7c5ea7d02c5d0693dfc377f3a7f929a1"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a7c5ea7d02c5d0693dfc377f3a7f929a1">backend_name</a> [] = &quot;netmap&quot;</td></tr>
<tr class="memdesc:a7c5ea7d02c5d0693dfc377f3a7f929a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The backend name.  <a href="#a7c5ea7d02c5d0693dfc377f3a7f929a1">More...</a><br/></td></tr>
<tr class="separator:a7c5ea7d02c5d0693dfc377f3a7f929a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a006a6d732d649728796cfe027e3041d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define klib_unused</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa5e273595df14dd0f4ad2899eaebafe8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int backend_bind </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structw__sockopt.html">w_sockopt</a> *const&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Netmap-specific code to bind a warpcore socket. </p>
<p>Only computes a random port number if the socket is not bound to a specific port yet.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">s</td><td>The <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> to bind. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opt</td><td>Socket options for this socket. Can be zero.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, <code>errno</code> otherwise. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_aa5e273595df14dd0f4ad2899eaebafe8_cgraph.png" border="0" usemap="#backend__netmap_8c_aa5e273595df14dd0f4ad2899eaebafe8_cgraph" alt=""/></div>
<map name="backend__netmap_8c_aa5e273595df14dd0f4ad2899eaebafe8_cgraph" id="backend__netmap_8c_aa5e273595df14dd0f4ad2899eaebafe8_cgraph">
<area shape="rect" id="node2" href="backend__netmap_8c.html#a281a85c5e2760b47cd28cde4e6a5109b" title="Set the socket options. " alt="" coords="158,5,269,32"/><area shape="rect" id="node3" href="backend__netmap_8c.html#a3be98876f5c17d36d0436ca491ffd43a" title="pick_sport" alt="" coords="172,56,255,83"/><area shape="rect" id="node4" href="warpcore_8h.html#a4ecb03f6a94c2911ab004803802a27c0" title="Calculate a uniformly distributed random number in [0, upper_bound) avoiding &quot;modulo bias&quot;..." alt="" coords="317,56,432,83"/><area shape="rect" id="node5" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="481,56,557,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7e43d05a55650db2be88e9eece99905d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shut a warpcore netmap engine down cleanly. </p>
<p>This function returns all <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> structures associated the engine to netmap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Backend engine. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph.png" border="0" usemap="#backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph" id="backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph">
<area shape="rect" id="node2" href="arp_8c.html#a1b84f8ec20a55f766fcfcb9cd2d0d1e7" title="Free the ARP cache entries associated with engine w. " alt="" coords="177,5,287,32"/><area shape="rect" id="node3" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="191,56,273,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10352237f3cab978ad3dbe7f25acb8cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The netmap backend performs no operation here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> to close. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0de137fe30801a3c8798185082b134be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int backend_connect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect the given <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>, using the netmap backend. </p>
<p>If the Ethernet MAC address of the destination (or the default router towards it) is not known, it will block trying to look it up via ARP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> to connect.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, <code>errno</code> otherwise. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a0de137fe30801a3c8798185082b134be_cgraph.png" border="0" usemap="#backend__netmap_8c_a0de137fe30801a3c8798185082b134be_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a0de137fe30801a3c8798185082b134be_cgraph" id="backend__netmap_8c_a0de137fe30801a3c8798185082b134be_cgraph">
<area shape="rect" id="node2" href="backend_8h.html#a03bc21b220cd1dbb450c6d3ea4f838c9" title="The IPv4 network prefix for the given IPv4 address and netmask. " alt="" coords="778,1385,843,1412"/><area shape="rect" id="node3" href="arp_8c.html#aad7ca3e847867c4dcc618d034aa42739" title="Return the Ethernet MAC address for target IP address dip. " alt="" coords="179,955,277,981"/><area shape="rect" id="node35" href="warpcore_8h.html#aff4f3655674a1befac066bd33657a8c0" title="Get the socket bound to the given four&#45;tuple &lt;source IP, source port, destination IP..." alt="" coords="945,1119,1037,1145"/><area shape="rect" id="node50" href="backend__netmap_8c.html#a3be98876f5c17d36d0436ca491ffd43a" title="pick_sport" alt="" coords="187,1512,269,1539"/><area shape="rect" id="node4" href="arp_8c.html#ab57d1a0513207babcdb2f6a8a8295fae" title="Find the ARP cache entry associated with IPv4 address ip. " alt="" coords="326,1005,437,1032"/><area shape="rect" id="node5" href="backend_8h.html#a3ea12851bfb4f83f0843560797d0241e" title="w_alloc_iov_base" alt="" coords="928,31,1053,57"/><area shape="rect" id="node8" href="eth_8h.html#a01df29c04e9962e458497dc6d3ea7da3" title="Return a pointer to the first data byte inside the Ethernet frame in buf. " alt="" coords="775,1309,847,1336"/><area shape="rect" id="node9" href="eth_8c.html#a81ff5f8f32f3f31da0fa707ebbb69b1b" title="Places an Ethernet frame into a TX ring. " alt="" coords="352,879,411,905"/><area shape="rect" id="node11" href="warpcore_8h.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. " alt="" coords="953,107,1028,133"/><area shape="rect" id="node12" href="warpcore_8h.html#ab0508cfebe874ba0f3f2f230b4120e0d" title="Trigger netmap to make new received data available to w_rx(). " alt="" coords="344,955,419,981"/><area shape="rect" id="node6" href="backend_8h.html#a5bca37c30d432e0c16c44d8e0c087e5f" title="init_iov" alt="" coords="1153,31,1215,57"/><area shape="rect" id="node7" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="1309,31,1392,57"/><area shape="rect" id="node10" href="eth_8c.html#a84b1cdcdafabcab37d01ffff5a0e1938" title="ether_ntoa_r" alt="" coords="601,955,695,981"/><area shape="rect" id="node13" href="conn_8c.html#a69924c834acb11f94887f781e4241397" title="rx" alt="" coords="498,955,537,981"/><area shape="rect" id="node46" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. " alt="" coords="488,1208,547,1235"/><area shape="rect" id="node49" href="backend_8h.html#a2242871306406e5b7f993f173bb9ff4a" title="is_pipe" alt="" coords="486,904,549,931"/><area shape="rect" id="node14" href="warpcore_8h.html#a5ac8908312be71047433d7e51059e240" title="Return warpcore engine serving w_sock s. " alt="" coords="772,144,849,171"/><area shape="rect" id="node15" href="warpcore_8h.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i..." alt="" coords="623,43,673,69"/><area shape="rect" id="node17" href="conn_8c.html#a743c431b40b906bbe9baad4456a0e7c5" title="rx_pkts" alt="" coords="615,625,681,652"/><area shape="rect" id="node40" href="conn_8c.html#a1a9a96efc3be558373804c33a60df6b9" title="tx" alt="" coords="629,1157,667,1184"/><area shape="rect" id="node41" href="conn_8c.html#a3b5d57a3e32f9d5cc8a8fccfb2e0f5a9" title="tx_ack" alt="" coords="780,1157,841,1184"/><area shape="rect" id="node42" href="conn_8h.html#a526357c19864e7579573160573a55c33" title="pn_for_epoch" alt="" coords="598,853,698,880"/><area shape="rect" id="node43" href="pn_8c.html#a7f1a6720a0e3506c0553d13ad865510f" title="needs_ack" alt="" coords="605,904,691,931"/><area shape="rect" id="node44" href="conn_8c.html#a4a5deef512e20b125b45899c6c80c6fc" title="free_conn" alt="" coords="609,1005,687,1032"/><area shape="rect" id="node45" href="quant_8h.html#a84a768c49cd352e1c8a109bda56ef3a6" title="q_rx_ready" alt="" coords="947,904,1034,931"/><area shape="rect" id="node16" href="warpcore_8h.html#aa17e20ed409edbfe18aa79ae5da640ff" title="Return a spare w_iov from the pool of the given warpcore engine. " alt="" coords="765,43,856,69"/><area shape="rect" id="node18" href="quic_8c.html#a4e51fb8c9ebc5178b5131826ca26fb90" title="write_to_corpus" alt="" coords="753,701,868,728"/><area shape="rect" id="node19" href="warpcore_8h.html#a7644484ec2768497622b01587fc428ab" title="Return whether a socket is connected (i.e., w_connect() has been called on it) or not..." alt="" coords="761,752,860,779"/><area shape="rect" id="node20" href="conn_8c.html#a042a55d10b57e402bf5982add4983181" title="get_conn_by_ipnp" alt="" coords="747,803,874,829"/><area shape="rect" id="node21" href="warpcore_8h.html#a0d68d8dde6e6c8f97f250c076c2e6b9a" title="Return the local port a w_sock is bound to. " alt="" coords="944,955,1037,981"/><area shape="rect" id="node22" href="pkt_8c.html#ab205cb10435c8caf476391325b68eb66" title="dec_pkt_hdr_beginning" alt="" coords="1107,347,1261,373"/><area shape="rect" id="node23" href="pkt_8h.html#a4bfe94fcdabe97c2898be1e6d6f5bc1d" title="is_lh" alt="" coords="1326,321,1375,348"/><area shape="rect" id="node24" href="pkt_8h.html#a05682f9ba0bc730b6f41b9597b756730" title="pkt_type_str" alt="" coords="1137,245,1231,272"/><area shape="rect" id="node25" href="pkt_8c.html#acda77940d975cd06aecc7f0aae9f2aa0" title="tx_vneg_resp" alt="" coords="761,296,861,323"/><area shape="rect" id="node26" href="conn_8h.html#a3b1788e29ec153bfcb2b7edc34c488a6" title="is_force_vneg_vers" alt="" coords="923,397,1058,424"/><area shape="rect" id="node27" href="pkt_8c.html#aad4456e4786b31e02e1e4c81e265d442" title="log_pkt" alt="" coords="959,271,1023,297"/><area shape="rect" id="node28" href="conn_8c.html#a370e079f6b872eb4fb70053eb3fd14a3" title="get_conn_by_cid" alt="" coords="751,499,871,525"/><area shape="rect" id="node29" href="conn_8c.html#a1ae0706a577e85efbcfacf517a329dbe" title="vers_supported" alt="" coords="755,448,866,475"/><area shape="rect" id="node30" href="conn_8c.html#a51850847894ca6bd5bd7a3f06fc9f1ff" title="new_conn" alt="" coords="770,1056,851,1083"/><area shape="rect" id="node33" href="conn_8c.html#ae5beee50c7414b14d1efb1e3e8ebe1ee" title="add_dcid" alt="" coords="953,1005,1028,1032"/><area shape="rect" id="node34" href="conn_8h.html#aa0fec7fdf46459b57e64dbe4e79a8dc4" title="conn_type" alt="" coords="1143,955,1225,981"/><area shape="rect" id="node36" href="tls_8c.html#a00ca93e0c4b1bdde1a2e97a4ef13373e" title="init_tls" alt="" coords="781,600,841,627"/><area shape="rect" id="node37" href="conn_8h.html#ad2372a4b6e27ada905f0604c1725abf1" title="cid_cmp" alt="" coords="775,1107,846,1133"/><area shape="rect" id="node39" href="conn_8c.html#abf07a95614d3f540d12bd3dc1bb4391f" title="get_cid_by_id" alt="" coords="759,651,862,677"/><area shape="rect" id="node31" href="warpcore_8h.html#a4ecb03f6a94c2911ab004803802a27c0" title="Calculate a uniformly distributed random number in [0, upper_bound) avoiding &quot;modulo bias&quot;..." alt="" coords="933,1397,1048,1424"/><area shape="rect" id="node32" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="1146,1397,1222,1424"/><area shape="rect" id="node38" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="953,1195,1029,1221"/><area shape="rect" id="node47" href="ip_8c.html#a83c3b73e5ae32815530bdb103a0a59ee" title="Receive processing for an IPv4 packet. " alt="" coords="623,1259,673,1285"/><area shape="rect" id="node48" href="arp_8c.html#adfea277e13c34a07fc16cb4455988d71" title="Receive an ARP packet, and react to it. " alt="" coords="619,1309,677,1336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1efe6c54e4e30260d1c2630726b98eb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>nbufs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_left</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the warpcore netmap backend for engine <code>w</code>. </p>
<p>This switches the interface to netmap mode, maps the underlying buffers into memory and locks it there, and sets up the extra buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">w</td><td>Backend engine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbufs</td><td>Number of packet buffers to allocate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_lo</td><td>Is this a loopback interface? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_left</td><td>Is this the left end of a loopback pipe? </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph.png" border="0" usemap="#backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph" id="backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph">
<area shape="rect" id="node2" href="arp_8c.html#a5857d8f27a0bcfa2b9dfe8308ac7befb" title="Update the MAC address associated with IPv4 address ip in the ARP cache. " alt="" coords="149,5,277,32"/><area shape="rect" id="node4" href="warpcore_8h.html#af368cd1b58be4de19321744322f44c4a" title="Return name of interface associated with a warpcore engine. " alt="" coords="174,56,253,83"/><area shape="rect" id="node5" href="backend_8h.html#a5bca37c30d432e0c16c44d8e0c087e5f" title="init_iov" alt="" coords="182,107,245,133"/><area shape="rect" id="node3" href="arp_8c.html#ab57d1a0513207babcdb2f6a8a8295fae" title="Find the ARP cache entry associated with IPv4 address ip. " alt="" coords="326,5,437,32"/><area shape="rect" id="node6" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="340,107,423,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3be98876f5c17d36d0436ca491ffd43a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t pick_sport </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a3be98876f5c17d36d0436ca491ffd43a_cgraph.png" border="0" usemap="#backend__netmap_8c_a3be98876f5c17d36d0436ca491ffd43a_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a3be98876f5c17d36d0436ca491ffd43a_cgraph" id="backend__netmap_8c_a3be98876f5c17d36d0436ca491ffd43a_cgraph">
<area shape="rect" id="node2" href="warpcore_8h.html#a4ecb03f6a94c2911ab004803802a27c0" title="Calculate a uniformly distributed random number in [0, upper_bound) avoiding &quot;modulo bias&quot;..." alt="" coords="136,5,251,32"/><area shape="rect" id="node3" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="299,5,375,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf46056f39cb452d908ddac8cf6e57c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int w_fd </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the file descriptor associated with a <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>. </p>
<p>For the netmap backend, this is the per-interface netmap file descriptor. It can be used for poll() or with event-loop libraries in the application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> socket for which to get the underlying descriptor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A file descriptor. </dd></dl>

</div>
</div>
<a class="anchor" id="ab0508cfebe874ba0f3f2f230b4120e0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool w_nic_rx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>msec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger netmap to make new received data available to <a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i...">w_rx()</a>. </p>
<p>Iterates over any new data in the RX rings, calling <a class="el" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. ">eth_rx()</a> for each.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Backend engine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msec</td><td>Timeout in milliseconds. Pass zero for immediate return, -1 for infinite wait.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether any data is ready for reading. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph.png" border="0" usemap="#backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph" alt=""/></div>
<map name="backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph" id="backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph">
<area shape="rect" id="node2" href="conn_8c.html#a69924c834acb11f94887f781e4241397" title="rx" alt="" coords="129,360,167,387"/><area shape="rect" id="node4" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. " alt="" coords="415,56,473,83"/><area shape="rect" id="node9" href="backend_8h.html#a2242871306406e5b7f993f173bb9ff4a" title="is_pipe" alt="" coords="413,107,475,133"/><area shape="rect" id="node3" href="warpcore_8h.html#ab0508cfebe874ba0f3f2f230b4120e0d" title="Trigger netmap to make new received data available to w_rx(). " alt="" coords="229,157,304,184"/><area shape="rect" id="node10" href="warpcore_8h.html#a5ac8908312be71047433d7e51059e240" title="Return warpcore engine serving w_sock s. " alt="" coords="405,208,483,235"/><area shape="rect" id="node11" href="warpcore_8h.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i..." alt="" coords="241,208,292,235"/><area shape="rect" id="node13" href="conn_8c.html#a743c431b40b906bbe9baad4456a0e7c5" title="rx_pkts" alt="" coords="234,917,299,944"/><area shape="rect" id="node44" href="conn_8c.html#a1a9a96efc3be558373804c33a60df6b9" title="tx" alt="" coords="247,1791,286,1817"/><area shape="rect" id="node45" href="conn_8c.html#a3b5d57a3e32f9d5cc8a8fccfb2e0f5a9" title="tx_ack" alt="" coords="413,1880,475,1907"/><area shape="rect" id="node47" href="conn_8h.html#a526357c19864e7579573160573a55c33" title="pn_for_epoch" alt="" coords="217,309,317,336"/><area shape="rect" id="node48" href="pn_8c.html#a7f1a6720a0e3506c0553d13ad865510f" title="needs_ack" alt="" coords="224,360,309,387"/><area shape="rect" id="node49" href="conn_8c.html#a4a5deef512e20b125b45899c6c80c6fc" title="free_conn" alt="" coords="227,1297,306,1324"/><area shape="rect" id="node50" href="quant_8h.html#a84a768c49cd352e1c8a109bda56ef3a6" title="q_rx_ready" alt="" coords="223,1551,310,1577"/><area shape="rect" id="node5" href="eth_8c.html#a84b1cdcdafabcab37d01ffff5a0e1938" title="ether_ntoa_r" alt="" coords="597,56,691,83"/><area shape="rect" id="node6" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="606,781,682,808"/><area shape="rect" id="node7" href="ip_8c.html#a83c3b73e5ae32815530bdb103a0a59ee" title="Receive processing for an IPv4 packet. " alt="" coords="619,107,669,133"/><area shape="rect" id="node8" href="arp_8c.html#adfea277e13c34a07fc16cb4455988d71" title="Receive an ARP packet, and react to it. " alt="" coords="615,5,673,32"/><area shape="rect" id="node12" href="warpcore_8h.html#aa17e20ed409edbfe18aa79ae5da640ff" title="Return a spare w_iov from the pool of the given warpcore engine. " alt="" coords="399,157,489,184"/><area shape="rect" id="node14" href="quic_8c.html#a4e51fb8c9ebc5178b5131826ca26fb90" title="write_to_corpus" alt="" coords="387,1272,501,1299"/><area shape="rect" id="node15" href="warpcore_8h.html#a7644484ec2768497622b01587fc428ab" title="Return whether a socket is connected (i.e., w_connect() has been called on it) or not..." alt="" coords="395,1323,493,1349"/><area shape="rect" id="node16" href="conn_8c.html#a042a55d10b57e402bf5982add4983181" title="get_conn_by_ipnp" alt="" coords="381,1373,507,1400"/><area shape="rect" id="node17" href="warpcore_8h.html#a0d68d8dde6e6c8f97f250c076c2e6b9a" title="Return the local port a w_sock is bound to. " alt="" coords="597,360,691,387"/><area shape="rect" id="node18" href="pkt_8c.html#ab205cb10435c8caf476391325b68eb66" title="dec_pkt_hdr_beginning" alt="" coords="765,1475,920,1501"/><area shape="rect" id="node19" href="pkt_8h.html#a4bfe94fcdabe97c2898be1e6d6f5bc1d" title="is_lh" alt="" coords="969,883,1018,909"/><area shape="rect" id="node20" href="pkt_8h.html#a05682f9ba0bc730b6f41b9597b756730" title="pkt_type_str" alt="" coords="795,731,890,757"/><area shape="rect" id="node21" href="pkt_8c.html#acda77940d975cd06aecc7f0aae9f2aa0" title="tx_vneg_resp" alt="" coords="394,664,494,691"/><area shape="rect" id="node22" href="conn_8h.html#a3b1788e29ec153bfcb2b7edc34c488a6" title="is_force_vneg_vers" alt="" coords="577,731,711,757"/><area shape="rect" id="node23" href="pkt_8c.html#aad4456e4786b31e02e1e4c81e265d442" title="log_pkt" alt="" coords="612,680,676,707"/><area shape="rect" id="node24" href="conn_8c.html#a370e079f6b872eb4fb70053eb3fd14a3" title="get_conn_by_cid" alt="" coords="384,968,504,995"/><area shape="rect" id="node25" href="conn_8c.html#a1ae0706a577e85efbcfacf517a329dbe" title="vers_supported" alt="" coords="389,765,499,792"/><area shape="rect" id="node26" href="conn_8c.html#a51850847894ca6bd5bd7a3f06fc9f1ff" title="new_conn" alt="" coords="403,411,485,437"/><area shape="rect" id="node27" href="openssl_8h.html#a2514cd53d441b44478641a1643af622d" title="ptls_openssl_random\l_bytes" alt="" coords="571,513,717,554"/><area shape="rect" id="node28" href="quic_8h.html#ab2b6d16118c27c0f7c91dfac30c5d446" title="cid_cpy" alt="" coords="809,411,876,437"/><area shape="rect" id="node29" href="conn_8c.html#ae5beee50c7414b14d1efb1e3e8ebe1ee" title="add_dcid" alt="" coords="607,579,681,605"/><area shape="rect" id="node30" href="conn_8h.html#aa0fec7fdf46459b57e64dbe4e79a8dc4" title="conn_type" alt="" coords="801,1221,884,1248"/><area shape="rect" id="node31" href="tls_8c.html#a00ca93e0c4b1bdde1a2e97a4ef13373e" title="init_tls" alt="" coords="414,1019,474,1045"/><area shape="rect" id="node32" href="conn_8h.html#ad2372a4b6e27ada905f0604c1725abf1" title="cid_cmp" alt="" coords="409,816,479,843"/><area shape="rect" id="node33" href="conn_8c.html#abf07a95614d3f540d12bd3dc1bb4391f" title="get_cid_by_id" alt="" coords="393,1069,495,1096"/><area shape="rect" id="node34" href="conn_8c.html#ad504407d4193d0551f761b2ca720b005" title="conns_by_ipnp_update" alt="" coords="367,1120,521,1147"/><area shape="rect" id="node35" href="pkt_8c.html#a4df410764fdb5a8d7468492748e0e3ea" title="dec_pkt_hdr_remainder" alt="" coords="365,867,523,893"/><area shape="rect" id="node36" href="conn_8c.html#ade748bfd0c0c5eb3a94c22bb27c37987" title="pkt_ok_for_epoch" alt="" coords="780,309,905,336"/><area shape="rect" id="node37" href="conn_8c.html#a90b995546c499b521dcb4bf6cc7e39f1" title="epoch_in" alt="" coords="607,1475,681,1501"/><area shape="rect" id="node38" href="conn_8c.html#a9ef5d7dd45e20cc2cf7504fac35c37e0" title="rx_pkt" alt="" coords="415,1171,473,1197"/><area shape="rect" id="node40" href="conn_8c.html#a5d6639a237bb88d66f93760fc93000a5" title="rx_crypto" alt="" coords="406,1576,482,1603"/><area shape="rect" id="node41" href="pkt_8h.html#a2e3325ad951d933d49dcd1cd1e0c04f1" title="epoch_for_pkt_type" alt="" coords="376,1424,512,1451"/><area shape="rect" id="node42" href="stream_8c.html#acf612f3ac0b49aa8c7d6630c00e6b0ce" title="free_stream" alt="" coords="399,1627,489,1653"/><area shape="rect" id="node43" href="warpcore_8h.html#a92bb31feffd5e9e2cda91aa4612bc103" title="Return a single w_iov obtained via w_alloc_len(), w_alloc_cnt() or w_rx() back to warpcore..." alt="" coords="401,1475,487,1501"/><area shape="rect" id="node39" href="conn_8c.html#afd38904c68cab87424e6aa8db723fd38" title="enter_closing" alt="" coords="595,1627,693,1653"/><area shape="rect" id="node46" href="conn_8c.html#a0b0c1eff62e65d38a175b6df4ea4ce80" title="do_conn_mgmt" alt="" coords="589,1855,699,1881"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3fba5669717435248ca7b7945a9b9d75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_nic_tx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push data placed in the TX rings via <a class="el" href="udp_8c.html#a5ff6c06e976086b17457bc7766bb8e0c" title="Sends a payload contained in a w_sock::ov via UDP. ">udp_tx()</a> and similar methods out onto the link. </p>
<p>Also move any transmitted data back into the original w_iovs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Backend engine. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af21a4e848c9199be729d01d20b8eea3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_rx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return any new data that has been received on a socket by appending it to the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> tail queue <code>i</code>. </p>
<p>The tail queue must eventually be returned to warpcore via <a class="el" href="warpcore_8h.html#a960d81cdf30fb1dc693447ba4763f977" title="Return a w_iov tail queue obtained via w_alloc_len(), w_alloc_cnt() or w_rx() back to warpcore...">w_free()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> for which the application would like to receive new data. </td></tr>
    <tr><td class="paramname">i</td><td><a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> tail queue to append new data to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a23b69177f908fb482ce2a3d5d59c5e0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t w_rx_ready </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct w_sock_slist *const&#160;</td>
          <td class="paramname"><em>sl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill a w_sock_slist with pointers to some sockets with pending inbound data. </p>
<p>Data can be obtained via <a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i...">w_rx()</a> on each <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> in the list. Call can optionally block to wait for at least one ready connection. Will return the number of ready connections, or zero if none are ready. When the return value is not zero, a repeated call may return additional ready sockets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Backend engine. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sl</td><td>Empty and initialized w_sock_slist.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of connections that are ready for reading. </dd></dl>

</div>
</div>
<a class="anchor" id="a281a85c5e2760b47cd28cde4e6a5109b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_set_sockopt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structw__sockopt.html">w_sockopt</a> *const&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the socket options. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>{ parameter_description } </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac4f053bd8ffef52d164823134d732f51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_tx </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const&#160;</td>
          <td class="paramname"><em>o</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loops over the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> structures in the <a class="el" href="structw__iov__sq.html" title="A tail queue of w_iov I/O vectors. ">w_iov_sq</a> <code>o</code>, sending them all over <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> <code>s</code>. </p>
<p>Places the payloads into IPv4 UDP packets, and attempts to move them into TX rings. Will force a NIC TX if all rings are full, retry the failed w_iovs. The (last batch of) packets are not send yet; <a class="el" href="backend__netmap_8c.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. ">w_nic_tx()</a> needs to be called (again) for that. This is, so that an application has control over exactly when to schedule packet I/O.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> socket to transmit over. </td></tr>
    <tr><td class="paramname">o</td><td><a class="el" href="structw__iov__sq.html" title="A tail queue of w_iov I/O vectors. ">w_iov_sq</a> to send. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph.png" border="0" usemap="#backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph" alt=""/></div>
<map name="backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph" id="backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph">
<area shape="rect" id="node2" href="warpcore_8h.html#a7644484ec2768497622b01587fc428ab" title="Return whether a socket is connected (i.e., w_connect() has been called on it) or not..." alt="" coords="365,5,464,32"/><area shape="rect" id="node3" href="udp_8c.html#a5ff6c06e976086b17457bc7766bb8e0c" title="Sends a payload contained in a w_sock::ov via UDP. " alt="" coords="111,107,172,133"/><area shape="rect" id="node17" href="backend__netmap_8c.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. " alt="" coords="104,157,179,184"/><area shape="rect" id="node4" href="eth_8h.html#a01df29c04e9962e458497dc6d3ea7da3" title="Return a pointer to the first data byte inside the Ethernet frame in buf. " alt="" coords="379,56,451,83"/><area shape="rect" id="node5" href="ip_8h.html#ae9f26c7f5dc4d2ba6bd03e86a42783da" title="Return a pointer to the payload data of the IPv4 packet in a buffer. " alt="" coords="236,208,300,235"/><area shape="rect" id="node6" href="ip_8c.html#a8d617b65b95abcb1abb3740537e46e34" title="IPv4 transmit processing for the w_iov v of length len. " alt="" coords="227,107,309,133"/><area shape="rect" id="node14" href="in__cksum_8c.html#a91b5a9539546f7879e7f3183e8db41af" title="udp_cksum" alt="" coords="370,208,459,235"/><area shape="rect" id="node15" href="eth_8c.html#a81ff5f8f32f3f31da0fa707ebbb69b1b" title="Places an Ethernet frame into a TX ring. " alt="" coords="239,259,297,285"/><area shape="rect" id="node7" href="warpcore_8h.html#a4ecb03f6a94c2911ab004803802a27c0" title="Calculate a uniformly distributed random number in [0, upper_bound) avoiding &quot;modulo bias&quot;..." alt="" coords="357,107,472,133"/><area shape="rect" id="node9" href="in__cksum_8c.html#a262ae86742cd94bef7aa644688a88816" title="ip_cksum" alt="" coords="375,157,454,184"/><area shape="rect" id="node8" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="550,107,626,133"/><area shape="rect" id="node10" href="in__cksum_8c.html#afe46e60c9c3dcec077eb140e7c032c2c" title="csum_oc16_sse" alt="" coords="529,157,647,184"/><area shape="rect" id="node13" href="in__cksum_8c.html#a7ee8c766405745694128ec30e7c82f5a" title="csum_oc16_reduce" alt="" coords="521,208,655,235"/><area shape="rect" id="node11" href="in__cksum_8c.html#abdeb03525d2385ea8afe255717a04a8a" title="xmm_shift_left" alt="" coords="707,132,815,159"/><area shape="rect" id="node12" href="in__cksum_8c.html#abff563ca718f2c5d4012f12af289b5b1" title="xmm_shift_right" alt="" coords="704,183,819,209"/><area shape="rect" id="node16" href="eth_8c.html#a84b1cdcdafabcab37d01ffff5a0e1938" title="ether_ntoa_r" alt="" coords="367,259,462,285"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a7c5ea7d02c5d0693dfc377f3a7f929a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char backend_name[] = &quot;netmap&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The backend name. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 20 2019 13:45:50 for quant by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
