<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>quant: deps/warpcore/lib/src/backend_netmap.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quant
   &#160;<span id="projectnumber">0.0.17</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_82ce5dd3950c6393668b7cc23fc52b28.html">deps</a></li><li class="navelem"><a class="el" href="dir_63a5f3da5bb346670840ad293d558300.html">warpcore</a></li><li class="navelem"><a class="el" href="dir_f4c0bb2795bdb545195b8a1e3a07cf5b.html">lib</a></li><li class="navelem"><a class="el" href="dir_096e6e3b4888cf9e4ce0fc18373c588c.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">backend_netmap.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;arpa/inet.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;net/if.h&gt;</code><br/>
<code>#include &lt;net/netmap_user.h&gt;</code><br/>
<code>#include &lt;netinet/if_ether.h&gt;</code><br/>
<code>#include &lt;poll.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;sys/ioctl.h&gt;</code><br/>
<code>#include &lt;sys/mman.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;khash.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="warpcore_8h_source.html">warpcore/warpcore.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="arp_8h_source.html">arp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="backend_8h_source.html">backend.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="eth_8h_source.html">eth.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ip_8h_source.html">ip.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="udp_8h_source.html">udp.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for backend_netmap.c:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c__incl.png" border="0" usemap="#deps_2warpcore_2lib_2src_2backend__netmap_8c" alt=""/></div>
<map name="deps_2warpcore_2lib_2src_2backend__netmap_8c" id="deps_2warpcore_2lib_2src_2backend__netmap_8c">
<area shape="rect" id="node17" href="warpcore_8h.html" title="warpcore/warpcore.h" alt="" coords="717,395,859,421"/><area shape="rect" id="node26" href="arp_8h.html" title="arp.h" alt="" coords="1167,171,1217,197"/><area shape="rect" id="node27" href="backend_8h.html" title="backend.h" alt="" coords="708,96,789,123"/><area shape="rect" id="node28" href="udp_8h.html" title="udp.h" alt="" coords="1250,171,1304,197"/><area shape="rect" id="node29" href="eth_8h.html" title="eth.h" alt="" coords="1327,320,1377,347"/><area shape="rect" id="node30" href="ip_8h.html" title="ip.h" alt="" coords="1428,245,1471,272"/><area shape="rect" id="node19" href="deps_2warpcore_2lib_2include_2warpcore_2config_8h.html" title="warpcore/config.h" alt="" coords="849,469,975,496"/><area shape="rect" id="node20" href="plat_8h.html" title="warpcore/plat.h" alt="" coords="471,469,581,496"/><area shape="rect" id="node21" href="queue_8h.html" title="warpcore/queue.h" alt="" coords="999,469,1124,496"/><area shape="rect" id="node22" href="tree_8h.html" title="warpcore/tree.h" alt="" coords="607,469,717,496"/><area shape="rect" id="node23" href="warpcore_2lib_2include_2warpcore_2util_8h.html" title="warpcore/util.h" alt="" coords="239,469,345,496"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a006a6d732d649728796cfe027e3041d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a006a6d732d649728796cfe027e3041d9">klib_unused</a></td></tr>
<tr class="separator:a006a6d732d649728796cfe027e3041d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1efe6c54e4e30260d1c2630726b98eb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a1efe6c54e4e30260d1c2630726b98eb5">backend_init</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, const uint32_t nbufs, const bool is_lo, const bool is_left)</td></tr>
<tr class="memdesc:a1efe6c54e4e30260d1c2630726b98eb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the warpcore netmap backend for engine <code>w</code>.  <a href="#a1efe6c54e4e30260d1c2630726b98eb5">More...</a><br/></td></tr>
<tr class="separator:a1efe6c54e4e30260d1c2630726b98eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e43d05a55650db2be88e9eece99905d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a7e43d05a55650db2be88e9eece99905d">backend_cleanup</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>)</td></tr>
<tr class="memdesc:a7e43d05a55650db2be88e9eece99905d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shut a warpcore netmap engine down cleanly.  <a href="#a7e43d05a55650db2be88e9eece99905d">More...</a><br/></td></tr>
<tr class="separator:a7e43d05a55650db2be88e9eece99905d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ee48b1b41c1c5293f7cca261794b338"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a7ee48b1b41c1c5293f7cca261794b338">backend_bind</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *s)</td></tr>
<tr class="memdesc:a7ee48b1b41c1c5293f7cca261794b338"><td class="mdescLeft">&#160;</td><td class="mdescRight">Netmap-specific code to bind a warpcore socket.  <a href="#a7ee48b1b41c1c5293f7cca261794b338">More...</a><br/></td></tr>
<tr class="separator:a7ee48b1b41c1c5293f7cca261794b338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10352237f3cab978ad3dbe7f25acb8cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a10352237f3cab978ad3dbe7f25acb8cc">backend_close</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s)</td></tr>
<tr class="memdesc:a10352237f3cab978ad3dbe7f25acb8cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The netmap backend performs no operation here.  <a href="#a10352237f3cab978ad3dbe7f25acb8cc">More...</a><br/></td></tr>
<tr class="separator:a10352237f3cab978ad3dbe7f25acb8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5df52522d52bfed04aa270094deaa78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#af5df52522d52bfed04aa270094deaa78">backend_connect</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s)</td></tr>
<tr class="memdesc:af5df52522d52bfed04aa270094deaa78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect the given <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>, using the netmap backend.  <a href="#af5df52522d52bfed04aa270094deaa78">More...</a><br/></td></tr>
<tr class="separator:af5df52522d52bfed04aa270094deaa78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf46056f39cb452d908ddac8cf6e57c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#aaf46056f39cb452d908ddac8cf6e57c5">w_fd</a> (const struct <a class="el" href="structw__sock.html">w_sock</a> *const s)</td></tr>
<tr class="memdesc:aaf46056f39cb452d908ddac8cf6e57c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the file descriptor associated with a <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>.  <a href="#aaf46056f39cb452d908ddac8cf6e57c5">More...</a><br/></td></tr>
<tr class="separator:aaf46056f39cb452d908ddac8cf6e57c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21a4e848c9199be729d01d20b8eea3d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d">w_rx</a> (struct <a class="el" href="structw__sock.html">w_sock</a> *const s, struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const <a class="el" href="fuzz_8c.html#a3a555db7b4c043cd63ed7635a21fe107">i</a>)</td></tr>
<tr class="memdesc:af21a4e848c9199be729d01d20b8eea3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return any new data that has been received on a socket by appending it to the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> tail queue <code>i</code>.  <a href="#af21a4e848c9199be729d01d20b8eea3d">More...</a><br/></td></tr>
<tr class="separator:af21a4e848c9199be729d01d20b8eea3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f053bd8ffef52d164823134d732f51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#ac4f053bd8ffef52d164823134d732f51">w_tx</a> (const struct <a class="el" href="structw__sock.html">w_sock</a> *const s, struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const o)</td></tr>
<tr class="memdesc:ac4f053bd8ffef52d164823134d732f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loops over the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> structures in the <a class="el" href="structw__iov__sq.html" title="A tail queue of w_iov I/O vectors. ">w_iov_sq</a> <code>o</code>, sending them all over <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> <code>s</code>.  <a href="#ac4f053bd8ffef52d164823134d732f51">More...</a><br/></td></tr>
<tr class="separator:ac4f053bd8ffef52d164823134d732f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0508cfebe874ba0f3f2f230b4120e0d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#ab0508cfebe874ba0f3f2f230b4120e0d">w_nic_rx</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, const int32_t msec)</td></tr>
<tr class="memdesc:ab0508cfebe874ba0f3f2f230b4120e0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger netmap to make new received data available to <a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i...">w_rx()</a>.  <a href="#ab0508cfebe874ba0f3f2f230b4120e0d">More...</a><br/></td></tr>
<tr class="separator:ab0508cfebe874ba0f3f2f230b4120e0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fba5669717435248ca7b7945a9b9d75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a3fba5669717435248ca7b7945a9b9d75">w_nic_tx</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>)</td></tr>
<tr class="memdesc:a3fba5669717435248ca7b7945a9b9d75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Push data placed in the TX rings via <a class="el" href="udp_8c.html#a5ff6c06e976086b17457bc7766bb8e0c" title="Sends a payload contained in a w_sock::ov via UDP. ">udp_tx()</a> and similar methods out onto the link.  <a href="#a3fba5669717435248ca7b7945a9b9d75">More...</a><br/></td></tr>
<tr class="separator:a3fba5669717435248ca7b7945a9b9d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b69177f908fb482ce2a3d5d59c5e0a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a23b69177f908fb482ce2a3d5d59c5e0a">w_rx_ready</a> (struct <a class="el" href="structw__engine.html">w_engine</a> *const <a class="el" href="fuzz_8c.html#a8bedaecc1f0b28f6c3ec357ca967b33a">w</a>, struct w_sock_slist *const sl)</td></tr>
<tr class="memdesc:a23b69177f908fb482ce2a3d5d59c5e0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a w_sock_slist with pointers to some sockets with pending inbound data.  <a href="#a23b69177f908fb482ce2a3d5d59c5e0a">More...</a><br/></td></tr>
<tr class="separator:a23b69177f908fb482ce2a3d5d59c5e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7c5ea7d02c5d0693dfc377f3a7f929a1"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="backend__netmap_8c.html#a7c5ea7d02c5d0693dfc377f3a7f929a1">backend_name</a> [] = &quot;netmap&quot;</td></tr>
<tr class="memdesc:a7c5ea7d02c5d0693dfc377f3a7f929a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The backend name.  <a href="#a7c5ea7d02c5d0693dfc377f3a7f929a1">More...</a><br/></td></tr>
<tr class="separator:a7c5ea7d02c5d0693dfc377f3a7f929a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a006a6d732d649728796cfe027e3041d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define klib_unused</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7ee48b1b41c1c5293f7cca261794b338"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_bind </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Netmap-specific code to bind a warpcore socket. </p>
<p>Only computes a random port number per RFC 6056, if the socket is not binding to a specific port.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> to bind. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a7ee48b1b41c1c5293f7cca261794b338_cgraph.png" border="0" usemap="#backend__netmap_8c_a7ee48b1b41c1c5293f7cca261794b338_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a7ee48b1b41c1c5293f7cca261794b338_cgraph" id="backend__netmap_8c_a7ee48b1b41c1c5293f7cca261794b338_cgraph">
<area shape="rect" id="node2" href="warpcore_8h.html#a61040d6a1057690cce90907f628a0e16" title="Return a random number. " alt="" coords="172,5,236,32"/><area shape="rect" id="node4" href="warpcore_8h.html#a69efb41e98d6e0b055364a6991d415a9" title="Get the socket bound to the &lt;sport, dport&gt; pair. " alt="" coords="158,56,250,83"/><area shape="rect" id="node3" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="299,5,375,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7e43d05a55650db2be88e9eece99905d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shut a warpcore netmap engine down cleanly. </p>
<p>This function returns all <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> structures associated the engine to netmap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Backend engine. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph.png" border="0" usemap="#backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph" id="backend__netmap_8c_a7e43d05a55650db2be88e9eece99905d_cgraph">
<area shape="rect" id="node2" href="arp_8c.html#a1b84f8ec20a55f766fcfcb9cd2d0d1e7" title="Free the ARP cache entries associated with engine w. " alt="" coords="177,5,287,32"/><area shape="rect" id="node3" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="191,56,273,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10352237f3cab978ad3dbe7f25acb8cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The netmap backend performs no operation here. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> to close. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af5df52522d52bfed04aa270094deaa78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_connect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect the given <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>, using the netmap backend. </p>
<p>If the Ethernet MAC address of the destination (or the default router towards it) is not known, it will block trying to look it up via ARP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> to connect. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_af5df52522d52bfed04aa270094deaa78_cgraph.png" border="0" usemap="#backend__netmap_8c_af5df52522d52bfed04aa270094deaa78_cgraph" alt=""/></div>
<map name="backend__netmap_8c_af5df52522d52bfed04aa270094deaa78_cgraph" id="backend__netmap_8c_af5df52522d52bfed04aa270094deaa78_cgraph">
<area shape="rect" id="node2" href="backend_8h.html#a03bc21b220cd1dbb450c6d3ea4f838c9" title="The IPv4 network prefix for the given IPv4 address and netmask. " alt="" coords="717,606,782,632"/><area shape="rect" id="node3" href="arp_8c.html#aad7ca3e847867c4dcc618d034aa42739" title="Return the Ethernet MAC address for target IP address dip. " alt="" coords="179,783,277,810"/><area shape="rect" id="node4" href="arp_8c.html#ab57d1a0513207babcdb2f6a8a8295fae" title="Find the ARP cache entry associated with IPv4 address ip. " alt="" coords="862,859,973,886"/><area shape="rect" id="node5" href="backend_8h.html#a3ea12851bfb4f83f0843560797d0241e" title="w_alloc_iov_base" alt="" coords="1021,707,1147,734"/><area shape="rect" id="node8" href="eth_8h.html#a01df29c04e9962e458497dc6d3ea7da3" title="Return a pointer to the first data byte inside the Ethernet frame in buf. " alt="" coords="1204,530,1276,556"/><area shape="rect" id="node9" href="eth__tx_8h.html#a77ddf822dd36e3ef625a1e446c9f7b15" title="Places an Ethernet frame into a TX ring. " alt="" coords="1211,884,1269,911"/><area shape="rect" id="node11" href="warpcore_8h.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. " alt="" coords="1047,758,1121,784"/><area shape="rect" id="node12" href="warpcore_8h.html#ab0508cfebe874ba0f3f2f230b4120e0d" title="Trigger netmap to make new received data available to w_rx(). " alt="" coords="325,682,400,708"/><area shape="rect" id="node6" href="backend_8h.html#a5bca37c30d432e0c16c44d8e0c087e5f" title="init_iov" alt="" coords="1209,707,1271,734"/><area shape="rect" id="node7" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="1360,707,1443,734"/><area shape="rect" id="node10" href="eth_8c.html#a84b1cdcdafabcab37d01ffff5a0e1938" title="ether_ntoa_r" alt="" coords="1354,923,1449,950"/><area shape="rect" id="node13" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. " alt="" coords="451,682,509,708"/><area shape="rect" id="node36" href="backend_8h.html#a2242871306406e5b7f993f173bb9ff4a" title="is_pipe" alt="" coords="449,631,511,658"/><area shape="rect" id="node14" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="561,631,637,658"/><area shape="rect" id="node15" href="ip_8c.html#a83c3b73e5ae32815530bdb103a0a59ee" title="Receive processing for an IPv4 packet. " alt="" coords="573,232,624,259"/><area shape="rect" id="node33" href="arp_8c.html#adfea277e13c34a07fc16cb4455988d71" title="Receive an ARP packet, and react to it. " alt="" coords="569,682,628,708"/><area shape="rect" id="node16" href="backend_8h.html#ad7729f17279f9d1a8ec331c6060a7c1a" title="Compute the IPv4 broadcast address for the given IPv4 address and netmask. " alt="" coords="710,232,789,259"/><area shape="rect" id="node17" href="in__cksum_8c.html#a262ae86742cd94bef7aa644688a88816" title="Compute the Internet checksum over buffer buf of length len. " alt="" coords="1201,251,1279,278"/><area shape="rect" id="node20" href="ip_8h.html#a147f3deb53c55c2206bfa17c72ecae6f" title="Extract the IP header length out of an ip_hdr::vhl field. " alt="" coords="1215,23,1265,50"/><area shape="rect" id="node21" href="udp_8c.html#a06a9a6f02f44430b11f90693b72dc63a" title="Receive a UDP packet. " alt="" coords="719,352,780,379"/><area shape="rect" id="node25" href="icmp_8c.html#a07ccf7ab70e02d29731d2aea211c8a7d" title="Make an ICMP message with the given type and code based on the received packet in buf..." alt="" coords="883,352,951,379"/><area shape="rect" id="node31" href="icmp_8c.html#a151b4a3f6fc7181caeaf927e1062530a" title="Analyze an inbound ICMP packet and react to it. " alt="" coords="715,156,783,183"/><area shape="rect" id="node18" href="in__cksum_8c.html#aaa17fb4a5e6679ec512bab73d6121ecb" title="csum_oc16" alt="" coords="1357,302,1446,328"/><area shape="rect" id="node19" href="in__cksum_8c.html#a7ee8c766405745694128ec30e7c82f5a" title="csum_oc16_reduce" alt="" coords="1334,251,1469,278"/><area shape="rect" id="node22" href="ip_8h.html#ae9f26c7f5dc4d2ba6bd03e86a42783da" title="Return a pointer to the payload data of the IPv4 packet in a buffer. " alt="" coords="1052,150,1116,176"/><area shape="rect" id="node23" href="in__cksum_8c.html#a91b5a9539546f7879e7f3183e8db41af" title="udp_cksum" alt="" coords="1195,302,1285,328"/><area shape="rect" id="node24" href="warpcore_8h.html#a69efb41e98d6e0b055364a6991d415a9" title="Get the socket bound to the &lt;sport, dport&gt; pair. " alt="" coords="871,403,963,430"/><area shape="rect" id="node26" href="warpcore_8h.html#a9ef58000f78363a1127c6f5e1da38bb6" title="Return the maximum size a given w_iov may have for the given engine. " alt="" coords="1028,454,1140,480"/><area shape="rect" id="node27" href="ip_8h.html#ab8a5dee15d15e993f85e4a49f76a837b" title="Initialize the static fields in an IPv4 ip_hdr header. " alt="" coords="1043,352,1125,379"/><area shape="rect" id="node28" href="ip_8c.html#a9bf23175bbad85abeaf5f7242a3477e9" title="IPv4 transmit processing for the w_iov v of length len. " alt="" coords="1059,504,1109,531"/><area shape="rect" id="node29" href="warpcore_8h.html#a61040d6a1057690cce90907f628a0e16" title="Return a random number. " alt="" coords="1208,479,1272,506"/><area shape="rect" id="node30" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="1363,479,1439,506"/><area shape="rect" id="node32" href="ip_8h.html#ac579e04a6820b6016d95860e5ede0a5d" title="Calculates the length of the payload data for the given IPv4 header ip. " alt="" coords="873,48,961,75"/><area shape="rect" id="node34" href="arp_8c.html#a07cb7432c1d2686ebba35e7f85bd7b42" title="Modifies the ARP request in buf into a corresponding ARP reply, and sends it. " alt="" coords="880,808,955,835"/><area shape="rect" id="node35" href="arp_8c.html#a5857d8f27a0bcfa2b9dfe8308ac7befb" title="Update the MAC address associated with IPv4 address ip in the ARP cache. " alt="" coords="685,808,813,835"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1efe6c54e4e30260d1c2630726b98eb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backend_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>nbufs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>is_left</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the warpcore netmap backend for engine <code>w</code>. </p>
<p>This switches the interface to netmap mode, maps the underlying buffers into memory and locks it there, and sets up the extra buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">w</td><td>Backend engine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbufs</td><td>Number of packet buffers to allocate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_lo</td><td>Is this a loopback interface? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_left</td><td>Is this the left end of a loopback pipe? </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph.png" border="0" usemap="#backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph" alt=""/></div>
<map name="backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph" id="backend__netmap_8c_a1efe6c54e4e30260d1c2630726b98eb5_cgraph">
<area shape="rect" id="node2" href="arp_8c.html#a5857d8f27a0bcfa2b9dfe8308ac7befb" title="Update the MAC address associated with IPv4 address ip in the ARP cache. " alt="" coords="149,5,277,32"/><area shape="rect" id="node4" href="warpcore_8h.html#ad806746e44b2d45c3919f986bc7d392c" title="Return name of interface associated with a warpcore engine. " alt="" coords="174,56,253,83"/><area shape="rect" id="node5" href="backend_8h.html#a5bca37c30d432e0c16c44d8e0c087e5f" title="init_iov" alt="" coords="182,107,245,133"/><area shape="rect" id="node7" href="warpcore_8h.html#a61040d6a1057690cce90907f628a0e16" title="Return a random number. " alt="" coords="181,157,245,184"/><area shape="rect" id="node3" href="arp_8c.html#ab57d1a0513207babcdb2f6a8a8295fae" title="Find the ARP cache entry associated with IPv4 address ip. " alt="" coords="326,5,437,32"/><area shape="rect" id="node6" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="340,107,423,133"/><area shape="rect" id="node8" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="343,157,419,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf46056f39cb452d908ddac8cf6e57c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int w_fd </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the file descriptor associated with a <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a>. </p>
<p>For the netmap backend, this is the per-interface netmap file descriptor. It can be used for poll() or with event-loop libraries in the application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> socket for which to get the underlying descriptor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A file descriptor. </dd></dl>

</div>
</div>
<a class="anchor" id="ab0508cfebe874ba0f3f2f230b4120e0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool w_nic_rx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int32_t&#160;</td>
          <td class="paramname"><em>msec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger netmap to make new received data available to <a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i...">w_rx()</a>. </p>
<p>Iterates over any new data in the RX rings, calling <a class="el" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. ">eth_rx()</a> for each.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Backend engine. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msec</td><td>Timeout in milliseconds. Pass zero for immediate return, -1 for infinite wait.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether any data is ready for reading. </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph.png" border="0" usemap="#backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph" alt=""/></div>
<map name="backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph" id="backend__netmap_8c_ab0508cfebe874ba0f3f2f230b4120e0d_cgraph">
<area shape="rect" id="node2" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. " alt="" coords="131,448,189,475"/><area shape="rect" id="node34" href="backend_8h.html#a2242871306406e5b7f993f173bb9ff4a" title="is_pipe" alt="" coords="129,499,191,525"/><area shape="rect" id="node3" href="eth_8c.html#a84b1cdcdafabcab37d01ffff5a0e1938" title="ether_ntoa_r" alt="" coords="1002,443,1097,469"/><area shape="rect" id="node4" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="241,423,317,449"/><area shape="rect" id="node5" href="ip_8c.html#a83c3b73e5ae32815530bdb103a0a59ee" title="Receive processing for an IPv4 packet. " alt="" coords="253,473,304,500"/><area shape="rect" id="node29" href="arp_8c.html#adfea277e13c34a07fc16cb4455988d71" title="Receive an ARP packet, and react to it. " alt="" coords="376,1031,435,1057"/><area shape="rect" id="node6" href="eth_8h.html#a01df29c04e9962e458497dc6d3ea7da3" title="Return a pointer to the first data byte inside the Ethernet frame in buf. " alt="" coords="852,575,924,601"/><area shape="rect" id="node7" href="backend_8h.html#ad7729f17279f9d1a8ec331c6060a7c1a" title="Compute the IPv4 broadcast address for the given IPv4 address and netmask. " alt="" coords="366,43,445,69"/><area shape="rect" id="node8" href="in__cksum_8c.html#a262ae86742cd94bef7aa644688a88816" title="Compute the Internet checksum over buffer buf of length len. " alt="" coords="849,524,927,551"/><area shape="rect" id="node11" href="ip_8h.html#a147f3deb53c55c2206bfa17c72ecae6f" title="Extract the IP header length out of an ip_hdr::vhl field. " alt="" coords="863,195,913,221"/><area shape="rect" id="node12" href="udp_8c.html#a06a9a6f02f44430b11f90693b72dc63a" title="Receive a UDP packet. " alt="" coords="375,575,436,601"/><area shape="rect" id="node16" href="icmp_8c.html#a07ccf7ab70e02d29731d2aea211c8a7d" title="Make an ICMP message with the given type and code based on the received packet in buf..." alt="" coords="523,473,591,500"/><area shape="rect" id="node27" href="icmp_8c.html#a151b4a3f6fc7181caeaf927e1062530a" title="Analyze an inbound ICMP packet and react to it. " alt="" coords="371,245,439,272"/><area shape="rect" id="node9" href="in__cksum_8c.html#aaa17fb4a5e6679ec512bab73d6121ecb" title="csum_oc16" alt="" coords="1005,657,1094,684"/><area shape="rect" id="node10" href="in__cksum_8c.html#a7ee8c766405745694128ec30e7c82f5a" title="csum_oc16_reduce" alt="" coords="982,569,1117,596"/><area shape="rect" id="node13" href="ip_8h.html#ae9f26c7f5dc4d2ba6bd03e86a42783da" title="Return a pointer to the payload data of the IPv4 packet in a buffer. " alt="" coords="700,271,764,297"/><area shape="rect" id="node14" href="in__cksum_8c.html#a91b5a9539546f7879e7f3183e8db41af" title="udp_cksum" alt="" coords="843,676,933,703"/><area shape="rect" id="node15" href="warpcore_8h.html#a69efb41e98d6e0b055364a6991d415a9" title="Get the socket bound to the &lt;sport, dport&gt; pair. " alt="" coords="511,625,603,652"/><area shape="rect" id="node17" href="backend_8h.html#a3ea12851bfb4f83f0843560797d0241e" title="w_alloc_iov_base" alt="" coords="669,879,795,905"/><area shape="rect" id="node20" href="warpcore_8h.html#a9ef58000f78363a1127c6f5e1da38bb6" title="Return the maximum size a given w_iov may have for the given engine. " alt="" coords="676,423,788,449"/><area shape="rect" id="node21" href="ip_8h.html#ab8a5dee15d15e993f85e4a49f76a837b" title="Initialize the static fields in an IPv4 ip_hdr header. " alt="" coords="691,473,773,500"/><area shape="rect" id="node22" href="ip_8c.html#a9bf23175bbad85abeaf5f7242a3477e9" title="IPv4 transmit processing for the w_iov v of length len. " alt="" coords="707,372,757,399"/><area shape="rect" id="node26" href="warpcore_8h.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. " alt="" coords="695,676,769,703"/><area shape="rect" id="node18" href="backend_8h.html#a5bca37c30d432e0c16c44d8e0c087e5f" title="init_iov" alt="" coords="857,879,919,905"/><area shape="rect" id="node19" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="1008,879,1091,905"/><area shape="rect" id="node23" href="warpcore_8h.html#a61040d6a1057690cce90907f628a0e16" title="Return a random number. " alt="" coords="856,372,920,399"/><area shape="rect" id="node25" href="eth__tx_8h.html#a77ddf822dd36e3ef625a1e446c9f7b15" title="Places an Ethernet frame into a TX ring. " alt="" coords="859,625,917,652"/><area shape="rect" id="node24" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="1011,372,1087,399"/><area shape="rect" id="node28" href="ip_8h.html#ac579e04a6820b6016d95860e5ede0a5d" title="Calculates the length of the payload data for the given IPv4 header ip. " alt="" coords="513,119,601,145"/><area shape="rect" id="node30" href="arp_8c.html#a07cb7432c1d2686ebba35e7f85bd7b42" title="Modifies the ARP request in buf into a corresponding ARP reply, and sends it. " alt="" coords="520,929,595,956"/><area shape="rect" id="node31" href="arp_8c.html#a5857d8f27a0bcfa2b9dfe8308ac7befb" title="Update the MAC address associated with IPv4 address ip in the ARP cache. " alt="" coords="493,1132,621,1159"/><area shape="rect" id="node33" href="backend_8h.html#a03bc21b220cd1dbb450c6d3ea4f838c9" title="The IPv4 network prefix for the given IPv4 address and netmask. " alt="" coords="525,1081,590,1108"/><area shape="rect" id="node32" href="arp_8c.html#ab57d1a0513207babcdb2f6a8a8295fae" title="Find the ARP cache entry associated with IPv4 address ip. " alt="" coords="677,1132,787,1159"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3fba5669717435248ca7b7945a9b9d75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_nic_tx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Push data placed in the TX rings via <a class="el" href="udp_8c.html#a5ff6c06e976086b17457bc7766bb8e0c" title="Sends a payload contained in a w_sock::ov via UDP. ">udp_tx()</a> and similar methods out onto the link. </p>
<p>Also move any transmitted data back into the original w_iovs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Backend engine. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af21a4e848c9199be729d01d20b8eea3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_rx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return any new data that has been received on a socket by appending it to the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> tail queue <code>i</code>. </p>
<p>The tail queue must eventually be returned to warpcore via <a class="el" href="warpcore_8h.html#a960d81cdf30fb1dc693447ba4763f977" title="Return a w_iov tail queue obtained via w_alloc_len(), w_alloc_cnt() or w_rx() back to warpcore...">w_free()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> for which the application would like to receive new data. </td></tr>
    <tr><td class="paramname">i</td><td><a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> tail queue to append new data to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a23b69177f908fb482ce2a3d5d59c5e0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t w_rx_ready </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structw__engine.html">w_engine</a> *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct w_sock_slist *const&#160;</td>
          <td class="paramname"><em>sl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill a w_sock_slist with pointers to some sockets with pending inbound data. </p>
<p>Data can be obtained via <a class="el" href="backend__netmap_8c.html#af21a4e848c9199be729d01d20b8eea3d" title="Return any new data that has been received on a socket by appending it to the w_iov tail queue i...">w_rx()</a> on each <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> in the list. Call can optionally block to wait for at least one ready connection. Will return the number of ready connections, or zero if none are ready. When the return value is not zero, a repeated call may return additional ready sockets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Backend engine. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sl</td><td>Empty and initialized w_sock_slist.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of connections that are ready for reading. </dd></dl>

</div>
</div>
<a class="anchor" id="ac4f053bd8ffef52d164823134d732f51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void w_tx </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structw__sock.html">w_sock</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structw__iov__sq.html">w_iov_sq</a> *const&#160;</td>
          <td class="paramname"><em>o</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loops over the <a class="el" href="structw__iov.html" title="The I/O vector structure that warpcore uses at the center of its API. ">w_iov</a> structures in the <a class="el" href="structw__iov__sq.html" title="A tail queue of w_iov I/O vectors. ">w_iov_sq</a> <code>o</code>, sending them all over <a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> <code>s</code>. </p>
<p>Places the payloads into IPv4 UDP packets, and attempts to move them into TX rings. Will force a NIC TX if all rings are full, retry the failed w_iovs. The (last batch of) packets are not send yet; <a class="el" href="backend__netmap_8c.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. ">w_nic_tx()</a> needs to be called (again) for that. This is, so that an application has control over exactly when to schedule packet I/O.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="structw__sock.html" title="A warpcore socket. ">w_sock</a> socket to transmit over. </td></tr>
    <tr><td class="paramname">o</td><td><a class="el" href="structw__iov__sq.html" title="A tail queue of w_iov I/O vectors. ">w_iov_sq</a> to send. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph.png" border="0" usemap="#backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph" alt=""/></div>
<map name="backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph" id="backend__netmap_8c_ac4f053bd8ffef52d164823134d732f51_cgraph">
<area shape="rect" id="node2" href="warpcore_8h.html#a25db095b03b04843ed074c604c85c27d" title="Return whether a socket is connected (i.e., w_connect() has been called on it) or not..." alt="" coords="227,5,325,32"/><area shape="rect" id="node3" href="udp_8c.html#a5ff6c06e976086b17457bc7766bb8e0c" title="Sends a payload contained in a w_sock::ov via UDP. " alt="" coords="111,309,172,336"/><area shape="rect" id="node39" href="backend__netmap_8c.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. " alt="" coords="104,360,179,387"/><area shape="rect" id="node4" href="eth_8h.html#a01df29c04e9962e458497dc6d3ea7da3" title="Return a pointer to the first data byte inside the Ethernet frame in buf. " alt="" coords="1220,867,1292,893"/><area shape="rect" id="node5" href="ip_8h.html#ae9f26c7f5dc4d2ba6bd03e86a42783da" title="Return a pointer to the payload data of the IPv4 packet in a buffer. " alt="" coords="1068,360,1132,387"/><area shape="rect" id="node7" href="arp_8c.html#aad7ca3e847867c4dcc618d034aa42739" title="Return the Ethernet MAC address for target IP address dip. " alt="" coords="227,917,325,944"/><area shape="rect" id="node24" href="in__cksum_8c.html#a91b5a9539546f7879e7f3183e8db41af" title="udp_cksum" alt="" coords="1211,164,1301,191"/><area shape="rect" id="node29" href="ip_8c.html#a9bf23175bbad85abeaf5f7242a3477e9" title="IPv4 transmit processing for the w_iov v of length len. " alt="" coords="1075,1171,1125,1197"/><area shape="rect" id="node6" href="ip_8h.html#a147f3deb53c55c2206bfa17c72ecae6f" title="Extract the IP header length out of an ip_hdr::vhl field. " alt="" coords="1231,227,1281,253"/><area shape="rect" id="node8" href="arp_8c.html#ab57d1a0513207babcdb2f6a8a8295fae" title="Find the ARP cache entry associated with IPv4 address ip. " alt="" coords="1045,1272,1155,1299"/><area shape="rect" id="node9" href="backend_8h.html#a3ea12851bfb4f83f0843560797d0241e" title="w_alloc_iov_base" alt="" coords="1037,715,1163,741"/><area shape="rect" id="node12" href="eth__tx_8h.html#a77ddf822dd36e3ef625a1e446c9f7b15" title="Places an Ethernet frame into a TX ring. " alt="" coords="1227,1272,1285,1299"/><area shape="rect" id="node14" href="warpcore_8h.html#a3fba5669717435248ca7b7945a9b9d75" title="Push data placed in the TX rings via udp_tx() and similar methods out onto the link. " alt="" coords="1063,867,1137,893"/><area shape="rect" id="node15" href="warpcore_8h.html#ab0508cfebe874ba0f3f2f230b4120e0d" title="Trigger netmap to make new received data available to w_rx(). " alt="" coords="373,867,448,893"/><area shape="rect" id="node10" href="backend_8h.html#a5bca37c30d432e0c16c44d8e0c087e5f" title="init_iov" alt="" coords="1225,715,1287,741"/><area shape="rect" id="node11" href="backend_8h.html#a7f3566b6a4f34920186abe13e80a2760" title="For a given buffer index, get a pointer to its beginning. " alt="" coords="1376,715,1459,741"/><area shape="rect" id="node13" href="eth_8c.html#a84b1cdcdafabcab37d01ffff5a0e1938" title="ether_ntoa_r" alt="" coords="1370,1323,1465,1349"/><area shape="rect" id="node16" href="eth_8c.html#a659282bc0d2ea46d2d4817aa9a2f46e7" title="Receive an Ethernet frame. " alt="" coords="499,867,557,893"/><area shape="rect" id="node38" href="backend_8h.html#a2242871306406e5b7f993f173bb9ff4a" title="is_pipe" alt="" coords="497,816,559,843"/><area shape="rect" id="node17" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="609,816,685,843"/><area shape="rect" id="node18" href="ip_8c.html#a83c3b73e5ae32815530bdb103a0a59ee" title="Receive processing for an IPv4 packet. " alt="" coords="621,525,672,552"/><area shape="rect" id="node34" href="arp_8c.html#adfea277e13c34a07fc16cb4455988d71" title="Receive an ARP packet, and react to it. " alt="" coords="744,968,803,995"/><area shape="rect" id="node19" href="backend_8h.html#ad7729f17279f9d1a8ec331c6060a7c1a" title="Compute the IPv4 broadcast address for the given IPv4 address and netmask. " alt="" coords="734,601,813,628"/><area shape="rect" id="node20" href="in__cksum_8c.html#a262ae86742cd94bef7aa644688a88816" title="Compute the Internet checksum over buffer buf of length len. " alt="" coords="1217,303,1295,329"/><area shape="rect" id="node23" href="udp_8c.html#a06a9a6f02f44430b11f90693b72dc63a" title="Receive a UDP packet. " alt="" coords="743,551,804,577"/><area shape="rect" id="node26" href="icmp_8c.html#a07ccf7ab70e02d29731d2aea211c8a7d" title="Make an ICMP message with the given type and code based on the received packet in buf..." alt="" coords="891,512,959,539"/><area shape="rect" id="node32" href="icmp_8c.html#a151b4a3f6fc7181caeaf927e1062530a" title="Analyze an inbound ICMP packet and react to it. " alt="" coords="739,436,807,463"/><area shape="rect" id="node21" href="in__cksum_8c.html#aaa17fb4a5e6679ec512bab73d6121ecb" title="csum_oc16" alt="" coords="1373,281,1462,308"/><area shape="rect" id="node22" href="in__cksum_8c.html#a7ee8c766405745694128ec30e7c82f5a" title="csum_oc16_reduce" alt="" coords="1350,187,1485,213"/><area shape="rect" id="node25" href="warpcore_8h.html#a69efb41e98d6e0b055364a6991d415a9" title="Get the socket bound to the &lt;sport, dport&gt; pair. " alt="" coords="879,664,971,691"/><area shape="rect" id="node27" href="warpcore_8h.html#a9ef58000f78363a1127c6f5e1da38bb6" title="Return the maximum size a given w_iov may have for the given engine. " alt="" coords="1044,512,1156,539"/><area shape="rect" id="node28" href="ip_8h.html#ab8a5dee15d15e993f85e4a49f76a837b" title="Initialize the static fields in an IPv4 ip_hdr header. " alt="" coords="1059,563,1141,589"/><area shape="rect" id="node30" href="warpcore_8h.html#a61040d6a1057690cce90907f628a0e16" title="Return a random number. " alt="" coords="1224,1171,1288,1197"/><area shape="rect" id="node31" href="klib_2krng_8h.html#a3864312439c8a4b1ca75c8f0cbb9ccff" title="kr_rand_r" alt="" coords="1379,1171,1455,1197"/><area shape="rect" id="node33" href="ip_8h.html#ac579e04a6820b6016d95860e5ede0a5d" title="Calculates the length of the payload data for the given IPv4 header ip. " alt="" coords="881,259,969,285"/><area shape="rect" id="node35" href="arp_8c.html#a07cb7432c1d2686ebba35e7f85bd7b42" title="Modifies the ARP request in buf into a corresponding ARP reply, and sends it. " alt="" coords="888,917,963,944"/><area shape="rect" id="node36" href="arp_8c.html#a5857d8f27a0bcfa2b9dfe8308ac7befb" title="Update the MAC address associated with IPv4 address ip in the ARP cache. " alt="" coords="861,1171,989,1197"/><area shape="rect" id="node37" href="backend_8h.html#a03bc21b220cd1dbb450c6d3ea4f838c9" title="The IPv4 network prefix for the given IPv4 address and netmask. " alt="" coords="893,968,958,995"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a7c5ea7d02c5d0693dfc377f3a7f929a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char backend_name[] = &quot;netmap&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The backend name. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 21 2019 18:33:14 for quant by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
