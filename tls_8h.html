<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>quant: src/tls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">quant
   &#160;<span id="projectnumber">0.0.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f926052f71c4b908188a3093db7cac0c.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &lt;stddef.h&gt;</code><br/>
<code>#include &lt;stdint.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="picotls_8h_source.html">picotls.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tls.h:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h__incl.png" border="0" usemap="#src_2tls_8h" alt=""/></div>
<map name="src_2tls_8h" id="src_2tls_8h">
<area shape="rect" id="node5" href="picotls_8h.html" title="picotls.h" alt="" coords="286,80,356,107"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h__dep__incl.png" border="0" usemap="#src_2tls_8hdep" alt=""/></div>
<map name="src_2tls_8hdep" id="src_2tls_8hdep">
<area shape="rect" id="node2" href="pn_8h.html" title="src/pn.h" alt="" coords="499,80,568,107"/><area shape="rect" id="node3" href="conn_8h.html" title="src/conn.h" alt="" coords="420,155,501,181"/><area shape="rect" id="node6" href="frame_8c.html" title="src/frame.c" alt="" coords="211,304,299,331"/><area shape="rect" id="node7" href="pkt_8c.html" title="src/pkt.c" alt="" coords="5,304,77,331"/><area shape="rect" id="node8" href="quic_8c.html" title="src/quic.c" alt="" coords="677,304,755,331"/><area shape="rect" id="node9" href="recovery_8c.html" title="src/recovery.c" alt="" coords="815,304,920,331"/><area shape="rect" id="node11" href="tls_8c.html" title="src/tls.c" alt="" coords="580,304,649,331"/><area shape="rect" id="node12" href="stream_8h.html" title="src/stream.h" alt="" coords="282,229,376,256"/><area shape="rect" id="node5" href="pkt_8h.html" title="src/pkt.h" alt="" coords="503,229,576,256"/><area shape="rect" id="node13" href="pn_8c.html" title="src/pn.c" alt="" coords="117,304,187,331"/><area shape="rect" id="node4" href="conn_8c.html" title="src/conn.c" alt="" coords="333,304,415,331"/><area shape="rect" id="node10" href="stream_8c.html" title="src/stream.c" alt="" coords="441,304,535,331"/></map>
</div>
</div>
<p><a href="tls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcipher__ctx.html">cipher_ctx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtls.html">tls</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad40306a6371f317e82283cbc83ff93a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ad40306a6371f317e82283cbc83ff93a3">AEAD_LEN</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ad40306a6371f317e82283cbc83ff93a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb040d42850ef7fdc3bfd09469a683e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a7eb040d42850ef7fdc3bfd09469a683e">MAX_HASH_LEN</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a7eb040d42850ef7fdc3bfd09469a683e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aaca089f79f64e61453953e09fd226e46"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#aaca089f79f64e61453953e09fd226e46">epoch_t</a> { <a class="el" href="tls_8h.html#aaca089f79f64e61453953e09fd226e46a6c1fd68888a7d434a18abddfe2fe5f2a">ep_init</a> = 0, 
<a class="el" href="tls_8h.html#aaca089f79f64e61453953e09fd226e46a1a4cdb07d7b5dadfadc6244a5ee78d75">ep_0rtt</a> = 1, 
<a class="el" href="tls_8h.html#aaca089f79f64e61453953e09fd226e46a69c3dbe76abca12db48170aec4973a18">ep_hshk</a> = 2, 
<a class="el" href="tls_8h.html#aaca089f79f64e61453953e09fd226e46a030d34ca4ffa3a300c995276c165043f">ep_data</a> = 3
 }</td></tr>
<tr class="separator:aaca089f79f64e61453953e09fd226e46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a705b76a676f449cbc37b9d955a2e0d5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a705b76a676f449cbc37b9d955a2e0d5c">init_prot</a> (struct q_conn *const c)</td></tr>
<tr class="separator:a705b76a676f449cbc37b9d955a2e0d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb6bf6570799f860123abc836a963ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a6bb6bf6570799f860123abc836a963ad">init_tls</a> (struct q_conn *const c, const char *const <a class="el" href="tls_8c.html#ab9a4bdca4790560e892b981c84de1152">alpn</a>)</td></tr>
<tr class="separator:a6bb6bf6570799f860123abc836a963ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873296f812267d1c3475457cacc3c815"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a873296f812267d1c3475457cacc3c815">init_tp</a> (struct q_conn *const c)</td></tr>
<tr class="separator:a873296f812267d1c3475457cacc3c815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c7d8686952c02e95385a6e3fcab5a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a04c7d8686952c02e95385a6e3fcab5a7">free_tls</a> (struct q_conn *const c, const bool keep_alpn)</td></tr>
<tr class="separator:a04c7d8686952c02e95385a6e3fcab5a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e66d17ae7e8756388309b9e193a9543"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a4e66d17ae7e8756388309b9e193a9543">tls_io</a> (struct <a class="el" href="structq__stream.html">q_stream</a> *const s, struct <a class="el" href="structw__iov.html">w_iov</a> *const iv)</td></tr>
<tr class="separator:a4e66d17ae7e8756388309b9e193a9543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ba632acdcea3aaa92753c3341fa22fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a8ba632acdcea3aaa92753c3341fa22fe">init_tls_ctx</a> (const struct <a class="el" href="structq__conf.html">q_conf</a> *const conf)</td></tr>
<tr class="separator:a8ba632acdcea3aaa92753c3341fa22fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad409e0ca7a5132aa66115caa612f69e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ad409e0ca7a5132aa66115caa612f69e1">free_tls_ctx</a> (void)</td></tr>
<tr class="separator:ad409e0ca7a5132aa66115caa612f69e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04944efc22fe01b0d66065a805db015a"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a04944efc22fe01b0d66065a805db015a">dec_aead</a> (const struct <a class="el" href="structw__iov.html">w_iov</a> *const xv, const struct <a class="el" href="structw__iov.html">w_iov</a> *const v, const uint16_t <a class="el" href="t_2picotls_8c.html#a7360b55975153b822efc5217b7734e6a">len</a>, const struct <a class="el" href="structcipher__ctx.html">cipher_ctx</a> *const <a class="el" href="test_8h.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>)</td></tr>
<tr class="separator:a04944efc22fe01b0d66065a805db015a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6d4a9db5061b3f75c21480419c0489b"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#ae6d4a9db5061b3f75c21480419c0489b">enc_aead</a> (struct q_conn *const c, const struct <a class="el" href="structw__iov.html">w_iov</a> *const v, struct <a class="el" href="structw__iov.html">w_iov</a> *const xv, const uint16_t pkt_nr_pos)</td></tr>
<tr class="separator:ae6d4a9db5061b3f75c21480419c0489b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7af72f607847e5a6a71e9910b489fedc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a7af72f607847e5a6a71e9910b489fedc">make_rtry_tok</a> (struct q_conn *const c)</td></tr>
<tr class="separator:a7af72f607847e5a6a71e9910b489fedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779c1ebd1e6c43f05a373c84defb3fa8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a779c1ebd1e6c43f05a373c84defb3fa8">verify_rtry_tok</a> (struct q_conn *const c, const uint8_t *const tok, const uint16_t tok_len)</td></tr>
<tr class="separator:a779c1ebd1e6c43f05a373c84defb3fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4faeebf5e3d33bfea46325d8fa7343d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a4faeebf5e3d33bfea46325d8fa7343d6">flip_keys</a> (struct q_conn *const c, const bool out)</td></tr>
<tr class="separator:a4faeebf5e3d33bfea46325d8fa7343d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8984aa5b25b32bb8e40aef64f3164fc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a8984aa5b25b32bb8e40aef64f3164fc0">maybe_flip_keys</a> (struct q_conn *const c, const bool out)</td></tr>
<tr class="separator:a8984aa5b25b32bb8e40aef64f3164fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86dadd6335ccba621befa72f320fcf3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#a86dadd6335ccba621befa72f320fcf3e">dispose_cipher</a> (struct <a class="el" href="structcipher__ctx.html">cipher_ctx</a> *<a class="el" href="test_8h.html#a548aff34430d3b5d6d5ba393b8fdda8f">ctx</a>)</td></tr>
<tr class="separator:a86dadd6335ccba621befa72f320fcf3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af6bbbfab377148ff702ada5a44a7ae73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="picotls_8h.html#a7b1de04c9108a605591e1562a2418b86">ptls_context_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tls_8h.html#af6bbbfab377148ff702ada5a44a7ae73">tls_ctx</a></td></tr>
<tr class="memdesc:af6bbbfab377148ff702ada5a44a7ae73"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS context.  <a href="#af6bbbfab377148ff702ada5a44a7ae73">More...</a><br/></td></tr>
<tr class="separator:af6bbbfab377148ff702ada5a44a7ae73"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad40306a6371f317e82283cbc83ff93a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AEAD_LEN&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a7eb040d42850ef7fdc3bfd09469a683e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_HASH_LEN&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="aaca089f79f64e61453953e09fd226e46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="tls_8h.html#aaca089f79f64e61453953e09fd226e46">epoch_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="aaca089f79f64e61453953e09fd226e46a6c1fd68888a7d434a18abddfe2fe5f2a"></a>ep_init</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aaca089f79f64e61453953e09fd226e46a1a4cdb07d7b5dadfadc6244a5ee78d75"></a>ep_0rtt</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aaca089f79f64e61453953e09fd226e46a69c3dbe76abca12db48170aec4973a18"></a>ep_hshk</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aaca089f79f64e61453953e09fd226e46a030d34ca4ffa3a300c995276c165043f"></a>ep_data</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a04944efc22fe01b0d66065a805db015a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t dec_aead </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structw__iov.html">w_iov</a> *const&#160;</td>
          <td class="paramname"><em>xv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structw__iov.html">w_iov</a> *const&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcipher__ctx.html">cipher_ctx</a> *const&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a04944efc22fe01b0d66065a805db015a_cgraph.png" border="0" usemap="#tls_8h_a04944efc22fe01b0d66065a805db015a_cgraph" alt=""/></div>
<map name="tls_8h_a04944efc22fe01b0d66065a805db015a_cgraph" id="tls_8h_a04944efc22fe01b0d66065a805db015a_cgraph">
<area shape="rect" id="node2" href="picotls_8h.html#ad7908a62ead44bf0058b3672cd4321fc" title="decrypts an AEAD record " alt="" coords="133,5,261,32"/><area shape="rect" id="node4" href="pkt_8h.html#a05682f9ba0bc730b6f41b9597b756730" title="pkt_type_str" alt="" coords="150,56,245,83"/><area shape="rect" id="node3" href="picotls_8h.html#a850d1876076b7a5061ffae37aa929b41" title="internal " alt="" coords="309,5,445,32"/><area shape="rect" id="node5" href="pkt_8h.html#a4bfe94fcdabe97c2898be1e6d6f5bc1d" title="is_lh" alt="" coords="494,81,543,108"/><area shape="rect" id="node6" href="pkt_8h.html#a265e9c52eb203bb4701727adc3908850" title="pkt_type" alt="" coords="341,107,413,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a86dadd6335ccba621befa72f320fcf3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dispose_cipher </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcipher__ctx.html">cipher_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae6d4a9db5061b3f75c21480419c0489b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t enc_aead </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structw__iov.html">w_iov</a> *const&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structw__iov.html">w_iov</a> *const&#160;</td>
          <td class="paramname"><em>xv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>pkt_nr_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_ae6d4a9db5061b3f75c21480419c0489b_cgraph.png" border="0" usemap="#tls_8h_ae6d4a9db5061b3f75c21480419c0489b_cgraph" alt=""/></div>
<map name="tls_8h_ae6d4a9db5061b3f75c21480419c0489b_cgraph" id="tls_8h_ae6d4a9db5061b3f75c21480419c0489b_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#a335e59beef17e01808af4433b4bedd9a" title="which_cipher_ctx_out" alt="" coords="134,53,282,80"/><area shape="rect" id="node4" href="pkt_8h.html#a4bfe94fcdabe97c2898be1e6d6f5bc1d" title="is_lh" alt="" coords="598,78,647,105"/><area shape="rect" id="node5" href="pkt_8h.html#a05682f9ba0bc730b6f41b9597b756730" title="pkt_type_str" alt="" coords="161,104,255,130"/><area shape="rect" id="node6" href="picotls_8h.html#a0ba1b8374ab826173b83493093b2aceb" title="ptls_aead_encrypt" alt="" coords="144,382,272,409"/><area shape="rect" id="node11" href="pkt_8c.html#a491976396e2d7fe066ceb2452877eed5" title="xor_hp" alt="" coords="177,205,239,232"/><area shape="rect" id="node3" href="pkt_8h.html#a265e9c52eb203bb4701727adc3908850" title="pkt_type" alt="" coords="383,53,455,80"/><area shape="rect" id="node7" href="picotls_8h.html#a93aa51d621b1cf204e5ea455db7e747e" title="initializes the internal state of the encryptor " alt="" coords="343,357,495,384"/><area shape="rect" id="node9" href="picotls_8h.html#ac80d132d2606d2af959cf5ab4f574766" title="encrypts the input and updates the GCM state " alt="" coords="331,408,506,434"/><area shape="rect" id="node10" href="picotls_8h.html#ad44b4fd94d7f19cdf846abf90260255c" title="emits buffered data (if any) and the GCM tag " alt="" coords="339,458,498,485"/><area shape="rect" id="node8" href="picotls_8h.html#a850d1876076b7a5061ffae37aa929b41" title="internal " alt="" coords="555,357,691,384"/><area shape="rect" id="node12" href="picotls_8h.html#aa77dcaa131915406a4a03be70e268ff0" title="initializes the IV; this function must be called prior to calling ptls_cipher_encrypt ..." alt="" coords="364,205,473,232"/><area shape="rect" id="node13" href="picotls_8h.html#a2d3ae9c9f2704efb7abae1637cb97241" title="encrypts given text " alt="" coords="351,256,486,282"/><area shape="rect" id="node14" href="pkt_8h.html#a8d063c693439da5fd45d03d8112fda9f" title="pkt_nr_len" alt="" coords="377,306,460,333"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4faeebf5e3d33bfea46325d8fa7343d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flip_keys </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a4faeebf5e3d33bfea46325d8fa7343d6_cgraph.png" border="0" usemap="#tls_8h_a4faeebf5e3d33bfea46325d8fa7343d6_cgraph" alt=""/></div>
<map name="tls_8h_a4faeebf5e3d33bfea46325d8fa7343d6_cgraph" id="tls_8h_a4faeebf5e3d33bfea46325d8fa7343d6_cgraph">
<area shape="rect" id="node2" href="picotls_8h.html#a724ff019ff3a867c90b28e4d3e8b6e53" title="returns the cipher&#45;suite being used " alt="" coords="133,5,243,32"/><area shape="rect" id="node3" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="467,56,573,83"/><area shape="rect" id="node4" href="tls_8c.html#ab26c763c76c9b874d651bdba836fc13f" title="setup_initial_key" alt="" coords="129,132,247,159"/><area shape="rect" id="node5" href="picotls_8h.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="441,107,599,133"/><area shape="rect" id="node14" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="1338,259,1443,285"/><area shape="rect" id="node17" href="tls_8c.html#af5ebb2a5b8cab6a40a18677a5ea562fb" title="setup_cipher" alt="" coords="296,157,392,184"/><area shape="rect" id="node6" href="lib_2picotls_8c.html#a7011e70930ac9119a3e9d9a2b4a1d5f6" title="hkdf_expand_label" alt="" coords="1144,157,1275,184"/><area shape="rect" id="node7" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723" title="initializes a buffer, setting the default destination to the small buffer provided as the argument..." alt="" coords="1337,107,1444,133"/><area shape="rect" id="node8" href="boot_8c.html#a48b3b9f7e0a27f07fa14bed55036fa3b" title="strlen" alt="" coords="1363,157,1418,184"/><area shape="rect" id="node9" href="lib_2picotls_8c.html#ad066e549d3eadb8071666a295b3d286d" title="ptls_hkdf_expand" alt="" coords="1329,208,1453,235"/><area shape="rect" id="node15" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="1323,56,1458,83"/><area shape="rect" id="node10" href="lib_2picotls_8c.html#a5db4538399b7412c4dc994ed9041e952" title="ptls_hmac_create" alt="" coords="1513,208,1639,235"/><area shape="rect" id="node11" href="lib_2picotls_8c.html#a4291f2257a1f1c0d5aabb5c1bf782715" title="hmac_update" alt="" coords="1694,157,1794,184"/><area shape="rect" id="node12" href="lib_2picotls_8c.html#a22286798908a379df06073befee1973b" title="hmac_final" alt="" coords="1701,259,1787,285"/><area shape="rect" id="node13" href="lib_2picotls_8c.html#a4184a8e63a098ef29aea464c551a8d14" title="hmac_apply_key" alt="" coords="1843,233,1963,260"/><area shape="rect" id="node16" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0" title="internal " alt="" coords="1507,49,1645,90"/><area shape="rect" id="node18" href="picotls_8h.html#a229de01597e54002f209266c7b4055aa" title="instantiates a symmetric cipher " alt="" coords="462,157,578,184"/><area shape="rect" id="node19" href="picotls_8h.html#a04bb46d751b8ee324d6fe885e3cd50e7" title="instantiates an AEAD cipher given a secret, which is expanded using hkdf to a set of key and iv ..." alt="" coords="465,259,575,285"/><area shape="rect" id="node23" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01" title="destroys a symmetric cipher " alt="" coords="463,208,577,235"/><area shape="rect" id="node20" href="lib_2picotls_8c.html#a263837b2d752dbd55d25187c624c0ee4" title="new_aead" alt="" coords="649,208,730,235"/><area shape="rect" id="node21" href="lib_2picotls_8c.html#af28434536271e3d710dc6ed7be94b5f3" title="get_traffic_key" alt="" coords="779,208,887,235"/><area shape="rect" id="node22" href="lib_2picotls_8c.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="937,157,1095,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a04c7d8686952c02e95385a6e3fcab5a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_tls </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>keep_alpn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a04c7d8686952c02e95385a6e3fcab5a7_cgraph.png" border="0" usemap="#tls_8h_a04c7d8686952c02e95385a6e3fcab5a7_cgraph" alt=""/></div>
<map name="tls_8h_a04c7d8686952c02e95385a6e3fcab5a7_cgraph" id="tls_8h_a04c7d8686952c02e95385a6e3fcab5a7_cgraph">
<area shape="rect" id="node2" href="picotls_8h.html#afbd373f266a52a1718a3476b24c3a295" title="releases all resources associated to the object " alt="" coords="121,205,193,232"/><area shape="rect" id="node11" href="tls_8c.html#a28ce95450a6345dc4f1c85766e2edf8a" title="free_prot" alt="" coords="121,345,194,372"/><area shape="rect" id="node3" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="249,12,383,39"/><area shape="rect" id="node5" href="lib_2picotls_8c.html#a5e886ea709e0a30c1e43d060cac09204" title="free_exporter_master\l_secret" alt="" coords="243,63,389,105"/><area shape="rect" id="node6" href="lib_2picotls_8c.html#a5aa1666c3755a9802eee2c457c5ee410" title="free_esni_secret" alt="" coords="257,129,375,156"/><area shape="rect" id="node7" href="lib_2picotls_8c.html#aa01f986a7fd99cb6e0f405dbdc309e23" title="key_schedule_free" alt="" coords="251,180,381,207"/><area shape="rect" id="node8" href="lib_2picotls_8c.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="263,231,369,257"/><area shape="rect" id="node9" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="263,281,369,308"/><area shape="rect" id="node10" href="lib_2picotls_8c.html#a14c83de31e76992b20510eef18075173" title="update_open_count" alt="" coords="249,332,383,359"/><area shape="rect" id="node4" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0" title="internal " alt="" coords="437,5,576,46"/><area shape="rect" id="node12" href="tls_8c.html#a0e432c22353f0539562e3eb2382001e2" title="dispose_cipher" alt="" coords="261,383,371,409"/><area shape="rect" id="node13" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="453,357,560,384"/><area shape="rect" id="node14" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01" title="destroys a symmetric cipher " alt="" coords="449,408,564,435"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad409e0ca7a5132aa66115caa612f69e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_tls_ctx </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_ad409e0ca7a5132aa66115caa612f69e1_cgraph.png" border="0" usemap="#tls_8h_ad409e0ca7a5132aa66115caa612f69e1_cgraph" alt=""/></div>
<map name="tls_8h_ad409e0ca7a5132aa66115caa612f69e1_cgraph" id="tls_8h_ad409e0ca7a5132aa66115caa612f69e1_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#a0e432c22353f0539562e3eb2382001e2" title="dispose_cipher" alt="" coords="144,31,253,57"/><area shape="rect" id="node3" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="305,5,412,32"/><area shape="rect" id="node4" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01" title="destroys a symmetric cipher " alt="" coords="301,56,416,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a705b76a676f449cbc37b9d955a2e0d5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_prot </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a705b76a676f449cbc37b9d955a2e0d5c_cgraph.png" border="0" usemap="#tls_8h_a705b76a676f449cbc37b9d955a2e0d5c_cgraph" alt=""/></div>
<map name="tls_8h_a705b76a676f449cbc37b9d955a2e0d5c_cgraph" id="tls_8h_a705b76a676f449cbc37b9d955a2e0d5c_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#aff7c4b2f9e78c2d678898dc58bc68e57" title="setup_initial_encryption" alt="" coords="123,56,282,83"/><area shape="rect" id="node3" href="picotls_8h.html#aace42c0ca1898cb625aa1719dcfe67f0" title="ptls_hkdf_extract" alt="" coords="1351,5,1473,32"/><area shape="rect" id="node4" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="1541,208,1646,235"/><area shape="rect" id="node9" href="tls_8c.html#ab26c763c76c9b874d651bdba836fc13f" title="setup_initial_key" alt="" coords="331,309,450,336"/><area shape="rect" id="node5" href="lib_2picotls_8c.html#a5db4538399b7412c4dc994ed9041e952" title="ptls_hmac_create" alt="" coords="1716,217,1841,244"/><area shape="rect" id="node6" href="lib_2picotls_8c.html#a4291f2257a1f1c0d5aabb5c1bf782715" title="hmac_update" alt="" coords="1897,167,1997,193"/><area shape="rect" id="node7" href="lib_2picotls_8c.html#a22286798908a379df06073befee1973b" title="hmac_final" alt="" coords="1904,217,1989,244"/><area shape="rect" id="node8" href="lib_2picotls_8c.html#a4184a8e63a098ef29aea464c551a8d14" title="hmac_apply_key" alt="" coords="2045,243,2165,269"/><area shape="rect" id="node10" href="picotls_8h.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="643,411,802,437"/><area shape="rect" id="node17" href="tls_8c.html#af5ebb2a5b8cab6a40a18677a5ea562fb" title="setup_cipher" alt="" coords="499,259,595,285"/><area shape="rect" id="node11" href="lib_2picotls_8c.html#a7011e70930ac9119a3e9d9a2b4a1d5f6" title="hkdf_expand_label" alt="" coords="1347,411,1477,437"/><area shape="rect" id="node12" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723" title="initializes a buffer, setting the default destination to the small buffer provided as the argument..." alt="" coords="1540,461,1647,488"/><area shape="rect" id="node13" href="boot_8c.html#a48b3b9f7e0a27f07fa14bed55036fa3b" title="strlen" alt="" coords="1566,309,1621,336"/><area shape="rect" id="node14" href="lib_2picotls_8c.html#ad066e549d3eadb8071666a295b3d286d" title="ptls_hkdf_expand" alt="" coords="1531,360,1655,387"/><area shape="rect" id="node15" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="1526,411,1661,437"/><area shape="rect" id="node16" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0" title="internal " alt="" coords="1709,403,1848,445"/><area shape="rect" id="node18" href="picotls_8h.html#a229de01597e54002f209266c7b4055aa" title="instantiates a symmetric cipher " alt="" coords="665,157,781,184"/><area shape="rect" id="node19" href="picotls_8h.html#a04bb46d751b8ee324d6fe885e3cd50e7" title="instantiates an AEAD cipher given a secret, which is expanded using hkdf to a set of key and iv ..." alt="" coords="668,309,777,336"/><area shape="rect" id="node23" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="669,208,776,235"/><area shape="rect" id="node24" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01" title="destroys a symmetric cipher " alt="" coords="665,259,780,285"/><area shape="rect" id="node20" href="lib_2picotls_8c.html#a263837b2d752dbd55d25187c624c0ee4" title="new_aead" alt="" coords="851,309,933,336"/><area shape="rect" id="node21" href="lib_2picotls_8c.html#af28434536271e3d710dc6ed7be94b5f3" title="get_traffic_key" alt="" coords="982,309,1090,336"/><area shape="rect" id="node22" href="lib_2picotls_8c.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="1139,309,1298,336"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6bb6bf6570799f860123abc836a963ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_tls </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>alpn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a6bb6bf6570799f860123abc836a963ad_cgraph.png" border="0" usemap="#tls_8h_a6bb6bf6570799f860123abc836a963ad_cgraph" alt=""/></div>
<map name="tls_8h_a6bb6bf6570799f860123abc836a963ad_cgraph" id="tls_8h_a6bb6bf6570799f860123abc836a963ad_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#a04c7d8686952c02e95385a6e3fcab5a7" title="free_tls" alt="" coords="362,231,427,257"/><area shape="rect" id="node10" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="915,548,1021,575"/><area shape="rect" id="node16" href="picotls_8h.html#aa142dbaa5d99942c25847febf894a1f4" title="create a object to handle new TLS connection. " alt="" coords="153,496,228,523"/><area shape="rect" id="node17" href="picotls_8h.html#aefec8568e3aed02938b396752d54d5e5" title="returns a pointer to user data pointer (client is reponsible for freeing the associated data prior to..." alt="" coords="129,687,252,713"/><area shape="rect" id="node18" href="picotls_8h.html#abc4124b1bc5642960e94ebc06686a614" title="sets the server&#45;name associated to the TLS connection. " alt="" coords="115,737,266,764"/><area shape="rect" id="node19" href="boot_8c.html#a48b3b9f7e0a27f07fa14bed55036fa3b" title="strlen" alt="" coords="367,749,422,776"/><area shape="rect" id="node20" href="tls_8c.html#a5092fa492120deb7469e65bc9f5df3f8" title="filter_tp" alt="" coords="158,839,223,865"/><area shape="rect" id="node21" href="tls_8c.html#a878d1b8325596d2943bb662375ad2e72" title="chk_tp" alt="" coords="160,915,221,941"/><area shape="rect" id="node41" href="tls_8c.html#a705b76a676f449cbc37b9d955a2e0d5c" title="init_prot" alt="" coords="157,636,225,663"/><area shape="rect" id="node3" href="picotls_8h.html#afbd373f266a52a1718a3476b24c3a295" title="releases all resources associated to the object " alt="" coords="548,231,620,257"/><area shape="rect" id="node12" href="tls_8c.html#a28ce95450a6345dc4f1c85766e2edf8a" title="free_prot" alt="" coords="547,121,621,148"/><area shape="rect" id="node4" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="699,12,834,39"/><area shape="rect" id="node6" href="lib_2picotls_8c.html#a5e886ea709e0a30c1e43d060cac09204" title="free_exporter_master\l_secret" alt="" coords="694,165,839,206"/><area shape="rect" id="node7" href="lib_2picotls_8c.html#a5aa1666c3755a9802eee2c457c5ee410" title="free_esni_secret" alt="" coords="707,231,826,257"/><area shape="rect" id="node8" href="lib_2picotls_8c.html#aa01f986a7fd99cb6e0f405dbdc309e23" title="key_schedule_free" alt="" coords="701,281,832,308"/><area shape="rect" id="node9" href="lib_2picotls_8c.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="713,113,820,140"/><area shape="rect" id="node11" href="lib_2picotls_8c.html#a14c83de31e76992b20510eef18075173" title="update_open_count" alt="" coords="699,433,834,460"/><area shape="rect" id="node5" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0" title="internal " alt="" coords="899,5,1037,46"/><area shape="rect" id="node13" href="tls_8c.html#a0e432c22353f0539562e3eb2382001e2" title="dispose_cipher" alt="" coords="712,63,821,89"/><area shape="rect" id="node14" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="915,280,1021,307"/><area shape="rect" id="node15" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01" title="destroys a symmetric cipher " alt="" coords="911,176,1025,203"/><area shape="rect" id="node22" href="tls_8c.html#a4e5325f8fd6e8cca1d74250877d2ba02" title="chk_tp_clnt" alt="" coords="350,813,439,840"/><area shape="rect" id="node23" href="conn_8c.html#a02d7b0c5a072e1b673358b52ac71f160" title="err_close" alt="" coords="547,889,621,916"/><area shape="rect" id="node31" href="tls_8c.html#a0edf1dbf120fe0c438243d9d1a4b66c2" title="chk_tp_serv" alt="" coords="348,864,441,891"/><area shape="rect" id="node33" href="conn_8c.html#ae5beee50c7414b14d1efb1e3e8ebe1ee" title="add_dcid" alt="" coords="357,965,432,992"/><area shape="rect" id="node35" href="conn_8h.html#ad2372a4b6e27ada905f0604c1725abf1" title="cid_cmp" alt="" coords="359,1023,430,1049"/><area shape="rect" id="node37" href="stream_8c.html#a2853c95f04e70a8c7e836f881eedff8d" title="apply_stream_limits" alt="" coords="325,1085,464,1112"/><area shape="rect" id="node28" href="pkt_8c.html#ad04b9f10bc7ad63422f56e3a4fe70e5e" title="clnt_vneg" alt="" coords="545,788,623,815"/><area shape="rect" id="node24" href="conn_8c.html#afd38904c68cab87424e6aa8db723fd38" title="enter_closing" alt="" coords="717,889,816,916"/><area shape="rect" id="node25" href="conn_8h.html#a68c6b30b8665ce894ab5bed3c73a2d9d" title="is_zero" alt="" coords="936,839,1000,865"/><area shape="rect" id="node26" href="conn_8c.html#aea7c8de8c9a43a64163e900a70678ae2" title="enter_closed" alt="" coords="920,889,1016,916"/><area shape="rect" id="node27" href="conn_8h.html#aa0fec7fdf46459b57e64dbe4e79a8dc4" title="conn_type" alt="" coords="927,940,1009,967"/><area shape="rect" id="node29" href="conn_8h.html#a76639ec987a700f45570a287b25025ea" title="is_rsvd_vers" alt="" coords="719,788,815,815"/><area shape="rect" id="node30" href="conn_8h.html#a3b1788e29ec153bfcb2b7edc34c488a6" title="is_force_vneg_vers" alt="" coords="699,839,834,865"/><area shape="rect" id="node32" href="conn_8c.html#a1ae0706a577e85efbcfacf517a329dbe" title="vers_supported" alt="" coords="529,839,639,865"/><area shape="rect" id="node34" href="quic_8h.html#ab2b6d16118c27c0f7c91dfac30c5d446" title="cid_cpy" alt="" coords="551,991,617,1017"/><area shape="rect" id="node36" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="546,1041,622,1068"/><area shape="rect" id="node38" href="stream_8c.html#a222da12d0111c9dee46a6cfc676be209" title="do_stream_fc" alt="" coords="533,1092,635,1119"/><area shape="rect" id="node39" href="stream_8h.html#abcbe2c551d0f4dd754184376bb6cce35" title="need_ctrl_update" alt="" coords="706,1092,827,1119"/><area shape="rect" id="node40" href="stream_8h.html#a55033bb39f92f9963b52dd6d552ec723" title="needs_ctrl" alt="" coords="927,1092,1009,1119"/><area shape="rect" id="node42" href="tls_8c.html#aff7c4b2f9e78c2d678898dc58bc68e57" title="setup_initial_encryption" alt="" coords="315,636,474,663"/><area shape="rect" id="node43" href="picotls_8h.html#aace42c0ca1898cb625aa1719dcfe67f0" title="ptls_hkdf_extract" alt="" coords="523,687,645,713"/><area shape="rect" id="node48" href="tls_8c.html#ab26c763c76c9b874d651bdba836fc13f" title="setup_initial_key" alt="" coords="525,523,643,549"/><area shape="rect" id="node44" href="lib_2picotls_8c.html#a5db4538399b7412c4dc994ed9041e952" title="ptls_hmac_create" alt="" coords="704,737,829,764"/><area shape="rect" id="node45" href="lib_2picotls_8c.html#a4291f2257a1f1c0d5aabb5c1bf782715" title="hmac_update" alt="" coords="918,687,1018,713"/><area shape="rect" id="node46" href="lib_2picotls_8c.html#a22286798908a379df06073befee1973b" title="hmac_final" alt="" coords="925,788,1011,815"/><area shape="rect" id="node47" href="lib_2picotls_8c.html#a4184a8e63a098ef29aea464c551a8d14" title="hmac_apply_key" alt="" coords="1096,763,1216,789"/><area shape="rect" id="node49" href="picotls_8h.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="889,472,1047,499"/><area shape="rect" id="node50" href="tls_8c.html#af5ebb2a5b8cab6a40a18677a5ea562fb" title="setup_cipher" alt="" coords="719,332,815,359"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8ba632acdcea3aaa92753c3341fa22fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_tls_ctx </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structq__conf.html">q_conf</a> *const&#160;</td>
          <td class="paramname"><em>conf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a8ba632acdcea3aaa92753c3341fa22fe_cgraph.png" border="0" usemap="#tls_8h_a8ba632acdcea3aaa92753c3341fa22fe_cgraph" alt=""/></div>
<map name="tls_8h_a8ba632acdcea3aaa92753c3341fa22fe_cgraph" id="tls_8h_a8ba632acdcea3aaa92753c3341fa22fe_cgraph">
<area shape="rect" id="node2" href="openssl_8h.html#af7c98d7cf780b4551d8336dac70d984e" title="ptls_openssl_init_sign\l_certificate" alt="" coords="143,10,294,51"/><area shape="rect" id="node5" href="minicrypto_8h.html#ab40636777366124e3730ff23727b3620" title="ptls_minicrypto_load\l_private_key" alt="" coords="148,475,289,517"/><area shape="rect" id="node19" href="picotls_8h.html#a81fafd2f07929ad23e495dc140b61ea2" title="loads a certificate chain to ptls_context_t::certificates. " alt="" coords="146,99,291,125"/><area shape="rect" id="node21" href="tls_8c.html#a65f1490238853f0e913186fd5c3311c7" title="read_tickets" alt="" coords="172,547,265,573"/><area shape="rect" id="node22" href="openssl_8h.html#a7c10d7be7f166665319c04612bbe3839" title="ptls_openssl_init_verify\l_certificate" alt="" coords="139,875,298,917"/><area shape="rect" id="node30" href="tls_8c.html#a0c58491ff4fb3ef4eaaa05226aea773e" title="on_ch" alt="" coords="190,740,247,767"/><area shape="rect" id="node33" href="tls_8c.html#ae451cab7e92775fe7246239443447424" title="log_secret_cb" alt="" coords="167,309,270,336"/><area shape="rect" id="node36" href="lib_2picotls_8c.html#a7e917599d9876a6c3fa9e470c64fcf67" title="update_traffic_key" alt="" coords="154,196,283,223"/><area shape="rect" id="node39" href="tls_8c.html#acbc1dc9c2da3aab2c683a1d9b5ee9321" title="update_traffic_key_cb" alt="" coords="143,603,294,629"/><area shape="rect" id="node43" href="openssl_8h.html#a2514cd53d441b44478641a1643af622d" title="ptls_openssl_random\l_bytes" alt="" coords="146,966,291,1007"/><area shape="rect" id="node45" href="minicrypto_8h.html#a35a068ba23b50e2c8ba2dd0a362ed38c" title="ptls_minicrypto_random\l_bytes" alt="" coords="139,1102,299,1143"/><area shape="rect" id="node50" href="tls_8c.html#a071d6ebbfd90822e31fdb8119ad971ca" title="init_ticket_prot" alt="" coords="165,392,272,419"/><area shape="rect" id="node3" href="lib_2openssl_8c.html#af035e4d439e5efcf2108c1ebdf82c39f" title="sign_certificate" alt="" coords="386,5,497,32"/><area shape="rect" id="node4" href="lib_2openssl_8c.html#a74358f7c06fb84faf7259d0674e7a7d3" title="do_sign" alt="" coords="632,5,699,32"/><area shape="rect" id="node6" href="minicrypto-pem_8c.html#a535952f10ae103bc06686812e49324f5" title="ptls_pem_parse_private_key" alt="" coords="347,411,535,437"/><area shape="rect" id="node15" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="627,608,703,635"/><area shape="rect" id="node16" href="minicrypto-pem_8c.html#ac98dbcc15c2d18e9f7f0ab1438b30384" title="ptls_set_ecdsa_private_key" alt="" coords="349,461,533,488"/><area shape="rect" id="node7" href="pembase64_8h.html#a7e21e4ccfeae1ad622cc1c15051ed14c" title="ptls_load_pem_objects" alt="" coords="588,259,743,285"/><area shape="rect" id="node11" href="minicrypto-pem_8c.html#a8ee7ca10e770dbf46aac0377caf5c302" title="ptls_minicrypto_asn1\l_decode_private_key" alt="" coords="593,361,738,402"/><area shape="rect" id="node8" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723" title="initializes a buffer, setting the default destination to the small buffer provided as the argument..." alt="" coords="827,183,933,209"/><area shape="rect" id="node9" href="pembase64_8c.html#a11e1c8a84090aee10bc39187c5b031c8" title="ptls_get_pem_object" alt="" coords="809,132,951,159"/><area shape="rect" id="node10" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="813,81,947,108"/><area shape="rect" id="node12" href="asn1_8h.html#a325bbd25be5f4d186c4f88baed2e6673" title="ptls_asn1_get_expected\l_type_and_length" alt="" coords="799,331,961,373"/><area shape="rect" id="node13" href="asn1_8h.html#af00cff6b468e0863d46c8ba60b594a75" title="ptls_asn1_error_message" alt="" coords="795,503,965,529"/><area shape="rect" id="node14" href="asn1_8h.html#a30fd9c1ba60aa7a717775b9be2bc6618" title="ptls_asn1_dump_content" alt="" coords="797,412,963,439"/><area shape="rect" id="node17" href="minicrypto_8h.html#a216b7dc0eaf7e4fc505386119706373d" title="ptls_minicrypto_init\l_secp256r1sha256_sign\l_certificate" alt="" coords="584,477,747,533"/><area shape="rect" id="node18" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="613,208,718,235"/><area shape="rect" id="node20" href="pembase64_8c.html#a7e21e4ccfeae1ad622cc1c15051ed14c" title="ptls_load_pem_objects" alt="" coords="588,107,743,133"/><area shape="rect" id="node23" href="lib_2openssl_8c.html#a60ea7eafbd686a3988afae04498187e6" title="verify_cert" alt="" coords="400,883,483,909"/><area shape="rect" id="node29" href="lib_2openssl_8c.html#aa3240d63b743147d09f4ef9123594019" title="ptls_openssl_create\l_default_certificate_store" alt="" coords="357,934,525,975"/><area shape="rect" id="node24" href="lib_2openssl_8c.html#a79a103c0c30fa42ba456db3118db4272" title="to_x509" alt="" coords="631,933,699,960"/><area shape="rect" id="node25" href="lib_2openssl_8c.html#ac6f98da7f812d15a2421e69e23ee6b4e" title="verify_cert_chain" alt="" coords="605,984,726,1011"/><area shape="rect" id="node26" href="picotls_8h.html#a4c8998052323166300a9b59bc6443337" title="Returns if the context is a server context. " alt="" coords="614,781,717,808"/><area shape="rect" id="node27" href="picotls_8h.html#aa889677e26863e1a37b216aedac72c67" title="returns the server&#45;name (NULL if SNI is not used or failed to negotiate) " alt="" coords="590,832,741,859"/><area shape="rect" id="node28" href="lib_2openssl_8c.html#a7ed99c87b711d8e2e5d8a87d9b8b3d75" title="verify_sign" alt="" coords="623,883,708,909"/><area shape="rect" id="node31" href="picotls_8h.html#abc4124b1bc5642960e94ebc06686a614" title="sets the server&#45;name associated to the TLS connection. " alt="" coords="366,765,517,792"/><area shape="rect" id="node32" href="picotls_8h.html#a41fbce078a20dbc2fe15bb0b25da3411" title="sets the negotiated protocol. " alt="" coords="374,817,509,858"/><area shape="rect" id="node34" href="tls_8c.html#a596d4ddc108fc81c7eee5579e353beef" title="fprinthex" alt="" coords="405,309,477,336"/><area shape="rect" id="node35" href="picotls_8h.html#acbb30b5e02fad52e63b99be678d8a43c" title="returns the client&#45;random " alt="" coords="363,259,519,285"/><area shape="rect" id="node37" href="lib_2picotls_8c.html#a7011e70930ac9119a3e9d9a2b4a1d5f6" title="hkdf_expand_label" alt="" coords="376,107,507,133"/><area shape="rect" id="node38" href="lib_2picotls_8c.html#a8c2cbe239a451e652d10a7f516ec6749" title="setup_traffic_protection" alt="" coords="362,208,521,235"/><area shape="rect" id="node40" href="picotls_8h.html#aefec8568e3aed02938b396752d54d5e5" title="returns a pointer to user data pointer (client is reponsible for freeing the associated data prior to..." alt="" coords="380,613,503,640"/><area shape="rect" id="node41" href="picotls_8h.html#a724ff019ff3a867c90b28e4d3e8b6e53" title="returns the cipher&#45;suite being used " alt="" coords="386,664,497,691"/><area shape="rect" id="node42" href="tls_8c.html#af5ebb2a5b8cab6a40a18677a5ea562fb" title="setup_cipher" alt="" coords="393,360,489,387"/><area shape="rect" id="node44" href="boot_8c.html#a8dec7c95227ff149687066cf04029191" title="abort" alt="" coords="640,1043,691,1069"/><area shape="rect" id="node46" href="drbg_8c.html#a3d96d46fc2b09859f7d161cd321f2b30" title="cf_hash_drbg_sha256\l_needs_reseed" alt="" coords="367,1102,516,1143"/><area shape="rect" id="node47" href="cifra_8c.html#a086d6f716855b73e24c48cf5672ce607" title="read_entropy" alt="" coords="393,1051,490,1077"/><area shape="rect" id="node48" href="drbg_8c.html#a5554970693c632001ffcbe19bccb9a7f" title="cf_hash_drbg_sha256_init" alt="" coords="355,1168,528,1195"/><area shape="rect" id="node49" href="drbg_8c.html#ac688ec437860cba2eb2fb10f10a0d598" title="cf_hash_drbg_sha256_gen" alt="" coords="353,1219,530,1245"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a873296f812267d1c3475457cacc3c815"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_tp </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a873296f812267d1c3475457cacc3c815_cgraph.png" border="0" usemap="#tls_8h_a873296f812267d1c3475457cacc3c815_cgraph" alt=""/></div>
<map name="tls_8h_a873296f812267d1c3475457cacc3c815_cgraph" id="tls_8h_a873296f812267d1c3475457cacc3c815_cgraph">
<area shape="rect" id="node2" href="conn_8h.html#a3b1788e29ec153bfcb2b7edc34c488a6" title="is_force_vneg_vers" alt="" coords="113,5,247,32"/><area shape="rect" id="node3" href="warpcore_8h.html#a280e62a55aab21fe0b23a7e9ade1a588" title="Return MTU of w_engine w. " alt="" coords="149,56,211,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7af72f607847e5a6a71e9910b489fedc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_rtry_tok </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a7af72f607847e5a6a71e9910b489fedc_cgraph.png" border="0" usemap="#tls_8h_a7af72f607847e5a6a71e9910b489fedc_cgraph" alt=""/></div>
<map name="tls_8h_a7af72f607847e5a6a71e9910b489fedc_cgraph" id="tls_8h_a7af72f607847e5a6a71e9910b489fedc_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#a964f3cc6e0351969e0db618a8c2b722b" title="prep_hash_ctx" alt="" coords="160,5,267,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8984aa5b25b32bb8e40aef64f3164fc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maybe_flip_keys </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a8984aa5b25b32bb8e40aef64f3164fc0_cgraph.png" border="0" usemap="#tls_8h_a8984aa5b25b32bb8e40aef64f3164fc0_cgraph" alt=""/></div>
<map name="tls_8h_a8984aa5b25b32bb8e40aef64f3164fc0_cgraph" id="tls_8h_a8984aa5b25b32bb8e40aef64f3164fc0_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#a4faeebf5e3d33bfea46325d8fa7343d6" title="flip_keys" alt="" coords="173,56,248,83"/><area shape="rect" id="node3" href="picotls_8h.html#a724ff019ff3a867c90b28e4d3e8b6e53" title="returns the cipher&#45;suite being used " alt="" coords="301,5,411,32"/><area shape="rect" id="node4" href="picotls_8h.html#aadec89f296f10258b21ce9daa255d485" title="destroys an AEAD cipher context " alt="" coords="635,56,741,83"/><area shape="rect" id="node5" href="tls_8c.html#ab26c763c76c9b874d651bdba836fc13f" title="setup_initial_key" alt="" coords="297,132,415,159"/><area shape="rect" id="node6" href="picotls_8h.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="609,107,767,133"/><area shape="rect" id="node15" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="1506,259,1611,285"/><area shape="rect" id="node18" href="tls_8c.html#af5ebb2a5b8cab6a40a18677a5ea562fb" title="setup_cipher" alt="" coords="464,157,560,184"/><area shape="rect" id="node7" href="lib_2picotls_8c.html#a7011e70930ac9119a3e9d9a2b4a1d5f6" title="hkdf_expand_label" alt="" coords="1312,157,1443,184"/><area shape="rect" id="node8" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723" title="initializes a buffer, setting the default destination to the small buffer provided as the argument..." alt="" coords="1505,107,1612,133"/><area shape="rect" id="node9" href="boot_8c.html#a48b3b9f7e0a27f07fa14bed55036fa3b" title="strlen" alt="" coords="1531,157,1586,184"/><area shape="rect" id="node10" href="lib_2picotls_8c.html#ad066e549d3eadb8071666a295b3d286d" title="ptls_hkdf_expand" alt="" coords="1497,208,1621,235"/><area shape="rect" id="node16" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="1491,56,1626,83"/><area shape="rect" id="node11" href="lib_2picotls_8c.html#a5db4538399b7412c4dc994ed9041e952" title="ptls_hmac_create" alt="" coords="1681,208,1807,235"/><area shape="rect" id="node12" href="lib_2picotls_8c.html#a4291f2257a1f1c0d5aabb5c1bf782715" title="hmac_update" alt="" coords="1862,157,1962,184"/><area shape="rect" id="node13" href="lib_2picotls_8c.html#a22286798908a379df06073befee1973b" title="hmac_final" alt="" coords="1869,259,1955,285"/><area shape="rect" id="node14" href="lib_2picotls_8c.html#a4184a8e63a098ef29aea464c551a8d14" title="hmac_apply_key" alt="" coords="2011,233,2131,260"/><area shape="rect" id="node17" href="picotls_8h.html#add3c5e06f1310a8db6713148068046f0" title="internal " alt="" coords="1675,49,1813,90"/><area shape="rect" id="node19" href="picotls_8h.html#a229de01597e54002f209266c7b4055aa" title="instantiates a symmetric cipher " alt="" coords="630,157,746,184"/><area shape="rect" id="node20" href="picotls_8h.html#a04bb46d751b8ee324d6fe885e3cd50e7" title="instantiates an AEAD cipher given a secret, which is expanded using hkdf to a set of key and iv ..." alt="" coords="633,259,743,285"/><area shape="rect" id="node24" href="picotls_8h.html#ae57011fb3506f15237ead4f3146acc01" title="destroys a symmetric cipher " alt="" coords="631,208,745,235"/><area shape="rect" id="node21" href="lib_2picotls_8c.html#a263837b2d752dbd55d25187c624c0ee4" title="new_aead" alt="" coords="817,208,898,235"/><area shape="rect" id="node22" href="lib_2picotls_8c.html#af28434536271e3d710dc6ed7be94b5f3" title="get_traffic_key" alt="" coords="947,208,1055,235"/><area shape="rect" id="node23" href="lib_2picotls_8c.html#ad8b4abd44ba4d5f46a72ec9c08b07229" title="ptls_hkdf_expand_label" alt="" coords="1105,157,1263,184"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4e66d17ae7e8756388309b9e193a9543"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tls_io </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structq__stream.html">q_stream</a> *const&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structw__iov.html">w_iov</a> *const&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a4e66d17ae7e8756388309b9e193a9543_cgraph.png" border="0" usemap="#tls_8h_a4e66d17ae7e8756388309b9e193a9543_cgraph" alt=""/></div>
<map name="tls_8h_a4e66d17ae7e8756388309b9e193a9543_cgraph" id="tls_8h_a4e66d17ae7e8756388309b9e193a9543_cgraph">
<area shape="rect" id="node2" href="stream_8h.html#af3bef0cb9d669dca78f301f6ae50a19e" title="strm_epoch" alt="" coords="243,252,333,279"/><area shape="rect" id="node3" href="tls_8c.html#a4e66d17ae7e8756388309b9e193a9543" title="tls_io" alt="" coords="107,423,160,449"/><area shape="rect" id="node4" href="picotls_8h.html#ad7d2c2db8ec70c51f5241cfeb1f7a723" title="initializes a buffer, setting the default destination to the small buffer provided as the argument..." alt="" coords="924,259,1031,285"/><area shape="rect" id="node5" href="picotls_8h.html#aaf66968e2ad59ebf0f264cbb9d2f84f9" title="Runs the handshake by dealing directly with handshake messages. " alt="" coords="214,359,362,385"/><area shape="rect" id="node41" href="picotls_8h.html#a48da6806321331d00677c66444d7143d" title="returns if a PSK (or PSK&#45;DHE) handshake was performed " alt="" coords="209,305,367,332"/><area shape="rect" id="node42" href="conn_8c.html#a02d7b0c5a072e1b673358b52ac71f160" title="err_close" alt="" coords="251,473,325,500"/><area shape="rect" id="node47" href="quic_8c.html#a2ee75c38a1c756036392a6e5b6d1e93a" title="alloc_off" alt="" coords="253,524,323,551"/><area shape="rect" id="node49" href="warpcore_8h.html#a5ac8908312be71047433d7e51059e240" title="Return warpcore engine serving w_sock s. " alt="" coords="249,575,327,601"/><area shape="rect" id="node50" href="stream_8c.html#a379b35c4c21ee31284e14338963fdd8f" title="concat_out" alt="" coords="245,625,331,652"/><area shape="rect" id="node6" href="lib_2picotls_8c.html#a029da88bc71cbd5379a2bb29ad40ed6c" title="begin_raw_message" alt="" coords="441,360,583,387"/><area shape="rect" id="node7" href="lib_2picotls_8c.html#ada495d2c7552e84ffb81bbd617d81eea" title="commit_raw_message" alt="" coords="435,259,589,285"/><area shape="rect" id="node8" href="lib_2picotls_8c.html#ae56d8f8053af71e29360e8b2343036f8" title="send_client_hello" alt="" coords="685,1063,808,1089"/><area shape="rect" id="node21" href="lib_2picotls_8c.html#aa6a0008d415e04f0d67db03fdb2113de" title="Return the current read epoch. " alt="" coords="441,309,583,336"/><area shape="rect" id="node22" href="lib_2picotls_8c.html#a8d6dc376d25587767e241994bba77d58" title="handle_handshake_record" alt="" coords="660,107,833,133"/><area shape="rect" id="node26" href="lib_2picotls_8c.html#ae6cb70288c28281a9070f6467f8cadc1" title="handle_handshake_message" alt="" coords="417,603,607,629"/><area shape="rect" id="node9" href="lib_2picotls_8c.html#a55b4668776166a96a7acbfe0c90d1ca8" title="checks if given name looks like an IP address " alt="" coords="906,727,1049,769"/><area shape="rect" id="node10" href="lib_2picotls_8c.html#aa82467a6e9fa0951ddaf9cc7e0ca3839" title="client_setup_esni" alt="" coords="916,911,1039,937"/><area shape="rect" id="node11" href="lib_2picotls_8c.html#a0a127b7fb64bfe51e22a3f09ab851d4c" title="decode_stored_session\l_ticket" alt="" coords="898,845,1057,886"/><area shape="rect" id="node12" href="picotls_8h.html#a17e82d69963adbcc3ccd40af02c3f597" title="builds a new ptls_iovec_t instance using the supplied parameters " alt="" coords="1161,487,1266,513"/><area shape="rect" id="node13" href="lib_2picotls_8c.html#a8e6c870c991668cf04334390a17a750e" title="key_schedule_new" alt="" coords="911,575,1044,601"/><area shape="rect" id="node14" href="lib_2picotls_8c.html#a42a434fed7c689f5af03e95f873232bc" title="key_schedule_extract" alt="" coords="903,461,1052,488"/><area shape="rect" id="node15" href="lib_2picotls_8c.html#a5a5bebfd858dd25e2fb7b28bdfd11429" title="push_key_share_entry" alt="" coords="1137,1215,1290,1241"/><area shape="rect" id="node16" href="lib_2picotls_8c.html#a30284014e2b5a8066b17bbd70ac76e3a" title="emit_esni_extension" alt="" coords="907,1113,1048,1140"/><area shape="rect" id="node17" href="lib_2picotls_8c.html#ac92ac12c36e40056e83388420bcf4753" title="emit_server_name_extension" alt="" coords="1117,1139,1309,1165"/><area shape="rect" id="node18" href="lib_2picotls_8c.html#ac3aed9c2ae399575c55bf3447b0c72fe" title="reserves space for additional amount of memory " alt="" coords="1147,800,1280,827"/><area shape="rect" id="node19" href="lib_2picotls_8c.html#aea33d8f225ee2ce6271775db5a596e19" title="push_signature_algorithms" alt="" coords="889,961,1066,988"/><area shape="rect" id="node20" href="lib_2picotls_8c.html#aacb702a94a4a82424ba632eff52d32ef" title="push_additional_extensions" alt="" coords="886,1012,1069,1039"/><area shape="rect" id="node23" href="lib_2picotls_8c.html#a9b5970d9c3e0243e579000a47356fd64" title="ntoh24" alt="" coords="947,56,1008,83"/><area shape="rect" id="node24" href="picotls_8h.html#a9919d1343430a7726698cba411fa93b4" title="disposes a buffer, freeing resources allocated by the buffer itself (if any) " alt="" coords="910,208,1045,235"/><area shape="rect" id="node25" href="boot_8c.html#a1b021cbd45ae7a424f02e7d646205a00" title="memmove" alt="" coords="936,5,1019,32"/><area shape="rect" id="node27" href="lib_2picotls_8c.html#a6a4c66a07de1ccdccd8cd72dd8159c1c" title="client_handle_hello" alt="" coords="681,443,813,469"/><area shape="rect" id="node28" href="lib_2picotls_8c.html#a641ec40815e7577b669ca680d627bebe" title="client_handle_encrypted\l_extensions" alt="" coords="665,997,828,1038"/><area shape="rect" id="node29" href="lib_2picotls_8c.html#ae22a3f63edb4ae6a70c2164aae08da4c" title="client_handle_certificate\l_request" alt="" coords="665,377,828,418"/><area shape="rect" id="node30" href="lib_2picotls_8c.html#ae1f038d033d34fc9cec862988748be5b" title="client_handle_certificate" alt="" coords="665,544,828,571"/><area shape="rect" id="node31" href="lib_2picotls_8c.html#a58492a510a2c5a0bab8f5b327aa825b6" title="client_handle_compressed\l_certificate" alt="" coords="889,650,1065,691"/><area shape="rect" id="node32" href="lib_2picotls_8c.html#a6828746793c4617b153e22ed19583e2e" title="client_handle_certificate\l_verify" alt="" coords="665,595,828,637"/><area shape="rect" id="node33" href="lib_2picotls_8c.html#a57b21c55b53540c9e5e5c2329e646245" title="client_handle_finished" alt="" coords="671,325,822,352"/><area shape="rect" id="node34" href="lib_2picotls_8c.html#a1be278c074829ee6699aa71aafe11094" title="server_handle_hello" alt="" coords="678,493,815,520"/><area shape="rect" id="node35" href="lib_2picotls_8c.html#a9449506d5e877c1b62f89c65ceb9d9b6" title="server_handle_certificate" alt="" coords="663,661,830,688"/><area shape="rect" id="node36" href="lib_2picotls_8c.html#aa4bf6cb99aa563939fbef269fb6d5c31" title="server_handle_certificate\l_verify" alt="" coords="663,713,830,754"/><area shape="rect" id="node37" href="lib_2picotls_8c.html#acf0b485ef1c93e0e711ceb0314ad3c96" title="server_handle_end_of\l_early_data" alt="" coords="672,778,821,819"/><area shape="rect" id="node38" href="lib_2picotls_8c.html#ac9d308968a33e9c104c31dcaa448d6cf" title="server_handle_finished" alt="" coords="669,844,824,871"/><area shape="rect" id="node39" href="lib_2picotls_8c.html#a6b012c4c97a534e2d438f9e2a339ae76" title="client_handle_new_session\l_ticket" alt="" coords="656,259,837,301"/><area shape="rect" id="node40" href="lib_2picotls_8c.html#a53924e83d858225421f3427953bef42f" title="handle_key_update" alt="" coords="679,895,814,921"/><area shape="rect" id="node43" href="conn_8c.html#afd38904c68cab87424e6aa8db723fd38" title="enter_closing" alt="" coords="463,1113,561,1140"/><area shape="rect" id="node44" href="conn_8h.html#a68c6b30b8665ce894ab5bed3c73a2d9d" title="is_zero" alt="" coords="715,1113,779,1140"/><area shape="rect" id="node45" href="conn_8c.html#aea7c8de8c9a43a64163e900a70678ae2" title="enter_closed" alt="" coords="699,1164,795,1191"/><area shape="rect" id="node46" href="conn_8h.html#aa0fec7fdf46459b57e64dbe4e79a8dc4" title="conn_type" alt="" coords="705,1215,788,1241"/><area shape="rect" id="node48" href="warpcore_8h.html#a7828b02675cf9e9c1465f3162033e22c" title="Allocate a w_iov tail queue for plen payload bytes, for eventual use with w_tx(). ..." alt="" coords="467,1164,557,1191"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a779c1ebd1e6c43f05a373c84defb3fa8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool verify_rtry_tok </td>
          <td>(</td>
          <td class="paramtype">struct q_conn *const&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>tok</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>tok_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="tls_8h_a779c1ebd1e6c43f05a373c84defb3fa8_cgraph.png" border="0" usemap="#tls_8h_a779c1ebd1e6c43f05a373c84defb3fa8_cgraph" alt=""/></div>
<map name="tls_8h_a779c1ebd1e6c43f05a373c84defb3fa8_cgraph" id="tls_8h_a779c1ebd1e6c43f05a373c84defb3fa8_cgraph">
<area shape="rect" id="node2" href="tls_8c.html#a964f3cc6e0351969e0db618a8c2b722b" title="prep_hash_ctx" alt="" coords="160,5,267,32"/><area shape="rect" id="node3" href="boot_8c.html#a3c48b0d616482494ace467ca05e01642" title="memcmp" alt="" coords="175,56,251,83"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="af6bbbfab377148ff702ada5a44a7ae73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="picotls_8h.html#a7b1de04c9108a605591e1562a2418b86">ptls_context_t</a> tls_ctx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TLS context. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Feb 17 2019 11:10:26 for quant by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
